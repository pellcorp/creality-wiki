{"config":{"lang":["en"],"separator":"[\\s\\u200b\\-_,:!=\\[\\]()\"`/]+|\\.(?!\\d)|&[lg]t;|(?!\\b)(?=[A-Z][a-z])","pipeline":["stopWordFilter"]},"docs":[{"location":"beacon/","title":"Beacon","text":""},{"location":"beacon/#where-can-i-get-help","title":"Where can I get help?","text":"<p>Come on over to the pellcorp discord server, here is the invite, the <code>#simple-af-beacon</code> channel has been setup for anyone wanting support for beacon.</p> <p>https://discord.gg/2uGDzyJ3WX</p>"},{"location":"beacon/#thanks","title":"Thanks","text":"<p>Thanks to https://raven3dtech.com.au/ and https://beacon3d.com for donating Beacon probes to the Simple AF project to add support and continue to support the Beacon.</p>"},{"location":"beacon/#firmware-requirements","title":"Firmware requirements","text":""},{"location":"beacon/#k1-series","title":"K1 Series","text":"<p>This guide assumes you have a K1, K1C, K1SE or K1 Max and you are running stock creality firmware 1.3.3.5 or higher (The firmware 1.3.3.5 is much older than 1.3.3.46 for example), or alternately you can use my prerooted firmware.</p>"},{"location":"beacon/#ender-5-max","title":"Ender 5 Max","text":"<p>This guide assumes you are running stock Creality firmware 1.2.0.10 or higher on your Ender 5 Max.</p> <p>The stock firmware comes pre-rooted, with the default root password being <code>Creality@2024_Wh_464</code></p> <p>Please note that you will need to change the screen orientation to horizontal, here is a model for that https://www.printables.com/model/1246910-ender-5-max-screen-bracket</p>"},{"location":"beacon/#ender-3-v3-ke","title":"Ender 3 V3 KE","text":"<p>This guide assumes you have a stock Ender 3 V3 KE with Nebula Pad with Root enabled, when you get to installation below, you should specify the <code>--mount Default</code> to install Simple AF on the KE for Beacon.</p> <p>Please note that you will need to change the screen orientation to horizontal, here is a model for that https://www.printables.com/model/727362-ender-3-v3-ke-screen-holder-landscape-for-guppyscr, but please do not follow the installation instructions on that page, just print the model and remount your screen only!</p> <p>An alternative model which honestly seems a bit cleaner: https://www.printables.com/model/706657-creality-ender-3-v3-e3v3-se-ke-and-cr-10-se-portra</p>"},{"location":"beacon/#simple-af-for-rpi","title":"Simple AF for RPi","text":"<p>See Simple AF for RPi</p>"},{"location":"beacon/#slicer-settings","title":"Slicer Settings","text":"<p>Danger</p> <p>Creality Print won't be able to see your printer after you have installed Simple AF, the only tested slicer we all use is OrcaSlicer, likely if you want to use Creality Print you will need to print via usb.</p> <p>Cura Slicer won't work out of the box for configuring START_PRINT variables as below, you need to change the start print EXTRUDER_TEMP and BED_TEMP to pass in the correct values, but since I don't use Cura Slicer I can't advise on that!</p> <p>There is an assumption that you are using a slicer like OrcaSlicer and Machine G-code like:</p> <p></p> <p>Machine start G-code <pre><code>M140 S0\nM104 S0 \nSTART_PRINT EXTRUDER_TEMP=[nozzle_temperature_initial_layer] BED_TEMP=[bed_temperature_initial_layer_single]\n</code></pre></p> <p>Machine end G-code <pre><code>END_PRINT\n</code></pre></p>"},{"location":"beacon/#custom-bed-mesh-profile","title":"Custom Bed Mesh Profile","text":"<p>If you want to select a specific predefined bed mesh profile (which disables adaptive mesh generation), you can pass in an additional <code>START_PRINT</code> parameter:</p> <p>You can either hard code it to a particular model, like <code>BED_MESH_PROFILE=myprofile</code> or you can specify a profile based on orca slicer variables, such as <code>BED_MESH_PROFILE=\"[curr_bed_type] - [filament_type]\"</code>, but you have to make sure you have all the possible profiles defined for each of the bed type and filament type combinations.</p> <p></p>"},{"location":"beacon/#probe-installation","title":"Probe Installation","text":"<p>Danger</p> <p>If you are not using a side mount you must verify config changes for beacon.cfg before homing your printer, using Screws Tilt Calculate or doing a bed mesh!  </p> <p>Ignoring these instructions can lead to significant damage to your build plate and/or probe.</p>"},{"location":"beacon/#mount-options","title":"Mount Options","text":"Mount Printer Beacon URL Notes Default K1, K1C, K1M, K1SE RevH Standard https://www.printables.com/model/1071641-beacon-probe-mounts-for-creality-k1-series BootyGantry K1, K1C, K1M, K1SE RevH Standard https://github.com/tlace17/K1-Linear-Rail-Gantry/blob/main/STLs/Probe%20Mounts/Rail%20Carriage%20Carto%20Mount.stl This is not for low profile SkeletorMK7 K1, K1C, K1M, K1SE RevH Low Profile https://www.printables.com/model/833769-the-skeletor-collection-a-creality-k1k1-maxk1c-coo This is only for the low profile beacon version of the mount!!! SimplyHexed Ender 5 Max RevH Standard https://www.printables.com/model/1209230-ender-5-max-simply-hexed Ender 5 Max only! Default Ender 3 V3 KE RevH Standard https://www.printables.com/model/732262-ender-3-v3-ke-beaconcartographer-mount Might require shimming depending on the hotend / nozzle you use"},{"location":"beacon/#nozzle-offset","title":"Nozzle Offset","text":"<p>Warning</p> <p>It is vital that you verify the coil to nozzle tip distance is within the valid range of 2.6 to 3mm, you can use this simple tool to verify the range:     https://www.printables.com/model/1325363-cartographer-and-beacon-z-offset-goldilocks-tool</p> <p>Just be sure to use digital calipers to verify the print printed with the correct size before relying on it, if you have trouble with  your z not being always entirely accurate consider printing the model on its side.</p>"},{"location":"beacon/#beacon-firmware","title":"Beacon Firmware","text":"<p>Warning</p> <p>You must have flashed your beacon with the latest beacon firmware (2.1.0 currently) before starting the installation</p> <p>For K1 Series Simple AF there is a guide.</p> <p>For Simple AF for RPi, you can use the standard beacon guide https://docs.beacon3d.com/contact/#51-firmware-update</p>"},{"location":"beacon/#installation","title":"Installation","text":"<p>Warning</p> <p>The installation section does not apply to Simple AF for RPi, See Simple AF for RPi</p> <p>The installation can only be performed on a printer which has been rooted and ssh granted</p> <p>You need root access, if you are not already root, then follow Helper Script Enable Root Access</p>"},{"location":"beacon/#factory-reset","title":"Factory Reset","text":"<p>You must do a factory reset only if you have installed Helper Script or Fluidd/Mainsail directly from Creality, otherwise you can safely proceed directly to installation.    If you have setup your printer with stock firmware only it can be quite handy to skip a factory reset so that you can use Switch to Stock</p> <pre><code>wget --no-check-certificate https://raw.githubusercontent.com/pellcorp/creality/main/k1/services/S58factoryreset -O /tmp/S58factoryreset\nchmod +x /tmp/S58factoryreset\n/tmp/S58factoryreset reset\n</code></pre> <p>Danger</p> <p>It is really important you do not close the ssh session until you get this message:</p> <p></p> <p>It can take up to 5 minutes for a factory restart to finish, it is vital you do not power cycle your printer before the stock screen appears. There may be a 3002 error on the screen, this is completely normal.   If you are planning to install Simple AF you can ignore it, if you are trying to go back to stock, power cycle the printer again to clear the error.  </p> <p>Failing to follow this advice can lead to your printer getting bricked and requiring much more involved intervention to recover!</p> <p></p>"},{"location":"beacon/#clone-the-repo","title":"Clone the Repo","text":"<pre><code>git config --global http.sslVerify false\ngit clone https://github.com/pellcorp/creality.git /usr/data/pellcorp\nsync\n</code></pre>"},{"location":"beacon/#run-the-installer","title":"Run the installer","text":"<p>Note</p> <p>If you have pellcorp-overrides in github but not stored locally, you need to recreate the ~/pellcorp-overrides directory before running the installer.sh!</p> <p>To run the script, you must use the following command:</p> <pre><code>/usr/data/pellcorp/installer.sh --install beacon --mount Mount\n</code></pre> <p>Warning</p> <p>For <code>Mount</code> you must specify the mount option for the mount you have used, if you do not do this the printer will be incorrectly configured for your mount, and bed meshes, x and y limits and related config will be wrong.   Please refer to Mount Options for supported mounts.   </p> <p>If you are using a non-supported mount you should specify a mount option as close to your mount as possible and properly adjust your configuration after installation before trying to perform a bed mesh or Screws Tilt Calculate!</p>"},{"location":"beacon/#post-installation","title":"Post Installation","text":""},{"location":"beacon/#mcu-firmware-updates-are-pending","title":"MCU Firmware updates are pending","text":"<p>At the end of the installer process if you get this message:</p> <pre><code>WARNING: MCU Firmware updates are pending you need to power cycle your printer!\n</code></pre> <p>It means that new MCU firmware updates need to be applied and this can only be done by power cycling the printer.  After your printer is power cycled you can verify firmware was updated with the <code>CHECK_FIRMWARE</code> macro from Fluidd or Mainsail, if you see this message:</p> <pre><code>INFO: Your MCU Firmware is up to date!\n</code></pre> <p>Your printer MCU firmware was updated successfully.   If you still see the <code>MCU Firmware updates are pending you need to power cycle your printer!</code> message after a power cycle, check the <code>/tmp/mcu_update.log</code>, you may be asked to provide this file on Discord if you need additional assistance, sometimes an additional power cycle can solve the problem, there is a very short window of time (15 seconds) in which the MCU firmware can be updated, so  there is a chance it will work after an additional power cycle.</p>"},{"location":"beacon/#verify-usb-key","title":"Verify USB Key","text":"<p>It is important to make sure you have a way to emergency factory reset the printer, if the worst happens.   There is a macro in Simple AF called <code>CHECK_USB_KEY</code> that will wait for you to plug a USB thumb drive (aka USB key) in and tell you if it was able to be successfully mounted.</p> <p>You can find the CHECK_USB_KEY macro in Fluidd or Mainsail, because Fluidd and Mainsail are already installed, you can access Fluidd by opening your browser and connecting using http://X.X.X.X, where X.X.X.X is your ip address that you used to login via ssh to your printer, you can also access Fluidd via http://X.X.X.X:4408 and Mainsail via http://X.X.X.X:4409!</p> <p></p> <p>After running the macro you should see output like the following:</p> <p></p> <ul> <li>If you get the message: <code>INFO - USB Key was recognised and mounted correctly (/tmp/udisk/sda1)</code>, your USB thumb drive (aka USB key) is perfect to use for a factory reset.</li> <li>If you get no message at all before the script ends (after 60 seconds), your USB thumb drive (aka USB key) is defective.   You can check the <code>messages</code> file in the logs section of your UI to get more details about why the usb key could not be mounted!</li> </ul> <p>Tip</p> <p>You should verify your USB thumb drive (aka USB key) often just to make sure you have something if you need to unbrick your printer, simply type <code>CHECK_USB_KEY</code> or hit the button in Fluidd / Mainsail The USB key should be FAT32 formatted and be no larger than 32GB!</p> <p>Note</p> <p>If you have plugged your beacon into the front usb port, you are going to have to temporarily remove the beacon from the front usb slot and replace it with your USB thumb drive (aka USB key), after you have finished verifying the USB thumb drive (aka USB key) can be used in an emergency, you can replace the beacon into the front usb slot and restart klipper or power cycle your printer.</p>"},{"location":"beacon/#timer-too-close-and-microsteps","title":"Timer too close and microsteps","text":"<p>For beacon you cannot use more than <code>microsteps: 32</code>, the MCU cannot handle both more microsteps and beacon, it puts too much pressure on the system and it cause stuttering during bed meshes, it is also been known to cause klipper to crash during repeated bed meshes.</p>"},{"location":"beacon/#calibration","title":"Calibration","text":"<p>Warning</p> <p>The following calibration steps are required to setup a new printer:</p> <ul> <li>Beacon Calibrate</li> <li>PID Tuning and Input Shaping</li> </ul>"},{"location":"beacon/#beacon-calibrate","title":"Beacon Calibrate","text":"<p>It is strongly recommended to disable the camera for these calibration steps, just use the <code>STOP_CAMERA</code> macro to do this.</p> <ol> <li>Run the <code>STOP_CAMERA</code> macro to stop the camera </li> <li>Home X Y (<code>G28 X Y</code>)</li> <li>Heat Nozzle to 150c (<code>M109 S150</code>) so that any filament can be removed from nozzle</li> <li>Make sure nozzle is centred on bed </li> <li>Run <code>BEACON_CALIBRATE</code> Follow the Paper Test Method Upon completion <code>SAVE_CONFIG</code></li> </ol> <p>Warning</p> <p>Do not use a metal feeler gauge for this step, it could damage your beacon!!!</p> <p>Source: https://docs.beacon3d.com/quickstart/#6-calibrate-beacon</p> <p>Note</p> <p>Is normal to show the Z position at almost at the max height of the printer even if the nozzle is somewhere in the middle or even close to the bed, this is not a bug, its intentional.   Until this calibration step is completed, the Z axes cannot be homed, so we make the printer pretend the bed is down the bottom of the printer so that you can freely move the bed up to meet the nozzle during the paper test without running into out of range issues.  You however won't be able to move the bed further away from the nozzle more than a few mm.</p> <p></p>"},{"location":"beacon/#pid-tuning-and-input-shaping","title":"Pid Tuning and Input Shaping","text":"<p>At least PID tuning (bed and extruder) and input shaping is required for acceptable printing.  If you try and print after running the installer.sh and a power cycle but before any calibration you will most likely have horrendous quality, the worst you have ever seen on the k1.   After PID tuning and input shaping you should see the same kind of quality as you get with stock k1 + input shaper fix.</p> <p>Note</p> <p>You can use the QUICK_START Macro to complete Bed and Nozzle PID Tuning and Input Shaping Automatically.</p>"},{"location":"beacon/#pid-tuning","title":"Pid Tuning","text":"<p>Source: Calibrate Pid Settings</p> <p>For example you might run these:</p> <pre><code>PID_CALIBRATE_BED BED_TEMP=65\nPID_CALIBRATE_HOTEND HOTEND_TEMP=230\n</code></pre> <p>Note</p> <p>The <code>PID_CALIBRATE_BED</code> and <code>PID_CALIBRATE_HOTEND</code> macros are located in the <code>useful_macros.cfg</code> file and they have defaults values for BED_TEMP and HOTEND_TEMP so you can just run them by clicking on them if you want that same temperature.</p>"},{"location":"beacon/#input-shaping","title":"Input Shaping","text":"<p>There is no default configuration for input shaping so it is essentially disabled out of the box.</p> <p>You can use the <code>SHAPER_CALIBRATE</code> macro to run input shaping, just be sure to <code>SAVE CONFIG</code> at the end, to choose the automatically selected shaper config, be aware though that the shaper chosen might be sub-optimal due to a slight difference in vibrations between two options.  So you should probably review the output and potentially choose an alternative if it gives you higher recommended max acceleration for minimal increase in vibration.</p> <p>Input Shaper Auto Calibration</p>"},{"location":"beacon/#axis-twist-compensation","title":"Axis Twist Compensation","text":"<p>If you are using a rear mount it is highly recommended to perform axis twist compensation, this will affect the quality of your bed mesh, so best to do it before.</p> <p>Tip</p> <p>There is no need to run axis twist compensation if you have mounted the eddy with a side mount that has a 0 y offset!</p> <ol> <li>Home All (<code>G28</code>)</li> <li>Run <code>AXIS_TWIST_COMPENSATION_CALIBRATE</code> The calibration wizard will prompt you to measure the probe Z offset at a few points along the bed    Upon completion <code>SAVE_CONFIG</code></li> </ol> <p>Source: https://www.klipper3d.org/Axis_Twist_Compensation.html</p>"},{"location":"beacon/#first-print","title":"First Print","text":"<p>You should optimise your <code>cal_nozzle_z</code> using baby stepping.</p> <p>In fluidd the save button after you finish or cancel your print can be a bit hard to find, look for</p> <p></p>"},{"location":"beacon/#other-calibrations","title":"Other Calibrations","text":"<p>Info</p> <p>The default value for pressure advance is set to <code>0.04</code></p> <p>Refer to Orcaslicer Calibration for more calibrations</p> <p>Refer to the Ellis Print Tuning Guide for more great tuning ideas.</p>"},{"location":"beacon_faq/","title":"Frequently Asked Questions","text":""},{"location":"beacon_faq/#how-do-i-use-my-beacon-for-input-shaping","title":"How do I use my beacon for input shaping?","text":"<p>Note</p> <p>These instructions do not apply to Simple AF for RPi, although it is certainly possible to use the Beacon as ADXL on non creality printers.</p> <p>This just needs a few changes in <code>printer.cfg</code></p> <p>You can remove the <code>[adxl345]</code> section</p> <p>Change the <code>[resonance_tester]</code> <code>accel_chip</code> from <code>adxl345</code> to <code>beacon</code></p> <p>So your <code>[resonance_tester]</code> should look something like this:</p> <pre><code>[resonance_tester]\naccel_chip: beacon\naccel_per_hz: 75\nprobe_points:\n   110,110,10\n</code></pre> <p>Source: https://docs.beacon3d.com/config/#resonance_tester</p>"},{"location":"beacon_flashing/","title":"Beacon flashing","text":"<p>Danger</p> <p>THIS IS A RISKY OPERATION YOU CAN BRICK YOUR BEACON</p>"},{"location":"beacon_flashing/#flashing-the-beacon","title":"Flashing the Beacon","text":"<p>You will need some kind of linux environment, this can be a Raspberry Pi, desktop Linux or even a Linux Server if you can plug something in via USB.   If you do not have anything like that, you will need to create a Live USB key running Ubuntu 24.04 Desktop edition.</p>"},{"location":"beacon_flashing/#creating-a-live-usb-key","title":"Creating a Live USB Key","text":"<p>You should create a live USB with Ubuntu 24.04 Desktop, make sure the USB is at least 8GB in size!</p> <p>https://ubuntu.com/tutorials/try-ubuntu-before-you-install#1-getting-started</p>"},{"location":"beacon_flashing/#install-some-deps-on-ubuntu","title":"Install some deps on Ubuntu","text":"<pre><code>sudo apt-get update\nsudo apt-get install virtualenv python3-dev python3-pip libffi-dev build-essential git dfu-util\n</code></pre>"},{"location":"beacon_flashing/#clone-klipper-and-beacon-klipper","title":"Clone Klipper and Beacon-Klipper","text":"<pre><code>git clone \"https://github.com/Klipper3d/klipper\" $HOME/klipper\ngit clone https://github.com/beacon3d/beacon_klipper.git $HOME/beacon-klipper\n</code></pre>"},{"location":"beacon_flashing/#setup-klipper-virtual-env","title":"Setup Klipper Virtual Env","text":"<pre><code>virtualenv --system-site-packages $HOME/klippy-env\n$HOME/klippy-env/bin/pip3 install -r $HOME/klipper/scripts/klippy-requirements.txt\n</code></pre>"},{"location":"beacon_flashing/#flash-beacon","title":"Flash Beacon","text":"<pre><code>cd $HOME/beacon-klipper\nsudo -E ./install.sh\n</code></pre>"},{"location":"beacon_troubleshooting/","title":"Troubleshooting","text":""},{"location":"beacon_troubleshooting/#manual-beacon-serial-device-configuration","title":"Manual Beacon Serial Device configuration","text":"<p>You can run the following command to fix your serial if you forgot to plug your beacon in during the installation or update:</p> <pre><code>~/pellcorp/k1/installer.sh --fix-serial\n</code></pre> <p>Note</p> <p>If you run the above and receive an error like:</p> <pre><code>```\nroot@K1Max-AF34 /root [#] ~/pellcorp/installer.sh --fix-serial\n-sh: /root/pellcorp/installer.sh: not found\n```\n</code></pre> <p>It means you are on an older version of Simple AF and you should instead use the old style commands:</p> <pre><code>```\n/usr/data/pellcorp/k1/installer.sh --fix-serial\n```\n</code></pre>"},{"location":"beacon_troubleshooting/#beaconprobe-object-has-no-attribute-_mcu_freq","title":"'BeaconProbe' object has no attribute '_mcu_freq'","text":"<p>This often indicates the beacon was disconnected during homing or some other operation, you need to reboot</p> <p></p> <p>On rare occasions this also occurs when the printer gets overloaded, if the error does not clear after a power cycle, try leaving your printer completely powered off for 15 minutes, see if the error clears afterwards.  If the error does not clear after doing this, I would be looking for a hardware issue, such as a dodgy cable.</p>"},{"location":"beacon_wiring/","title":"Beacon Wiring","text":"<p>Note</p> <p>This wiring section applies to K1/K1C/K1SE/K1M printers only</p> <p>On a K1M you can use the lidar cable either directly by repinning it, or via the pass through lidar port on the toolhead.  However you cannot use the lidar port on the toolhead for K1, K1C or K1SE.   The reason this does not work is because for Lidar on the K1M creality actually routes a completely separate USB cable from the mainboard.</p> <p></p>"},{"location":"bltouch/","title":"Bltouch","text":""},{"location":"bltouch/#where-can-i-get-help","title":"Where can I get help?","text":"<p>Come on over to the pellcorp discord server, the <code>#simple-af-bltouch</code> channel has been setup for anyone wanting support for bltouch, crtouch or 3dtouch.</p> <p>https://discord.gg/2uGDzyJ3WX</p>"},{"location":"bltouch/#what-about-crtouch","title":"What about CrTouch","text":"<p>Yep you can use a CrTouch as an alternative to a BlTouch, however I have not personally used either of these with a K1 and so I can't currently provide detailed guidance on what config is required.</p>"},{"location":"bltouch/#what-about-3d-touch","title":"What about 3d Touch","text":"<p>Its possible a 3d touch will work too, but depending on the capabilities of the 3d touch clone, you might need to make some post installation changes.   I also think 3dTouch might require slightly different wiring.</p> <p>Please refer to more details, specifically note the fact that the <code>QUERY_PROBE</code> may not be supported, and the <code>probe_with_touch_mode</code> feature is not supported!</p> <p>https://www.klipper3d.org/BLTouch.html#bl-touch-clones</p>"},{"location":"bltouch/#firmware-requirements","title":"Firmware requirements","text":""},{"location":"bltouch/#k1-series","title":"K1 Series","text":"<p>This guide assumes you have a K1, K1C, K1SE or K1 Max and you are running stock creality firmware 1.3.3.5 or higher (The firmware 1.3.3.5 is much older than 1.3.3.46 for example), or alternately you can use my prerooted firmware.</p>"},{"location":"bltouch/#ender-3-v3-ke","title":"Ender 3 V3 KE","text":"<p>This guide assumes you have a stock Ender 3 V3 KE with Nebula Pad with Root enabled, when you get to installation below, you should specify the <code>--mount Default</code> to install Simple AF on the KE for Cr-Touch.</p> <p>Please note that you will need to change the screen orientation to horizontal, here is a model for that https://www.printables.com/model/727362-ender-3-v3-ke-screen-holder-landscape-for-guppyscr, but please do not follow the installation instructions on that page, just print the model and remount your screen only!</p>"},{"location":"bltouch/#ender-5-max","title":"Ender 5 Max","text":"<p>This probe is currently not supported on Ender 5 Max</p>"},{"location":"bltouch/#simple-af-for-rpi","title":"Simple AF for RPi","text":"<p>See Simple AF for RPi</p>"},{"location":"bltouch/#slicer-settings","title":"Slicer Settings","text":"<p>Danger</p> <p>Creality Print won't be able to see your printer after you have installed Simple AF, the only tested slicer we all use is OrcaSlicer, likely if you want to use Creality Print you will need to print via usb.</p> <p>Cura Slicer won't work out of the box for configuring START_PRINT variables as below, you need to change the start print EXTRUDER_TEMP and BED_TEMP to pass in the correct values, but since I don't use Cura Slicer I can't advise on that!</p> <p>There is an assumption that you are using a slicer like OrcaSlicer and Machine G-code like:</p> <p></p> <p>Machine start G-code <pre><code>M140 S0\nM104 S0 \nSTART_PRINT EXTRUDER_TEMP=[nozzle_temperature_initial_layer] BED_TEMP=[bed_temperature_initial_layer_single]\n</code></pre></p> <p>Machine end G-code <pre><code>END_PRINT\n</code></pre></p>"},{"location":"bltouch/#custom-bed-mesh-profile","title":"Custom Bed Mesh Profile","text":"<p>If you want to select a specific predefined bed mesh profile (which disables adaptive mesh generation), you can pass in an additional <code>START_PRINT</code> parameter:</p> <p>You can either hard code it to a particular model, like <code>BED_MESH_PROFILE=myprofile</code> or you can specify a profile based on orca slicer variables, such as <code>BED_MESH_PROFILE=\"[curr_bed_type] - [filament_type]\"</code>, but you have to make sure you have all the possible profiles defined for each of the bed type and filament type combinations.</p> <p></p>"},{"location":"bltouch/#probe-installation","title":"Probe Installation","text":"<p>Danger</p> <p>If you are not using a side mount you must verify config changes for bltouch.cfg before homing your printer, using Screws Tilt Calculate or doing a bed mesh!  </p> <p>Ignoring these instructions can lead to significant damage to your build plate and/or probe.</p>"},{"location":"bltouch/#mount-options","title":"Mount Options","text":"Mount Printer URL Notes Default K1, K1C, K1M, K1SE https://www.printables.com/model/666186-creality-k1-bltouch-adapter CrTouch K1, K1C, K1M, K1SE https://www.printables.com/model/1073375-cr-touch-mount-k1-k1maxk1c-zero-y-offset Untested on K1M Default Ender 3 V3 SE N/A Default CR Touch Mount Default Ender 3 V3 KE N/A Default CR Touch Mount"},{"location":"bltouch/#installation","title":"Installation","text":"<p>Warning</p> <p>The installation section does not apply to Simple AF for RPi, See Simple AF for RPi</p> <p>The installation can only be performed on a printer which has been rooted and ssh granted</p> <p>You need root access, if you are not already root, then follow the excellent Helper Script Enable Root Access instructions.</p>"},{"location":"bltouch/#factory-reset","title":"Factory Reset","text":"<p>You must do a factory reset only if you have installed Helper Script or Fluidd/Mainsail directly from Creality, otherwise you can safely proceed directly to an installation.    If you have setup your printer with stock firmware only it can be quite handy to skip a factory reset so that you can use Switch to Stock</p> <p>Please note that because the Ender 5 Max and Ender 3 V3 KE both use the same basic software as the K1 series, the following step applies to these printers as well.</p> <pre><code>wget --no-check-certificate https://raw.githubusercontent.com/pellcorp/creality/main/k1/services/S58factoryreset -O /tmp/S58factoryreset\nchmod +x /tmp/S58factoryreset\n/tmp/S58factoryreset reset\n</code></pre> <p>Danger</p> <p>It is really important you do not close the ssh session until you get this message:</p> <p></p> <p>It can take up to 5 minutes for a factory restart to finish, it is vital you do not power cycle your printer before the stock screen appears. There may be a 3002 error on the screen, this is completely normal.   If you are planning to install Simple AF you can ignore it, if you are trying to go back to stock, power cycle the printer again to clear the error.  </p> <p>Failing to follow this advice can lead to your printer getting bricked and requiring much more involved intervention to recover!</p> <p></p>"},{"location":"bltouch/#clone-the-repo","title":"Clone the Repo","text":"<pre><code>git config --global http.sslVerify false\ngit clone https://github.com/pellcorp/creality.git /usr/data/pellcorp\nsync\n</code></pre>"},{"location":"bltouch/#run-the-installer","title":"Run the installer","text":"<p>Note</p> <p>If you have pellcorp-overrides in github but not stored locally, you need to recreate the ~/pellcorp-overrides directory before running the installer.sh!</p> <p>To run the script, you must specify the probe you want to use.</p> <pre><code>/usr/data/pellcorp/installer.sh --install bltouch --mount Mount\n</code></pre> <p>Warning</p> <p>For <code>Mount</code> you must specify the mount option for the mount you have used, if you do not do this the printer will be incorrectly configured for your mount, and bed meshes, x and y limits and related config will be wrong.   Please refer to Mount Options for supported mounts.   </p> <p>If you are using a non-supported mount you should specify a mount option as close to your mount as possible and properly adjust your configuration after installation before trying to perform a bed mesh or Screws Tilt Calculate!</p>"},{"location":"bltouch/#post-installation","title":"Post Installation","text":""},{"location":"bltouch/#mcu-firmware-updates-are-pending","title":"MCU Firmware updates are pending","text":"<p>At the end of the installer process if you get this message:</p> <pre><code>WARNING: MCU Firmware updates are pending you need to power cycle your printer!\n</code></pre> <p>It means that new MCU firmware updates need to be applied and this can only be done by power cycling the printer.  After your printer is power cycled you can verify firmware was updated with the <code>CHECK_FIRMWARE</code> macro from Fluidd or Mainsail, if you see this message:</p> <pre><code>INFO: Your MCU Firmware is up to date!\n</code></pre> <p>Your printer MCU firmware was updated successfully.   If you still see the <code>MCU Firmware updates are pending you need to power cycle your printer!</code> message after a power cycle, check the <code>/tmp/mcu_update.log</code>, you may be asked to provide this file on Discord if you need additional assistance, sometimes an additional power cycle can solve the problem, there is a very short window of time (15 seconds) in which the MCU firmware can be updated, so  there is a chance it will work after an additional power cycle.</p>"},{"location":"bltouch/#verify-usb-key","title":"Verify USB Key","text":"<p>It is important to make sure you have a way to emergency factory reset the printer, if the worst happens.   There is a macro in Simple AF called <code>CHECK_USB_KEY</code> that will wait for you to plug a USB thumb drive (aka USB key) in and tell you if it was able to be successfully mounted.</p> <p>You can find the CHECK_USB_KEY macro in Fluidd or Mainsail, because Fluidd and Mainsail are already installed, you can access Fluidd by opening your browser and connecting using http://X.X.X.X, where X.X.X.X is your ip address that you used to login via ssh to your printer, you can also access Fluidd via http://X.X.X.X:4408 and Mainsail via http://X.X.X.X:4409!</p> <p></p> <p>After running the macro you should see output like the following:</p> <p></p> <ul> <li>If you get the message: <code>INFO - USB Key was recognised and mounted correctly (/tmp/udisk/sda1)</code>, your USB thumb drive (aka USB key) is perfect to use for a factory reset.</li> <li>If you get no message at all before the script ends (after 60 seconds), your USB thumb drive (aka USB key) is defective.   You can check the <code>messages</code> file in the logs section of your UI to get more details about why the usb key could not be mounted!</li> </ul> <p>Tip</p> <p>You should verify your USB thumb drive (aka USB key) often just to make sure you have something if you need to unbrick your printer, simply type <code>CHECK_USB_KEY</code> or hit the button in Fluidd / Mainsail The USB key should be FAT32 formatted and be no larger than 32GB!</p>"},{"location":"bltouch/#timer-too-close-and-microsteps","title":"Timer too close and microsteps","text":"<p>For bltouch, etc you cannot use more than <code>microsteps: 64</code></p>"},{"location":"bltouch/#calibration","title":"Calibration","text":"<p>Warning</p> <p>The following calibration steps are required to setup a new printer:</p> <ul> <li>Probe Calibrate</li> <li>PID Tuning and Input Shaping</li> </ul>"},{"location":"bltouch/#probe-calibrate","title":"Probe Calibrate","text":"<p>For the bltouch/3dtouch/crtouch it is extremely important to do the PROBE_CALIBRATE step to configure your z-offset, regardless of what model you have used to mount the probe!</p> <p></p> <ol> <li>Home All (<code>G28</code>)</li> <li>Run <code>PROBE_CALIBRATE</code></li> <li>Follow the Paper Test Method Upon completion <code>SAVE_CONFIG</code></li> </ol> <p>Note</p> <p>The default z-offset for BLTouch, 3dTouch and CrTouch is 0, so your prints won't stick without doing this step.</p>"},{"location":"bltouch/#pid-tuning-and-input-shaping","title":"Pid Tuning and Input Shaping","text":"<p>At least PID tuning (bed and extruder) and input shaping is required for acceptable printing.  If you try and print after running the installer.sh and a power cycle but before any calibration you will most likely have horrendous quality, the worst you have ever seen on the k1.   After PID tuning and input shaping you should see the same kind of quality as you get with stock k1 + input shaper fix.</p> <p>Note</p> <p>You can use the QUICK_START Macro to complete Bed and Nozzle PID Tuning and Input Shaping Automatically.</p>"},{"location":"bltouch/#pid-tuning","title":"Pid Tuning","text":"<p>Source: Calibrate Pid Settings</p> <p>For example you might run these:</p> <pre><code>PID_CALIBRATE_BED BED_TEMP=65\nPID_CALIBRATE_HOTEND HOTEND_TEMP=230\n</code></pre> <p>Note</p> <p>The <code>PID_CALIBRATE_BED</code> and <code>PID_CALIBRATE_HOTEND</code> macros are located in the <code>useful_macros.cfg</code> file and they have defaults values for BED_TEMP and HOTEND_TEMP so you can just run them by clicking on them if you want that same temperature.</p>"},{"location":"bltouch/#input-shaping","title":"Input Shaping","text":"<p>There is no default configuration for input shaping so it is essentially disabled out of the box.</p> <p>You can use the <code>SHAPER_CALIBRATE</code> macro to run input shaping, just be sure to <code>SAVE CONFIG</code> at the end, to choose the automatically selected shaper config, be aware though that the shaper chosen might be sub-optimal due to a slight difference in vibrations between two options.  So you should probably review the output and potentially choose an alternative if it gives you higher recommended max acceleration for minimal increase in vibration.</p> <p>Input Shaper Auto Calibration</p>"},{"location":"bltouch/#axis-twist-compensation","title":"Axis Twist Compensation","text":"<p>Next it is highly recommended to perform axis twist compensation calibration before doing anything else, this will affect the quality of your bed mesh, so best to do it before.</p> <ol> <li>Home All (<code>G28</code>)</li> <li>Run <code>AXIS_TWIST_COMPENSATION_CALIBRATE</code>  The calibration wizard will prompt you to measure the probe Z offset at a few points along the bed    Upon completion <code>SAVE_CONFIG</code></li> </ol> <p>Source: https://www.klipper3d.org/Axis_Twist_Compensation.html</p>"},{"location":"bltouch/#first-print","title":"First Print","text":"<p>You should optimise your probe z offset using baby stepping.</p> <p>In fluidd the save button after you finish or cancel your print can be a bit hard to find, look for</p> <p></p>"},{"location":"bltouch/#probing-speed","title":"Probing speed","text":"<p>On a K1/Max a faster lift_speed may counter the backlash on the Z-axis belts. Going too fast is likely making the bed bounce back in the opposite direction. Find the best speeds for probing by varying the probe_speed and lift_speed parameters.  Start with probe_speed=1 and vary the lift_speed values to find the optimal lift_speed first.</p> <pre><code>PROBE_ACCURACY probe_speed=1 lift_speed=15\n</code></pre> <p>In this case, lift_speed of 15mm/s seems optimal.</p> <p></p> <p>After determining the optimal lift_speed, different probe_speed values can be tested until the sweet spot is found. Here 1.0mm/s works most reliably, however, the slow speed will make the meshing process take longer.</p> <p></p> <p>Credit to Ales Omahen (@Havoc on discord) for this section</p>"},{"location":"bltouch/#other-calibrations","title":"Other Calibrations","text":"<p>Info</p> <p>The default value for pressure advance is set to <code>0.04</code></p> <p>Refer to Orcaslicer Calibration for more calibrations</p> <p>Refer to the Ellis Print Tuning Guide for more great tuning ideas.</p>"},{"location":"bltouch_wiring/","title":"BlTouch Wiring","text":"<p>Note</p> <p>This wiring section applies to K1/K1C/K1SE/K1M printers only</p> <p>The probe and the TOUCH port on the Nozzle MCU board both mate with a 5-pin Molex Picoblade connector. A 5-pin cable is needed to connect the probe to the TOUCH port.</p> <p>Some sellers may call the connector \"Micro JST SH 1.25\" but that is incorrect. Several premade cables are compatible. Most notably the Creality cable for their CR Touch probe:</p> <ul> <li>https://www.aliexpress.us/item/1005004960067376.html</li> <li>https://www.amazon.com/dp/B0BKPFY24M/</li> </ul> <p></p> <p></p> <p>Connect to TOUCH port on the nozzle MCU. it is accessible from the side left (LIDAR) side of the printhead and only the external cover of the printhead has to be removed.</p> <p></p> <p></p> <p>Important</p> <p>The configuration file assumes a bltouch is mounted on the back of the tool head.   If you have a Crtouch or are mounting your bltouch or 3dtouch using a different model, you must make additional changes to the bltouch.cfg file before trying to home your printer.</p> <p>Note</p> <p>Portions of this section are copied from the K1 Bltouch guide for helper script.</p>"},{"location":"btteddy/","title":"Btteddy","text":""},{"location":"btteddy/#where-can-i-get-help","title":"Where can I get help?","text":"<p>Come on over to the pellcorp discord server, the <code>#simple-af-btteddy</code> channel has been setup for anyone wanting support for btt eddy.</p> <p>https://discord.gg/2uGDzyJ3WX</p>"},{"location":"btteddy/#k1-series","title":"K1 Series","text":"<p>This guide assumes you have a K1, K1C, K1SE or K1 Max and you are running stock creality firmware 1.3.3.5 or higher (The firmware 1.3.3.5 is much older than 1.3.3.46 for example), or alternately you can use my prerooted firmware.</p>"},{"location":"btteddy/#ender-5-max","title":"Ender 5 Max","text":"<p>This probe is currently not supported on Ender 5 Max</p>"},{"location":"btteddy/#ender-3-v3-ke","title":"Ender 3 V3 KE","text":"<p>There is experimental untested support for a Default mount on the Ender 3 V3 KE.</p>"},{"location":"btteddy/#simple-af-for-rpi","title":"Simple AF for RPi","text":"<p>See Simple AF for RPi</p>"},{"location":"btteddy/#slicer-settings","title":"Slicer Settings","text":"<p>Danger</p> <p>Creality Print won't be able to see your printer after you have installed Simple AF, the only tested slicer we all use is OrcaSlicer, likely if you want to use Creality Print you will need to print via usb.</p> <p>Cura Slicer won't work out of the box for configuring START_PRINT variables as below, you need to change the start print EXTRUDER_TEMP and BED_TEMP to pass in the correct values, but since I don't use Cura Slicer I can't advise on that!</p> <p>There is an assumption that you are using a slicer like OrcaSlicer and Machine G-code like:</p> <p></p> <p>Machine start G-code <pre><code>M140 S0\nM104 S0\nSTART_PRINT EXTRUDER_TEMP=[nozzle_temperature_initial_layer] BED_TEMP=[bed_temperature_initial_layer_single]\n</code></pre></p> <p>Machine end G-code <pre><code>END_PRINT\n</code></pre></p>"},{"location":"btteddy/#custom-bed-mesh-profile","title":"Custom Bed Mesh Profile","text":"<p>If you want to select a specific predefined bed mesh profile (which disables adaptive mesh generation), you can pass in an additional <code>START_PRINT</code> parameter:</p> <p>You can either hard code it to a particular model, like <code>BED_MESH_PROFILE=myprofile</code> or you can specify a profile based on orca slicer variables, such as <code>BED_MESH_PROFILE=\"[curr_bed_type] - [filament_type]\"</code>, but you have to make sure you have all the possible profiles defined for each of the bed type and filament type combinations.</p> <p></p>"},{"location":"btteddy/#probe-installation","title":"Probe Installation","text":"<p>Danger</p> <p>If you are not using a side mount you must verify config changes for btteddy.cfg before homing your printer, using Screws Tilt Calculate or doing a bed mesh!  </p> <p>Ignoring these instructions can lead to significant damage to your build plate and/or probe.</p>"},{"location":"btteddy/#mount-options","title":"Mount Options","text":"Mount Printer URL Notes Default K1, K1C, K1M, K1SE https://www.printables.com/model/1012524-btteddy-creality-k1-k1c-k1-max-mounthttps://www.printables.com/model/1097856-btt-eddy-duo-mount Pellcorp K1, K1C, K1M, K1SE https://www.printables.com/model/965667-wip-k1-btt-eddy-rear-mount-v4 Ballaswag K1, K1C, K1M, K1SE https://makerworld.com/en/models/494931 Config copied from k1_mod sources, otherwise not tested Slam K1, K1C, K1M, K1SE https://www.printables.com/model/1195575-btt-eddy-mount-for-k1c Default Ender 3 KE https://www.printables.com/model/1002777-cr-touch-to-btt-eddy-adapter-bracket This probe and mount has not been tested on a KE running Simple AF, experimental"},{"location":"btteddy/#nozzle-offset","title":"Nozzle Offset","text":"<p>Warning</p> <p>If you use a different probe mount you must make sure the bottom of the btt eddy is between 2.6mm and 3mm from the tip of the nozzle, so if the nozzle is touching the bed (when both are cold), the bottom of the eddy should be at least 2.5mm above the bed and no more than 3mm.</p> <p>You can try this tool https://www.printables.com/model/1277844-btt-eddy-and-eddy-ng-setup-helpers</p>"},{"location":"btteddy/#btt-eddy-firmware","title":"BTT Eddy Firmware","text":"<p>Warning</p> <p>It is assumed that you have flashed your eddy with the firmware from https://github.com/pellcorp/klipper/blob/master/fw/K1/btteddy.uf2 before starting the installation!!!</p> <p>For K1 Series Simple AF there is a guide</p> <p>For Simple AF for RPi, you can follow this guide https://github.com/bigtreetech/Eddy?tab=readme-ov-file#compiling-firmware.   But make sure you are not trying to use any fork of klipper than pellcorp/klipper-rpi!  You can also skip this compilation step and just copy  the <code>~/klipper/fw/k1/btteddy.uf2</code> file to the Eddy after putting it into boot mode.</p>"},{"location":"btteddy/#installation","title":"Installation","text":"<p>Warning</p> <p>The installation section does not apply to Simple AF for RPi, See Simple AF for RPi</p> <p>The installation can only be performed on a printer which has been rooted and ssh granted</p> <p>You need root access, if you are not already root, then follow the excellent Helper Script Enable Root Access instructions.</p> <p>Tip</p> <p>ZeroDotCmd (aka Zero on discord) has provided an excellent BTT Eddy installation video, you can find it https://www.youtube.com/watch?v=B17sS1klRxA</p> <p>Please note however that the macros referenced in the video guide have been removed and you should instead follow the Calibration section of this wiki, I do not have the time to maintain the old guided macros, but you can still use the QUICK_START macro to do the pid and input shaper tuning.</p>"},{"location":"btteddy/#factory-reset","title":"Factory Reset","text":"<p>You must do a factory reset only if you have installed Helper Script or Fluidd/Mainsail directly from Creality, otherwise you can safely proceed directly to installation.    If you have setup your printer with stock firmware only it can be quite handy to skip a factory reset so that you can use Switch to Stock</p> <pre><code>wget --no-check-certificate https://raw.githubusercontent.com/pellcorp/creality/main/k1/services/S58factoryreset -O /tmp/S58factoryreset\nchmod +x /tmp/S58factoryreset\n/tmp/S58factoryreset reset\n</code></pre> <p>Danger</p> <p>It is really important you do not close the ssh session until you get this message:</p> <p></p> <p>It can take up to 5 minutes for a factory restart to finish, it is vital you do not power cycle your printer before the stock screen appears. There may be a 3002 error on the screen, this is completely normal.   If you are planning to install Simple AF you can ignore it, if you are trying to go back to stock, power cycle the printer again to clear the error.  </p> <p>Failing to follow this advice can lead to your printer getting bricked and requiring much more involved intervention to recover!</p> <p></p>"},{"location":"btteddy/#clone-the-repo","title":"Clone the Repo","text":"<pre><code>git config --global http.sslVerify false\ngit clone https://github.com/pellcorp/creality.git /usr/data/pellcorp\nsync\n</code></pre>"},{"location":"btteddy/#run-the-installer","title":"Run the installer","text":"<p>Note</p> <p>If you have pellcorp-overrides in github but not stored locally, you need to recreate the ~/pellcorp-overrides directory before running the installer.sh!</p> <p>To run the script, you must specify the probe you want to use.</p> <pre><code>/usr/data/pellcorp/installer.sh --install btteddy --mount Mount\n</code></pre> <p>Warning</p> <p>For <code>Mount</code> you must specify the mount option for the mount you have used, if you do not do this the printer will be incorrectly configured for your mount, and bed meshes, x and y limits and related config will be wrong.   Please refer to Mount Options for supported mounts.   </p> <p>If you are using a non-supported mount you should specify a mount option as close to your mount as possible and properly adjust your configuration after installation before trying to perform a bed mesh or Screws Tilt Calculate!</p>"},{"location":"btteddy/#post-installation","title":"Post Installation","text":""},{"location":"btteddy/#mcu-firmware-updates-are-pending","title":"MCU Firmware updates are pending","text":"<p>At the end of the installer process if you get this message:</p> <pre><code>WARNING: MCU Firmware updates are pending you need to power cycle your printer!\n</code></pre> <p>It means that new MCU firmware updates need to be applied and this can only be done by power cycling the printer.  After your printer is power cycled you can verify firmware was updated with the <code>CHECK_FIRMWARE</code> macro from Fluidd or Mainsail, if you see this message:</p> <pre><code>INFO: Your MCU Firmware is up to date!\n</code></pre> <p>Your printer MCU firmware was updated successfully.   If you still see the <code>MCU Firmware updates are pending you need to power cycle your printer!</code> message after a power cycle, check the <code>/tmp/mcu_update.log</code>, you may be asked to provide this file on Discord if you need additional assistance, sometimes an additional power cycle can solve the problem, there is a very short window of time (15 seconds) in which the MCU firmware can be updated, so  there is a chance it will work after an additional power cycle.</p>"},{"location":"btteddy/#verify-usb-key","title":"Verify USB Key","text":"<p>It is important to make sure you have a way to emergency factory reset the printer, if the worst happens.   There is a macro in Simple AF called <code>CHECK_USB_KEY</code> that will wait for you to plug a USB thumb drive (aka USB key) in and tell you if it was able to be successfully mounted.</p> <p>You can find the CHECK_USB_KEY macro in Fluidd or Mainsail, because Fluidd and Mainsail are already installed, you can access Fluidd by opening your browser and connecting using http://X.X.X.X, where X.X.X.X is your ip address that you used to login via ssh to your printer, you can also access Fluidd via http://X.X.X.X:4408 and Mainsail via http://X.X.X.X:4409!</p> <p></p> <p>After running the macro you should see output like the following:</p> <p></p> <ul> <li>If you get the message: <code>INFO - USB Key was recognised and mounted correctly (/tmp/udisk/sda1)</code>, your USB thumb drive (aka USB key) is perfect to use for a factory reset.</li> <li>If you get no message at all before the script ends (after 60 seconds), your USB thumb drive (aka USB key) is defective.   You can check the <code>messages</code> file in the logs section of your UI to get more details about why the usb key could not be mounted!</li> </ul> <p>Tip</p> <p>You should verify your USB thumb drive (aka USB key) often just to make sure you have something if you need to unbrick your printer, simply type <code>CHECK_USB_KEY</code> or hit the button in Fluidd / Mainsail The USB key should be FAT32 formatted and be no larger than 32GB!</p> <p>Note</p> <p>If you have plugged your btt eddy into the front usb port, you are going to have to temporarily remove the btt eddy from the front usb slot and replace it with your USB thumb drive, after you have finished verifying the USB thumb drive can be used in an emergency, you can replace the btt eddy into the front usb slot and restart klipper or power cycle your printer.</p> <p></p> <ul> <li>If you get the message: <code>INFO - USB Key was recognised and mounted correctly (/tmp/udisk/sda1)</code>, your USB thumb drive (aka USB key) is perfect to use for a factory reset.</li> <li>If you get no message at all before the script ends (after 60 seconds), your USB thumb drive (aka USB key) is defective.   You can check the <code>messages</code> file in the logs section of your UI to get more details about why the usb key could not be mounted!</li> </ul>"},{"location":"btteddy/#timer-too-close-and-microsteps","title":"Timer too close and microsteps","text":"<p>For btteddy you cannot use more than <code>microsteps: 32</code>, the MCU cannot handle both more microsteps and eddy, it puts too much pressure on the system and it cause stuttering during bed meshes, it is also been known to cause klipper to crash during repeated bed meshes.</p>"},{"location":"btteddy/#calibration","title":"Calibration","text":"<p>Warning</p> <p>The following calibration steps are required to setup a new printer:</p> <ul> <li>Drive Current Calibration</li> <li>Mapping Eddy Readings To Nozzle Heights</li> <li>Temperature Compensation Calibration</li> <li>PID Tuning and Input Shaping</li> </ul> <p>Danger</p> <p>It is extremely important that you perform the following calibrations while the btt eddy is cool, if you calibrate the eddy hot, you will experience <code>Error during homing z: Eddy current sensor error</code> errors while homing and performing bed mesh if the btt is significantly cooler than it was while doing initial calibration.   </p>"},{"location":"btteddy/#drive-current-calibration","title":"Drive Current Calibration","text":"<ol> <li>Home XY (<code>G28 X Y</code>)</li> <li>Make sure nozzle is centred on bed</li> <li>Run <code>_SET_KIN_MAX_Z</code> and then move the toolhead so that the bottom of the eddy is approximately 20mm from the bed, please try and be as accurate as possible with this distance, it's better to be slightly closer to the bed than further away.</li> <li>Run <code>BTTEDDY_CALIBRATE_DRIVE_CURRENT</code></li> <li>Run SAVE_CONFIG</li> </ol> <p>Source: https://github.com/bigtreetech/Eddy?tab=readme-ov-file#2-drive-current-calibration</p> <p>Note</p> <p>The auxiliary fan may turn on until the btt eddy temp is less than 40c before starting the actual calibration.  If you are in a hot climate you may need to adjust the <code>btteddy_macro.cfg</code> <code>variable_calibration_max_temp</code> value to something higher than 40c if you can't get the btt eddy under 40c with the aux fan easily.</p>"},{"location":"btteddy/#mapping-eddy-readings-to-nozzle-heights","title":"Mapping Eddy Readings To Nozzle Heights","text":"<ol> <li>Home X and Y (<code>G28 X Y</code>)</li> <li>Make sure nozzle is centred on bed</li> <li>Run <code>BTTEDDY_CURRENT_CALIBRATE</code> Follow the Paper Test Method</li> <li>After clicking Accept, the printer is going to move the bed up and down quite a few times as part of the calibration, do not interrupt it</li> <li>Upon completion <code>SAVE_CONFIG</code></li> </ol> <p>Source: https://github.com/bigtreetech/Eddy?tab=readme-ov-file#3-mapping-eddy-readings-to-nozzle-heights</p> <p>Warning</p> <p>Do not use a metal feeler gauge for this step, it could damage your eddy!!!</p> <p>Note</p> <p>The auxiliary fan may turn on until the btt eddy temp is less than 40c before starting the actual calibration.  If you are in a hot climate you may need to adjust the <code>btteddy_macro.cfg</code> <code>variable_calibration_max_temp</code> value to something higher than 40c if you can't get the btt eddy under 40c with the aux fan easily.</p> <p>Is normal to show the Z position at almost at the max height of the printer even if the nozzle is somewhere in the middle or even close to the bed, this is not a bug, its intentional.   Until this calibration step is completed, the Z axes cannot be homed, so we make the printer pretend the bed is down the bottom of the printer so that you can freely move the bed up to meet the nozzle during the paper test without running into out of range issues.  You however won't be able to move the bed further away from the nozzle more than a few mm.</p> <p></p>"},{"location":"btteddy/#temperature-compensation-calibration","title":"Temperature Compensation Calibration","text":"<ol> <li>Home All (<code>G28</code>)</li> <li>Make sure nozzle is centred on bed</li> <li>Run <code>BTTEDDY_TEMPERATURE_PROBE_CALIBRATE</code> Upon completion <code>SAVE_CONFIG</code></li> </ol> <p>Source: https://github.com/bigtreetech/Eddy?tab=readme-ov-file#5-temperature-compensation-calibration-eddy-usb-only</p> <p>Warning</p> <p>Do not use a metal feeler gauge for this step, it could damage your eddy!!!</p> <p>Tip</p> <p>If you are struggling to get over about 80c, you can end the calibration early with the <code>TEMPERATURE_PROBE_COMPLETE</code> macro, just know that if you end the calibration early and then you try to print really hot and the eddy gets hotter than the hottest temp you calibrated the eddy is going to read the bed wrong and cause issues for homing but especially bed meshes.</p>"},{"location":"btteddy/#pid-tuning-and-input-shaping","title":"Pid Tuning and Input Shaping","text":"<p>At least PID tuning (bed and extruder) and input shaping is required for acceptable printing.  If you try and print after running the installer.sh and a power cycle but before any calibration you will most likely have horrendous quality, the worst you have ever seen on the k1.   After PID tuning and input shaping you should see the same kind of quality as you get with stock k1 + input shaper fix.</p> <p>Note</p> <p>You can use the QUICK_START Macro to complete Bed and Nozzle PID Tuning and Input Shaping Automatically.</p>"},{"location":"btteddy/#pid-tuning","title":"Pid Tuning","text":"<p>Source: Calibrate Pid Settings</p> <p>For example you might run these:</p> <pre><code>PID_CALIBRATE_BED BED_TEMP=65\nPID_CALIBRATE_HOTEND HOTEND_TEMP=230\n</code></pre> <p>Note</p> <p>The <code>PID_CALIBRATE_BED</code> and <code>PID_CALIBRATE_HOTEND</code> macros are located in the <code>useful_macros.cfg</code> file and they have defaults values for BED_TEMP and HOTEND_TEMP so you can just run them by clicking on them if you want that same temperature.</p>"},{"location":"btteddy/#input-shaping","title":"Input Shaping","text":"<p>There is no default configuration for input shaping so it is essentially disabled out of the box.</p> <p>You can use the <code>SHAPER_CALIBRATE</code> macro to run input shaping, just be sure to <code>SAVE CONFIG</code> at the end, to choose the automatically selected shaper config, be aware though that the shaper chosen might be sub-optimal due to a slight difference in vibrations between two options.  So you should probably review the output and potentially choose an alternative if it gives you higher recommended max acceleration for minimal increase in vibration.</p> <p>Input Shaper Auto Calibration</p>"},{"location":"btteddy/#axis-twist-compensation","title":"Axis Twist Compensation","text":"<p>If you are using a rear mount it is highly recommended to perform axis twist compensation, this will affect the quality of your bed mesh, so best to do it before.</p> <p>Tip</p> <p>There is no need to run axis twist compensation if you have mounted the eddy with a side mount that has a 0 y offset!</p> <ol> <li>Home All (<code>G28</code>)</li> <li>Run <code>AXIS_TWIST_COMPENSATION_CALIBRATE</code> The calibration wizard will prompt you to measure the probe Z offset at a few points along the bed    Upon completion <code>SAVE_CONFIG</code></li> </ol> <p>Source: https://www.klipper3d.org/Axis_Twist_Compensation.html</p> <p>Warning</p> <p>Do not use a metal feeler gauge for this step, it could damage your eddy!!!</p>"},{"location":"btteddy/#first-print","title":"First Print","text":"<p>The save baby stepping button in fluidd / mainsail does nothing for btteddy, the z-offset is automatically saved to the variables.cfg, we copied the feature from Helper Script: https://guilouz.github.io/Creality-Helper-Script-Wiki/helper-script/save-z-offset-macros/</p>"},{"location":"btteddy/#bed-mesh","title":"Bed Mesh","text":"<p>Now you can now run your first bed mesh: <code>BED_MESH_CALIBRATE</code></p> <p>Source: https://ballaswag.github.io/blog/creality-k1-btt-eddy-guide/</p> <p>Source: https://github.com/bigtreetech/Eddy</p>"},{"location":"btteddy/#other-calibrations","title":"Other Calibrations","text":"<p>Info</p> <p>The default value for pressure advance is set to <code>0.04</code></p> <p>Refer to Orcaslicer Calibration for more calibrations</p> <p>Refer to the Ellis Print Tuning Guide for more great tuning ideas.</p>"},{"location":"btteddy_faq/","title":"Frequently Asked Questions","text":""},{"location":"btteddy_faq/#how-can-i-skip-waiting-for-btt-eddy-to-be-at-least","title":"How can I skip Waiting for btt eddy to be at least ...?","text":"<p>In the latest version of Simple AF there is a variable in the <code>btteddy_macro.cfg</code> which you can flip to False, so from:</p> <pre><code># if we should wait for eddy to be at calibration temp before homing\nvariable_wait_for_temp: True\n</code></pre> <p>To:</p> <pre><code># if we should wait for eddy to be at calibration temp before homing\nvariable_wait_for_temp: False\n</code></pre> <p>Note</p> <p>Until recently this configuration was in the <code>sensorless.cfg</code> file as <code>variable_btteddy_wait_for_temp: True</code>, its been moved where it belongs in <code>btteddy_macro.cfg</code>!</p>"},{"location":"btteddy_flashing/","title":"Btteddy flashing","text":"<p>Danger</p> <p>THIS IS A RISKY OPERATION YOU CAN BRICK YOUR EDDY</p> <p>Flashing Btt DUO</p> <p>Make sure to switch it to USB Mode first of all!!!</p> <p>It is possible this method will not work for the BTT Duo, especially if it is currently flashed for Can from the factory,  and you may need to resort to the legacy approach documented here</p>"},{"location":"btteddy_flashing/#flashing-on-windows-or-linux-desktop","title":"Flashing on Windows or Linux Desktop","text":""},{"location":"btteddy_flashing/#connecting-in-bootsel-mode","title":"Connecting in BOOTSEL mode","text":"<p>You need to connect your btt eddy to your computer in BOOTSEL mode, you do this by disconnecting the eddy usb or eddy duo, and then push and hold boot button on Eddy (It's next to where the cable plugs in) and at the same time, plug in the cable to your computer.</p> <p>On windows or a Linux Desktop if you successfully connected the eddy in bootsel mode, it will be mounted as a new drive on your computer.</p>"},{"location":"btteddy_flashing/#flashing-btteddyuf2-file","title":"Flashing btteddy.uf2 file","text":"<p>Copy the btteddy.uf2 file across to the btt eddy drive, it should automatically flash the eddy and disconnect for you.</p> <p>Once this is done go ahead and reconnect your eddy to your K1.</p>"},{"location":"btteddy_flashing/#on-printer","title":"On Printer","text":"<p>You can also flash the eddy on your printer (K1, K1C, K1SE, K1M, Ender 3 V3 KE, etc) but you need to be able to disconnect and reconnect it for this to work, there is currently no way to get the eddy into boot mode any other way!</p> <p>So by default when connecting the btt eddy to the K1, <code>lsusb</code> will report:</p> <pre><code>Bus 001 Device 099: ID 1d50:614e OpenMoko, Inc. USB2.0 Hub\n</code></pre> <p>This means it is not in boot mode and you cannot flash any firmware to it.  You need to hold down the boot button and re-connect your btt eddy to your K1, you will know this worked if you type <code>lsusb</code> and see:</p> <pre><code>Bus 001 Device 101: ID 2e8a:0003  USB2.0 Hub\n</code></pre> <p>Verify that the btt eddy has been mounted as a disk drive on the K1 by running <code>mount</code>, you should see a <code>/tmp/udisk/sda1</code> entry:</p> <p></p> <p>Once this has happened you will be able to copy the btteddy.uf2 file to the eddy via this command:</p> <pre><code>wget --no-check-certificate https://raw.githubusercontent.com/pellcorp/klipper/master/fw/K1/btteddy.uf2 -O /tmp/btteddy.uf2\ncp /tmp/btteddy.uf2 /tmp/udisk/sda1/\n</code></pre> <p>If you check <code>lsusb</code> again, it should have switched back to:</p> <pre><code>Bus 001 Device 102: ID 1d50:614e OpenMoko, Inc. USB2.0 Hub\n</code></pre>"},{"location":"btteddy_flashing/#how-do-i-know-it-flashed-correctly","title":"How do I know it flashed correctly?","text":"<p>Unfortunately I know of no way to test this except by plugging it back into the K1, restarting klipper and verifying via the System tab, a correctly flashed eddy will have </p> <p></p>"},{"location":"btteddy_flashing/#migrating-from-k1-mod","title":"Migrating from K1 Mod","text":"<p>The K1 mod has an older version of the btteddy firmware, if you still see this in the System tab, then your flashing failed</p> <p></p>"},{"location":"btteddy_troubleshooting/","title":"Troubleshooting","text":""},{"location":"btteddy_troubleshooting/#error-during-homing-z-eddy-current-sensor-error","title":"Error during homing z: Eddy current sensor error","text":"<p>You might need to adjust your <code>reg_drive_current</code>, for more details: https://github.com/bigtreetech/Eddy?tab=readme-ov-file#sometimes-i-get-error-during-homing-probe-eddy-current-sensor-error</p>"},{"location":"btteddy_troubleshooting/#mcu-protocol-error-mcu-eddy-unknown-command-debug_read","title":"MCU Protocol Error - mcu 'eddy' Unknown command: debug_read","text":"<p>If you get the following error, it means that the eddy is not connected to the printer.   This is either because its physically not connected, the wiring is wrong, the usb subsystem has disconnected the eddy during a restart or the serial id is wrong</p> <p></p> <p>So from ssh run a <code>lsusb</code> and make sure you can see:</p> <p></p> <p>If you cannot see it in <code>lsusb</code>, then it very likely means either the eddy is wired incorrectly, or if was working, it just means that an attempt to restart the eddy failed because the K1 refused to recognise it, there is no recourse except to restart the host via Fluidd / Mainsail (or power cycle the printer)</p> <p>If you can see the eddy in lsusb, then you should try to update the serial (see next)</p>"},{"location":"btteddy_troubleshooting/#manual-btt-eddy-serial-device-configuration","title":"Manual BTT Eddy Serial Device configuration","text":"<p>You can run the following command to fix your serial if you forgot to plug your btt eddy in during the installation or update:</p> <pre><code>~/pellcorp/k1/installer.sh --fix-serial\n</code></pre> <p>Note</p> <p>If you run the above and receive an error like:</p> <pre><code>```\nroot@K1Max-AF34 /root [#] ~/pellcorp/installer.sh --fix-serial\n-sh: /root/pellcorp/installer.sh: not found\n```\n</code></pre> <p>It means you are on an older version of Simple AF and you should instead use the old style commands:</p> <pre><code>```\n/usr/data/pellcorp/k1/installer.sh --fix-serial\n```\n</code></pre>"},{"location":"btteddy_troubleshooting/#eddy-is-not-connected-aborting-homing-z","title":"Eddy is not connected, aborting homing Z","text":"<p>If you see this error when trying to home your printer, it is a clear indication that the eddy was disconnected and you should look for a <code>mcu 'eddy' disconnected</code> error in your klippy.log or gcode console, if the eddy was momentarily disconnected (so if you run <code>lsusb</code> on the printer the eddy shows up), you can simply restart klipper from the services menu in Fluidd or Mainsail, if the eddy completely disappeared you will need to power cycle the printer!</p>"},{"location":"btteddy_wiring/","title":"Eddy Wiring","text":"<p>Note</p> <p>This wiring section applies to K1/K1C/K1SE/K1M printers only</p> <p>Confirm the USB wiring based on this diagram(s) On a K1M you can use the lidar cable either directly by repinning it, or via the pass through lidar port on the toolhead.  However you cannot use the lidar port on the toolhead for K1, K1C or K1SE.   The reason this does not work is because for Lidar on the K1M creality actually routes a completely separate USB cable from the mainboard.</p> <p> </p>"},{"location":"cartographer/","title":"Cartographer","text":""},{"location":"cartographer/#where-can-i-get-help","title":"Where can I get help?","text":"<p>Come on over to the pellcorp discord server, the <code>#simple-af-carto</code> channel has been setup for anyone wanting support for cartographer.</p> <p>https://discord.gg/2uGDzyJ3WX</p>"},{"location":"cartographer/#looking-for-the-beta","title":"Looking for the Beta?","text":"<p>Even though its technically been released, its considered a beta by the Simple AF project for at least the first few weeks after the software is officially released by cartographer3d.com!</p> <p>See Cartographer Beta</p>"},{"location":"cartographer/#thanks","title":"Thanks","text":"<p>Thanks to Richard from https://cartographer3d.com and Zarboz from https://wattskraken.xyz/ for donating Cartographers to the Simple AF project to add support and continue to support the cartographer.</p>"},{"location":"cartographer/#firmware-requirements","title":"Firmware requirements","text":""},{"location":"cartographer/#k1-series","title":"K1 Series","text":"<p>This guide assumes you have a K1, K1C, K1SE or K1 Max and you are running stock creality firmware 1.3.3.5 or higher (The firmware 1.3.3.5 is much older than 1.3.3.46 for example), or alternately you can use my prerooted firmware.</p>"},{"location":"cartographer/#ender-5-max","title":"Ender 5 Max","text":"<p>This guide assumes you are running stock Creality firmware 1.2.0.10 or higher on your Ender 5 Max.</p> <p>The stock firmware comes pre-rooted, with the default root password being <code>Creality@2024_Wh_464</code></p> <p>Please note that you will need to change the screen orientation to horizontal, here is a model for that https://www.printables.com/model/1246910-ender-5-max-screen-bracket</p>"},{"location":"cartographer/#ender-3-v3-ke","title":"Ender 3 V3 KE","text":"<p>This guide assumes you have a stock Ender 3 V3 KE with Nebula Pad with Root enabled, when you get to installation below, you should specify the <code>--mount Default</code> to install Simple AF on the KE for Cartographer.</p> <p>Please note that you will need to change the screen orientation to horizontal, here is a model for that https://www.printables.com/model/727362-ender-3-v3-ke-screen-holder-landscape-for-guppyscr, but please do not follow the installation instructions on that page, just print the model and remount your screen only! An alternative model which honestly seems a bit cleaner: https://www.printables.com/model/706657-creality-ender-3-v3-e3v3-se-ke-and-cr-10-se-portra</p>"},{"location":"cartographer/#simple-af-for-rpi","title":"Simple AF for RPi","text":"<p>See Simple AF for RPi</p>"},{"location":"cartographer/#slicer-settings","title":"Slicer Settings","text":"<p>Danger</p> <p>Creality Print won't be able to see your printer after you have installed Simple AF, the only tested slicer we all use is OrcaSlicer, likely if you want to use Creality Print you will need to print via usb.</p> <p>Cura Slicer won't work out of the box for configuring START_PRINT variables as below, you need to change the start print EXTRUDER_TEMP and BED_TEMP to pass in the correct values, but since I don't use Cura Slicer I can't advise on that!</p> <p>If you have used a cartographer with k1-klipper, please note that the <code>PRINT_START</code> macro specified in their docs is not supported by this project.   You must change your Slicer Start Print Machine G-Code (see next)</p> <p>There is an assumption that you are using a slicer like OrcaSlicer and Machine G-code like:</p> <p></p> <p>Machine start G-code</p> <pre><code>M140 S0\nM104 S0\nSTART_PRINT EXTRUDER_TEMP=[nozzle_temperature_initial_layer] BED_TEMP=[bed_temperature_initial_layer_single]\n</code></pre> <p>Machine end G-code</p> <pre><code>END_PRINT\n</code></pre>"},{"location":"cartographer/#custom-bed-mesh-profile","title":"Custom Bed Mesh Profile","text":"<p>If you want to select a specific predefined bed mesh profile (which disables adaptive mesh generation), you can pass in an additional <code>START_PRINT</code> parameter:</p> <p>You can either hard code it to a particular model, like <code>BED_MESH_PROFILE=myprofile</code> or you can specify a profile based on orca slicer variables, such as <code>BED_MESH_PROFILE=\"[curr_bed_type] - [filament_type]\"</code>, but you have to make sure you have all the possible profiles defined for each of the bed type and filament type combinations.</p> <p></p>"},{"location":"cartographer/#probe-installation","title":"Probe Installation","text":"<p>Danger</p> <p>If you are not using a side mount you must verify config changes for cartotouch.cfg before homing your printer, using Screws Tilt Calculate or doing a bed mesh!  </p> <p>Ignoring these instructions can lead to significant damage to your build plate and/or probe.</p>"},{"location":"cartographer/#mount-options","title":"Mount Options","text":"Mount Printer Carto URL Notes Default K1, K1C, K1M, K1SE Right Angle https://www.printables.com/model/1037606-cartographer-3d-right-angle-k1-series-mount D3vilStock K1, K1C, K1M, K1SE Flat Pack https://www.printables.com/model/684338-k1-k1max-eddy-current-mount-cartographer BootyGantry K1, K1C, K1M, K1SE Right Angle https://github.com/tlace17/K1-Linear-Rail-Gantry/blob/main/STLs/Probe%20Mounts/Rail%20Carriage%20Carto%20Mount.stl May require shimming for correct nozzle offset SkeletorMK7 K1, K1C, K1M, K1SE Low Profile https://www.printables.com/model/833769-the-skeletor-collection-a-creality-k1k1-maxk1c-cooGet it printed: https://mk7.tbkm.xyz/ This is only for the low profile cartographer version of the mount!!! SkeletorRightAngle K1, K1C, K1M, K1SE Right Angleor Standard https://www.printables.com/model/1362668-skeletor-mk7-side-mounted-cartographer-integration This mount can support standard cartographer too PurcellV5 K1, K1C, K1M, K1SE Right Angle https://www.printables.com/model/1071493-cartographer-probe-side-mount-options-for-crealityhttps://www.printables.com/model/1239076-creality-k1-cartographer-right-angle-mount This also works with V3 and V4, probably also V8 SimplyHexed Ender 5 Max Right Angle https://www.printables.com/model/1209230-ender-5-max-simply-hexed Requires custom shroud Default Ender 3 V3 SE Right Angle https://www.printables.com/model/732262-ender-3-v3-ke-beaconcartographer-mount Will probably require shimming especially if you ugprade to a k1 hotend Default Ender 3 V3 KE Right Angle https://www.printables.com/model/732262-ender-3-v3-ke-beaconcartographer-mount Might require shimming depending on the hotend / nozzle you use"},{"location":"cartographer/#nozzle-offset","title":"Nozzle Offset","text":"<p>Warning</p> <p>It is vital that you verify the coil to nozzle tip distance is within the valid range of 2.6 to 3mm, you can use this simple tool to verify the range: https://www.printables.com/model/1325363-cartographer-and-beacon-z-offset-goldilocks-tool</p> <p>Just be sure to use digital calipers to verify the print printed with the correct size before relying on it, if you have trouble with  your z not being always entirely accurate consider printing the model on its side.</p>"},{"location":"cartographer/#cartographer-firmware","title":"Cartographer Firmware","text":"<p>Warning</p> <p>For K1 Series (which includes K1, K1C, K1SE, K1 Max, Ender 3 V3 KE and Ender 5 Max) Simple AF you must flash your cartographer with <code>CARTOGRAPHER K1 5.1.0</code> or <code>CARTOGRAPHER K1 5.0.0</code> survey firmware before trying to use your printer:</p> <p></p> <p>For K1 Series (which includes K1, K1C, K1SE, K1 Max, Ender 3 V3 KE and Ender 5 Max) Simple AF there is a guide.</p> <p>For Simple AF for RPi, you can use the standard cartographer guide https://docs.cartographer3d.com/cartographer-probe/firmware/firmware-updating/via-katapult/usb-flash#usb-katapult-updating</p> <p>If you are using a Pi3 or less (so CB1, CB2, OPi 3, etc) to run klipper, I strongly recommend using the K1 variant of the cartographer firmware, you can do that  in the firmware script by enabling Advanced Mode and Enabling Creality K Series Firmware.</p>"},{"location":"cartographer/#installation","title":"Installation","text":"<p>Warning</p> <p>The installation section does not apply to Simple AF for RPi, See Simple AF for RPi</p> <p>The installation can only be performed on a printer which has been rooted and ssh granted</p> <p>You need root access, if you are not already root, then follow the excellent Helper Script Enable Root Access instructions.</p> <p>Tip</p> <p>ZeroDotCmd (aka Zero on discord) has provided an excellent Cartographer installation video, you can find it https://www.youtube.com/watch?v=GuxMITM9o4I</p> <p>Please note however that the macros referenced in the video guide have been removed and you should instead follow the Calibration section of this wiki, I do not have the time to maintain the old guided macros, but you can still use the QUICK_START macro to do the pid and input shaper tuning.</p>"},{"location":"cartographer/#factory-reset","title":"Factory Reset","text":"<p>You must do a factory reset only if you have installed Helper Script or Fluidd/Mainsail directly from Creality, otherwise you can safely proceed directly to installation.    If you have setup your printer with stock firmware only it can be quite handy to skip a factory reset so that you can use Switch to Stock</p> <pre><code>wget --no-check-certificate https://raw.githubusercontent.com/pellcorp/creality/main/k1/services/S58factoryreset -O /tmp/S58factoryreset\nchmod +x /tmp/S58factoryreset\n/tmp/S58factoryreset reset\n</code></pre> <p>Danger</p> <p>It is really important you do not close the ssh session until you get this message:</p> <p></p> <p>It can take up to 5 minutes for a factory restart to finish, it is vital you do not power cycle your printer before the stock screen appears. There may be a 3002 error on the screen, this is completely normal.   If you are planning to install Simple AF you can ignore it, if you are trying to go back to stock, power cycle the printer again to clear the error.  </p> <p>Failing to follow this advice can lead to your printer getting bricked and requiring much more involved intervention to recover!</p> <p></p>"},{"location":"cartographer/#clone-the-repo","title":"Clone the Repo","text":"<pre><code>git config --global http.sslVerify false\ngit clone https://github.com/pellcorp/creality.git /usr/data/pellcorp\nsync\n</code></pre>"},{"location":"cartographer/#run-the-installer","title":"Run the installer","text":"<p>Note</p> <p>If you have pellcorp-overrides in github but not stored locally, you need to recreate the ~/pellcorp-overrides directory before running the installer.sh!</p> <p>To run the script, you must use the following command:</p> <pre><code>/usr/data/pellcorp/installer.sh --install cartotouch --mount Mount\n</code></pre> <p>Warning</p> <p>For <code>Mount</code> you must specify the mount option for the mount you have used, if you do not do this the printer will be incorrectly configured for your mount, and bed meshes, x and y limits and related config will be wrong.   Please refer to Mount Options for supported mounts.   </p> <p>If you are using a non-supported mount you should specify a mount option as close to your mount as possible and properly adjust your configuration after installation before trying to perform a bed mesh or Screws Tilt Calculate!</p>"},{"location":"cartographer/#post-installation","title":"Post Installation","text":""},{"location":"cartographer/#mcu-firmware-updates-are-pending","title":"MCU Firmware updates are pending","text":"<p>At the end of the installer process if you get this message:</p> <pre><code>WARNING: MCU Firmware updates are pending you need to power cycle your printer!\n</code></pre> <p>It means that new MCU firmware updates need to be applied and this can only be done by power cycling the printer.  After your printer is power cycled you can verify firmware was updated with the <code>CHECK_FIRMWARE</code> macro from Fluidd or Mainsail, if you see this message:</p> <pre><code>INFO: Your MCU Firmware is up to date!\n</code></pre> <p>Your printer MCU firmware was updated successfully.   If you still see the <code>MCU Firmware updates are pending you need to power cycle your printer!</code> message after a power cycle, check the <code>/tmp/mcu_update.log</code>, you may be asked to provide this file on Discord if you need additional assistance, sometimes an additional power cycle can solve the problem, there is a very short window of time (15 seconds) in which the MCU firmware can be updated, so  there is a chance it will work after an additional power cycle.</p>"},{"location":"cartographer/#verify-usb-key","title":"Verify USB Key","text":"<p>It is important to make sure you have a way to emergency factory reset the printer, if the worst happens.   There is a macro in Simple AF called <code>CHECK_USB_KEY</code> that will wait for you to plug a USB thumb drive (aka USB key) in and tell you if it was able to be successfully mounted.</p> <p>You can find the CHECK_USB_KEY macro in Fluidd or Mainsail, because Fluidd and Mainsail are already installed, you can access Fluidd by opening your browser and connecting using http://X.X.X.X, where X.X.X.X is your ip address that you used to login via ssh to your printer, you can also access Fluidd via http://X.X.X.X:4408 and Mainsail via http://X.X.X.X:4409!</p> <p></p> <p>After running the macro you should see output like the following:</p> <p></p> <ul> <li>If you get the message: <code>INFO - USB Key was recognised and mounted correctly (/tmp/udisk/sda1)</code>, your USB thumb drive (aka USB key) is perfect to use for a factory reset.</li> <li>If you get no message at all before the script ends (after 60 seconds), your USB thumb drive (aka USB key) is defective.   You can check the <code>messages</code> file in the logs section of your UI to get more details about why the usb key could not be mounted!</li> </ul> <p>Tip</p> <p>You should verify your USB thumb drive (aka USB key) often just to make sure you have something if you need to unbrick your printer, simply type <code>CHECK_USB_KEY</code> or hit the button in Fluidd / Mainsail The USB key should be FAT32 formatted and be no larger than 32GB!</p> <p>Note</p> <p>If you have plugged your cartographer into the front usb port, you are going to have to temporarily remove the cartographer from the front usb slot and replace it with your USB thumb drive (aka USB key), after you have finished verifying the USB thumb drive (aka USB key) can be used in an emergency, you can replace the cartographer into the front usb slot and restart klipper or power cycle your printer.</p>"},{"location":"cartographer/#timer-too-close-and-microsteps","title":"Timer too close and microsteps","text":"<p>For cartographer you cannot use more than <code>microsteps: 32</code>, the MCU cannot handle high microsteps and cartographer, it puts too much pressure on the system and it will cause stuttering during bed meshes.</p>"},{"location":"cartographer/#calibration","title":"Calibration","text":"<p>Warning</p> <p>The following calibration steps are required to setup a new printer:</p> <ul> <li>Enable Touch Mode</li> <li>Manual Cartographer Calibrate</li> <li>Cartographer Threshold Scan</li> <li>Cartographer Touch Calibration</li> <li>PID Tuning and Input Shaping</li> </ul> <p>Note</p> <p>If you are running calibration for a printer that has previously been calibrated, the following SAVE_CONFIG sections must be removed from the bottom of the printer.cfg (if they exist) before redoing these calibrations:</p> <ul> <li><code>[scanner model default]</code></li> <li><code>[scanner]</code></li> <li><code>[axis_twist_compensation]</code></li> <li><code>[bed_mesh]</code></li> </ul>"},{"location":"cartographer/#enable-touch-mode","title":"Enable Touch Mode","text":"<p>To be able to set up the printer for cartographer with touch mode for printing you need to make sure the mode is set to touch.</p> <ol> <li>Run <code>PROBE_SWITCH MODE=touch</code> Upon completion <code>SAVE_CONFIG</code></li> </ol> <p>Source: https://docs.cartographer3d.com/original-plugin/installation/calibration#initial-calibration</p>"},{"location":"cartographer/#manual-cartographer-calibrate","title":"Manual Cartographer Calibrate","text":"<p>It is strongly recommended to disable the camera for these calibration steps, just use the <code>STOP_CAMERA</code> macro to do this.</p> <ol> <li>Run the <code>STOP_CAMERA</code> macro to stop the camera</li> <li>Home X Y (<code>G28 X Y</code>)</li> <li>Heat Nozzle to 150c (<code>M109 S150</code>) so that any filament can be removed from nozzle</li> <li>Make sure nozzle is centred on bed</li> <li>Run <code>CARTOGRAPHER_CALIBRATE METHOD=manual</code> Follow the Paper Test Method Upon completion <code>SAVE_CONFIG</code></li> </ol> <p>Note</p> <p>Is normal to show the Z position at almost at the max height of the printer even if the nozzle is somewhere in the middle or even close to the bed, this is not a bug, its intentional.   Until this calibration step is completed, the Z axes cannot be homed, so we make the printer pretend the bed is down the bottom of the printer so that you can freely move the bed up to meet the nozzle during the paper test without running into out of range issues.  You however won't be able to move the bed further away from the nozzle more than a few mm.</p> <p></p> <p>Warning</p> <p>Do not use a metal feeler gauge for this step, it could damage your cartographer!!!</p> <p>Source: https://docs.cartographer3d.com/original-plugin/settings-and-commands#cartographer_calibrate</p> <p>After the save config you have to do the cartographer threshold scan (see next)</p>"},{"location":"cartographer/#cartographer-threshold-scan","title":"Cartographer Threshold Scan","text":"<p>It is strongly recommended to disable the camera for these calibration steps, just use the <code>STOP_CAMERA</code> macro to do this.</p> <p>Danger</p> <p>For this next step, it is really important to be near your printer for this step, because if there is any issue with the printer configuration or your carto probe, its possible the nozzle will dig itself into the bed, so be hovering over that e-stop button!</p> <ol> <li>Run the <code>STOP_CAMERA</code> macro to stop the camera</li> <li>Home All (<code>G28</code>)</li> <li>Make sure nozzle is centred on bed</li> <li>Heat Nozzle to 150c (<code>M109 S150</code>) so that any filament can be removed from nozzle</li> <li>Execute <code>CARTOGRAPHER_THRESHOLD_SCAN SPEED=2 MIN=1000 MAX=5000</code> Upon completion <code>SAVE_CONFIG</code></li> </ol> <p>After the save config you have to do the touch calibration.</p> <p>Source: https://docs.cartographer3d.com/original-plugin/settings-and-commands#cartographer_threshold_scan</p>"},{"location":"cartographer/#cartographer-touch-calibration","title":"Cartographer Touch Calibration","text":"<p>It is strongly recommended to disable the camera for these calibration steps, just use the <code>STOP_CAMERA</code> macro to do this.</p> <p>Danger</p> <p>For this next step, it is really important to be near your printer for this step, because if there is any issue with the printer configuration or your carto probe, its possible the nozzle will dig itself into the bed, so be hovering over that e-stop button!</p> <ol> <li>Run the <code>STOP_CAMERA</code> macro to stop the camera</li> <li>Home All (<code>G28</code>)</li> <li>Heat Nozzle to 150c (<code>M109 S150</code>) so that any filament can be removed from nozzle</li> <li>Execute <code>CARTOGRAPHER_CALIBRATE</code> Upon completion <code>SAVE_CONFIG</code></li> </ol> <p>Tip</p> <p>If this fails after 3 tries, you should check to make sure there is not filament stuck to the bottom of your nozzle!</p> <p>Source: https://docs.cartographer3d.com/original-plugin/installation/calibration#setting-up-touch</p>"},{"location":"cartographer/#pid-tuning-and-input-shaping","title":"Pid Tuning and Input Shaping","text":"<p>At least PID tuning (bed and extruder) and input shaping is required for acceptable printing.  If you try and print after running the installer.sh and a power cycle but before any calibration you will most likely have horrendous quality, the worst you have ever seen on the k1.   After PID tuning and input shaping you should see the same kind of quality as you get with stock k1 + input shaper fix.</p> <p>Note</p> <p>You can use the QUICK_START Macro to complete Bed and Nozzle PID Tuning and Input Shaping Automatically.</p>"},{"location":"cartographer/#pid-tuning","title":"Pid Tuning","text":"<p>Source: Calibrate Pid Settings</p> <p>For example you might run these:</p> <pre><code>PID_CALIBRATE_BED BED_TEMP=65\nPID_CALIBRATE_HOTEND HOTEND_TEMP=230\n</code></pre> <p>Note</p> <p>The <code>PID_CALIBRATE_BED</code> and <code>PID_CALIBRATE_HOTEND</code> macros are located in the <code>useful_macros.cfg</code> file and they have defaults values for BED_TEMP and HOTEND_TEMP so you can just run them by clicking on them if you want that same temperature.</p>"},{"location":"cartographer/#input-shaping","title":"Input Shaping","text":"<p>There is no default configuration for input shaping so it is essentially disabled out of the box.</p> <p>You can use the <code>SHAPER_CALIBRATE</code> macro to run input shaping, just be sure to <code>SAVE CONFIG</code> at the end, to choose the automatically selected shaper config, be aware though that the shaper chosen might be sub-optimal due to a slight difference in vibrations between two options.  So you should probably review the output and potentially choose an alternative if it gives you higher recommended max acceleration for minimal increase in vibration.</p> <p>Input Shaper Auto Calibration</p>"},{"location":"cartographer/#axis-twist-compensation","title":"Axis Twist Compensation","text":"<p>Next it is highly recommended to perform axis twist compensation calibration if you are using a rear mount before doing anything else, this will affect the quality of your bed mesh, so best to do it before.</p> <ol> <li>Home All (<code>G28</code>)</li> <li>Run <code>AXIS_TWIST_COMPENSATION_CALIBRATE</code> The calibration wizard will prompt you to measure the probe Z offset at a few points along the bed    Upon completion <code>SAVE_CONFIG</code></li> </ol> <p>Warning</p> <p>Do not use a metal feeler gauge for this step, it could damage your cartographer!!!</p> <p>Source: https://www.klipper3d.org/Axis_Twist_Compensation.html</p>"},{"location":"cartographer/#first-print","title":"First Print","text":"<p>You should optimise your <code>scanner_touch_z_offset</code> using baby stepping, as documented here: https://docs.cartographer3d.com/original-plugin/installation/first-print</p> <p>In fluidd the save button after you finish or cancel your print can be a bit hard to find, look for</p> <p></p>"},{"location":"cartographer/#other-calibrations","title":"Other Calibrations","text":"<p>Info</p> <p>The default value for pressure advance is set to <code>0.04</code></p> <p>Refer to Orcaslicer Calibration for more calibrations</p> <p>Refer to the Ellis Print Tuning Guide for more great tuning ideas.</p>"},{"location":"cartographer/#scan-only-mode","title":"Scan Only Mode","text":"<p>Some cartographer users choose to use scan only instead of touch and that is easy enough to do, you can setup for scan immediately after installation, no need to do the 3 step calibration as for touch!</p> <p>Danger</p> <p>It is vital you are aware of the limitations of scan mode especially on the K1 series where temp calibration is not  an option.    If you print different bed and/or nozzle temp materials you must save a separate model per material and even with a single material the cartographer will return a different z-offset when hot than when cold, I strongly recommend against using scan mode on Simple AF, its actually likely to lead to bed damage unless you know exactly what you are doing!</p> <p>You can run the following:</p> <ol> <li>Run <code>PROBE_SWITCH MODE=scan</code> Upon completion <code>SAVE_CONFIG</code></li> </ol> <p>It is strongly recommended to disable the camera for this calibration step, just use the <code>STOP_CAMERA</code> macro to do this.</p> <ol> <li>Run the <code>STOP_CAMERA</code> macro to stop the camera</li> <li>Home X Y (<code>G28 X Y</code>)</li> <li>Heat Nozzle to 150c (<code>M109 S150</code>) so that any filament can be removed from nozzle</li> <li>Make sure nozzle is centred on bed</li> <li>Run <code>CARTOGRAPHER_CALIBRATE METHOD=manual</code>    Follow the Paper Test Method Upon completion <code>SAVE_CONFIG</code></li> </ol> <p>Warning</p> <p>Do not use a metal feeler gauge for this step, it could damage your cartographer!!!</p> <p>You can then use the CARTOGRAPHER_MODEL parameter to start print from your slicer to select different filament profiles, this is required if you print with different filaments and/or use different bed aurfaces.</p>"},{"location":"cartographer/#cartographer-model","title":"Cartographer Model","text":"<p>If you want to select a particular cartographer model other than the default you can pass in an additional <code>START_PRINT</code> parameter:</p> <p></p> <p>You can either hard code it to a particular model, like <code>CARTOGRAPHER_MODEL=mymodel</code> or you can specify a model based on orca slicer variables, such as <code>CARTOGRAPHER_MODEL=\"[curr_bed_type] - [filament_type]\"</code>, but you have to make sure you have all the possible models defined for each of the bed type and filament type combinations.</p>"},{"location":"cartographer_beta/","title":"Cartographer Beta","text":"<p>The cartographer team has just released a new version of the klippy extra to replace scanner.py. Setting up the new software requires you to switch to a new probe config called <code>cartographer</code></p> <p>Warning</p> <p>Although cartographer3d.com has just released the software (oct 26 2026), we are not going to make it the  default for cartographer probes for some weeks until initial release teething problems are resolved.</p> <p>Info</p> <p>You do not need a new cartographer probe this is just a Simple AF config change!</p>"},{"location":"cartographer_beta/#setup-simple-af","title":"Setup Simple AF","text":"<p>You need to update Simple AF repository to latest:</p> <pre><code>~/pellcorp/installer.sh --branch main\n</code></pre> <p>Then you are going to be switching probes from <code>cartotouch</code> to <code>cartographer</code>:</p> <pre><code>~/pellcorp/installer.sh --update cartographer --mount %CURRENT%\n</code></pre> <p>Info</p> <p>If you are wanting to use the cartographer from a fresh installation, you can do a <code>--install cartographer --mount TheMount</code>, rather than a <code>--update cartographer</code>, where <code>TheMount</code> is a supported cartographer mount option</p> <p>Note</p> <p>If you run the above and receive an error like:</p> <pre><code>```\nroot@K1Max-AF34 /root [#] ~/pellcorp/installer.sh --branch main\n-sh: /root/pellcorp/installer.sh: not found\n```\n</code></pre> <p>It means you are on an older version of Simple AF and you should instead use the old style commands:</p> <pre><code>```\n/usr/data/pellcorp/k1/installer.sh --branch main\n~/pellcorp/installer.sh --update cartographer --mount %CURRENT%\n```\n</code></pre> <p>Warning</p> <p>The --mount %CURRENT% is required to ensure the mount offsets are applied correctly.</p> <p>You will need to remove the existing config from the bottom of your printer.cfg:</p> <ul> <li><code>[scanner]</code></li> <li><code>[scanner model default]</code></li> </ul> <p>And remove any bed mesh and axis twist calibration stuff</p>"},{"location":"cartographer_beta/#calibration","title":"Calibration","text":"<p>Warning</p> <p>The following calibration steps are required to setup a new printer:</p> <ul> <li>Scan calibration</li> <li>Touch Calibration</li> </ul>"},{"location":"cartographer_beta/#scan-calibration","title":"Scan calibration","text":"<p>It is strongly recommended to disable the camera for these calibration steps, just use the <code>STOP_CAMERA</code> macro to do this.</p> <ol> <li>Run the <code>STOP_CAMERA</code> macro to stop the camera</li> <li>Home X Y (<code>G28 X Y</code>)</li> <li>Heat Nozzle to 150c (<code>M109 S150</code>) so that any filament can be removed from nozzle</li> <li>Make sure nozzle is centred on bed</li> <li>Run <code>CARTOGRAPHER_SCAN_CALIBRATE</code>    Follow the Paper Test Method Upon completion <code>SAVE_CONFIG</code></li> </ol> <p>Note</p> <p>Is normal to show the Z position at almost at the max height of the printer even if the nozzle is somewhere in the middle or even close to the bed, this is not a bug, its intentional.   Until this calibration step is completed, the Z axes cannot be homed, so we make the printer pretend the bed is down the bottom of the printer so that you can freely move the bed up to meet the nozzle during the paper test without running into out of range issues.  You however won't be able to move the bed further away from the nozzle more than a few mm.</p> <p></p> <p>Source: https://docs.cartographer3d.com/cartographer-probe/installation-and-setup/software-configuration/scan-calibration</p> <p>Warning</p> <p>Do not use a metal feeler gauge for this step, it could damage your cartographer!!!</p> <p>After the save config you have to do the touch calibration.</p>"},{"location":"cartographer_beta/#touch-calibration","title":"Touch Calibration","text":"<p>It is strongly recommended to disable the camera for these calibration steps, just use the <code>STOP_CAMERA</code> macro to do this.</p> <p>Danger</p> <p>For this next step, it is really important to be near your printer for this step, because if there is any issue with the printer configuration or your carto probe, its possible the nozzle will dig itself into the bed, so be hovering over that e-stop button!</p> <ol> <li>Run the <code>STOP_CAMERA</code> macro to stop the camera</li> <li>Home All (<code>G28</code>)</li> <li>Heat Nozzle to 150c (<code>M109 S150</code>) so that any filament can be removed from nozzle</li> <li>Make sure nozzle is centred on bed</li> <li>Run <code>CARTOGRAPHER_TOUCH_CALIBRATE SPEED=2</code> Upon completion <code>SAVE_CONFIG</code></li> </ol> <p>Warning</p> <p>Observe your nozzle to make sure it touches on the bed. If it never touches the bed, refer to https://docs.cartographer3d.com/cartographer-probe/installation-and-setup/software-configuration/touch-calibration#nozzle-never-touches-the-bed   </p> <p>Source: https://docs.cartographer3d.com/cartographer-probe/installation-and-setup/software-configuration/touch-calibration</p>"},{"location":"cartographer_beta/#bed-mesh-boundary","title":"Bed Mesh Boundary","text":"<p>Might be a useful tool to calculate mesh min and max: https://docs.cartographer3d.com/cartographer-probe/features/touch#bed-mesh-calibrate</p>"},{"location":"cartographer_beta/#axis-twist-compensation","title":"Axis Twist Compensation","text":"<p>Note</p> <p>This is a fancy new feature of the new Cartographer software it does not require any paper!</p> <p>Next it is highly recommended to perform axis twist compensation calibration if you are using a rear mount before doing anything else, this will affect the quality of your bed mesh, so best to do it before.</p> <ol> <li>Home All (<code>G28</code>)</li> <li>Heat Nozzle to 150c (<code>M109 S150</code>) so that any filament can be removed from nozzle</li> <li>Run <code>CARTOGRAPHER_AXIS_TWIST_COMPENSATION</code> Upon completion <code>SAVE_CONFIG</code></li> </ol> <p>Source: https://docs.cartographer3d.com/cartographer-probe/features/axis-twist-compensation</p>"},{"location":"cartographer_beta/#first-print","title":"First Print","text":"<p>You should optimise your <code>cartographer touch_model default</code> <code>z_offset</code> using baby stepping, as documented here: https://docs.cartographer3d.com/cartographer-probe/installation-and-setup/software-configuration/z-offset#babystep-adjusting-z-offset</p> <p>In fluidd the save button after you finish or cancel your print can be a bit hard to find, look for</p> <p></p>"},{"location":"cartographer_faq/","title":"Frequently Asked Questions","text":""},{"location":"cartographer_faq/#how-do-i-use-my-cartographer-for-input-shaping","title":"How do I use my cartographer for input shaping?","text":"<p>Note</p> <p>These instructions do not apply to Simple AF for RPi, although it is certainly possible to use the Cartographer as ADXL on non creality printers.</p> <p>This just needs a few changes in <code>printer.cfg</code></p> <p>You need to modify the <code>[adxl345]</code> section</p> <p>First of all change the <code>cs_pin</code> from <code>nozzle_mcu:PA4</code> to <code>scanner:PA3</code></p> <p>Then disable the following settings:</p> <ul> <li><code>spi_speed: 5000000</code></li> <li><code>spi_software_sclk_pin: nozzle_mcu:PA5</code></li> <li><code>spi_software_mosi_pin: nozzle_mcu:PA7</code></li> <li><code>spi_software_miso_pin: nozzle_mcu:PA6</code></li> </ul> <p>And add the following settings:</p> <ul> <li><code>spi_bus: spi1</code></li> <li><code>axes_map: x, y, z</code></li> </ul> <p>So your [adxl345] should look like:</p> <pre><code>[adxl345]\n#cs_pin: nozzle_mcu:PA4\ncs_pin: scanner:PA3\nspi_bus: spi1\n#spi_speed: 5000000\naxes_map: x, y, z\n#spi_software_sclk_pin: nozzle_mcu:PA5\n#spi_software_mosi_pin: nozzle_mcu:PA7\n#spi_software_miso_pin: nozzle_mcu:PA6\n</code></pre> <p>I do not know if this is a good idea, I just know it's possible!</p> <p>Source: https://docs.cartographer3d.com/cartographer-probe/installation-and-setup/installation/klipper-configuation</p>"},{"location":"cartographer_flashing/","title":"Cartographer flashing","text":"<p>Danger</p> <p>THIS IS A RISKY OPERATION YOU CAN BRICK YOUR CARTO</p> <p>Do not follow these instructions unless you have a USB V3 Carto!!!!!!</p> <p>Warning</p> <p>You might corrupt the katapult boot loader trying to use a Linux VM or WSL to flash the carto, I strongly recommend a live USB over a VM or WSL!</p>"},{"location":"cartographer_flashing/#verify-your-cable","title":"Verify your Cable","text":"<p>You must make sure that the cable you are using is pinned correctly.  For both flat pack and right angle carto's the default cable that comes with your carto might not be pinned correctly.</p> <p></p> <p>Warning</p> <p>The right angle and flat pack pin out is different to using a low profile carto, so the image above does not apply to low profile cartographers!</p> <p>You must not use the firmware.cartographer3d.com, it will not flash the proper version of <code>CARTOGRAPHER K1 5.1.0</code> firmware for the K1, K1C, K1SE, K1 Max, Ender 3 V3 KE and Ender 5 Max!</p> <p>The reason this cannot be done on the printer, seems to be some incompatibility with pyserial and MIPS, and issue for this has been opened  https://github.com/Arksine/katapult/issues/137 </p>"},{"location":"cartographer_flashing/#flashing-the-cartographer","title":"Flashing the Cartographer","text":"<p>You will need some kind of linux environment, this can be a Raspberry Pi, desktop Linux or even a Linux Server if you can plug something in via USB.   If you do not have anything like that, you will need to create a Live USB key running Ubuntu 24.04 Desktop edition.</p>"},{"location":"cartographer_flashing/#creating-a-live-usb-key","title":"Creating a Live USB Key","text":"<p>You should create a live USB with Ubuntu 24.04 (25.04 also works) Desktop, make sure the USB is at least 8GB in size!</p> <p>https://ubuntu.com/tutorials/try-ubuntu-before-you-install#1-getting-started</p>"},{"location":"cartographer_flashing/#installation-dependencies","title":"Installation dependencies","text":"<p>On your raspberry pi, linux desktop, linux server or live Ubuntu USB environment you need to run the following commands to install essential packages.</p> <pre><code>sudo apt-get update\nsudo apt-get install virtualenv python3-dev python3-pip python3-setuptools libffi-dev build-essential git dfu-util\n</code></pre>"},{"location":"cartographer_flashing/#clone-klipper-and-cartographer-klipper","title":"Clone Klipper and Cartographer-Klipper","text":"<pre><code>git clone \"https://github.com/Klipper3d/klipper\" $HOME/klipper\ngit clone \"https://github.com/Cartographer3D/cartographer-klipper.git\" $HOME/cartographer-klipper\n</code></pre>"},{"location":"cartographer_flashing/#update-cartographer-klipper-repo","title":"Update Cartographer Klipper repo","text":"<p>If you already have cartographer-klipper cloned locally, make sure you are on latest master like so:</p> <pre><code>cd $HOME/cartographer-klipper\ngit fetch\ngit switch master\ngit reset --hard origin/master\n</code></pre>"},{"location":"cartographer_flashing/#setup-klipper-virtual-env","title":"Setup Klipper Virtual Env","text":"<pre><code>virtualenv --system-site-packages $HOME/klippy-env\n$HOME/klippy-env/bin/pip3 install -r $HOME/klipper/scripts/klippy-requirements.txt\n</code></pre>"},{"location":"cartographer_flashing/#flashing-k1-carto-touch-firmware","title":"Flashing K1 Carto Touch Firmware","text":"<p>This firmware is provided by Richard from Cartographer3d.com specifically for the K1, K1C, K1SE, K1 Max, Ender 3 V3 KE and Ender 5 Max.   It is critical that you flash your cartographer with this version of the Survey firmware over the official Survey Firmware on K1, K1SE, K1C, K1M, Ender 3 V3 KE and Ender 5 Max to avoid stuttering and instability, especially during bed meshes!</p>"},{"location":"cartographer_flashing/#connect-cartographer-via-usb","title":"Connect Cartographer via USB","text":"<p>Plug the cartographer into your computer and make sure it shows up if you type <code>lsusb</code> you should find an entry something like this:</p> <pre><code>Bus 001 Device 067: ID 1d50:614e OpenMoko, Inc.\n</code></pre>"},{"location":"cartographer_flashing/#enable-bootloader","title":"Enable Bootloader","text":"<pre><code>CARTO_DEV=$(ls /dev/serial/by-id/usb-* | grep \"IDM\\|Cartographer\" | head -1)\ncd $HOME/klipper/scripts\nsudo -E $HOME/klippy-env/bin/python -c \"import flash_usb as u; u.enter_bootloader('$CARTO_DEV')\"\n</code></pre> <p>Warning</p> <p>If you get a message like <code>ls: cannot access '/dev/serial/by-id/usb-*': No such file or directory</code>, it means you forgot the <code>*</code> in the command above, your carto cable is incorrectly pinned or you are using a VM or WSL (against advice) and have not passed through the Cartographer USB Device!</p> <p>You should see a message like:</p> <pre><code>Entering bootloader on /dev/serial/by-id/usb-Cartographer_614e_16000C000F43304253373820-if00\n</code></pre> <p>Note</p> <p>If the carto does not enter bootloader mode, it is possible you forgot to use sudo! If your carto does show up in /dev/serial but won't enter bootloader mode, you will need to fix this with DFU mode</p>"},{"location":"cartographer_flashing/#flashing","title":"Flashing","text":"<pre><code>CATAPULT_DEV=$(ls /dev/serial/by-id/usb-katapult*)\nsudo -E $HOME/klippy-env/bin/python $HOME/klipper/lib/canboot/flash_can.py -f $HOME/cartographer-klipper/firmware/v2-v3/survey/5.1.0/Survey_Cartographer_K1_USB_8kib_offset.bin -d $CATAPULT_DEV\n</code></pre> <p>Note</p> <p>If downgrading firmware replace 5.1.0 with 5.0.0</p> <p>You should see output this this:</p> <pre><code>Attempting to connect to bootloader\nCanBoot Connected\nProtocol Version: 1.0.0\nBlock Size: 64 bytes\nApplication Start: 0x8002000\nMCU type: stm32f042x6\nFlashing '/home/ubuntu/cartographer-klipper/firmware/v2-v3/survey/5.1.0/Survey_Cartographer_K1_USB_8kib_offset.bin'...\n\n[##################################################]\n\nWrite complete: 22 pages\nVerifying (block count = 338)...\n\n[##################################################]\n\nVerification Complete: SHA = BB45B9575AC57FFF03CA5FE09186DB479E09BF53\nCAN Flash Success\n</code></pre> <p>Note</p> <p>If the carto does not flash, it is possible you forgot to use sudo!</p> <p>Warning</p> <p>If you get a message like <code>ls: cannot access '/dev/serial/by-id/usb-katapult*': No such file or directory</code>, it means you forgot the <code>*</code> in the command above, you are using a VM or WSL (against advice) and have not passed through the <code>katapult stm32f042x6</code> USB Device!</p> <p>If the Cartographer is no longer flashing blue its also possible the katapult bootloader has become corrupted which is actually frighteningly easy to do which is why I generally discourage the use of WSL or VMs!</p> <p>When you reconnect your carto to your printer it should show a version <code>CARTOGRAPHER K1 5.1.0</code>:</p> <p>Source: https://docs.cartographer3d.com/cartographer-probe/firmware/manual-methods/cartographer-with-input-shaper/update-via-katapult-recommended#updating-a-usb-probe-via-katapult</p> <p></p>"},{"location":"cartographer_flashing/#flashing-k1-firmware-via-dfu-mode","title":"Flashing K1 Firmware via DFU Mode","text":"<p>Note</p> <p>This process is applicable for K1, K1C, K1SE, K1 Max, Ender 3 V3 KE and Ender 5 Max!</p> <p>You need to bridge the boot pins before you plug your carto in via USB to your Linux session, make sure <code>lsusb</code> reports it being in DFU mode, it should show</p> <p></p> <p>Then cd to the combined firmware directory </p> <pre><code>cd $HOME/cartographer-klipper/firmware/v2-v3/combined-firmware/5.1.0\n</code></pre> <p>And run dfu-util to write the firmware:</p> <pre><code>sudo dfu-util -R -a 0 -s 0x08000000:leave -D Full_Survey_Cartographer_CrealityK1_USB_5_1_0.bin\n</code></pre> <p></p> <p>Source: https://docs.cartographer3d.com/cartographer-probe/firmware/manual-methods/cartographer-with-input-shaper/update-via-dfu-mode</p>"},{"location":"cartographer_troubleshooting/","title":"Troubleshooting","text":"<p>https://docs.cartographer3d.com/cartographer-probe/troubleshooting</p>"},{"location":"cartographer_troubleshooting/#repo-has-diverged-from-remote","title":"Repo has diverged from remote","text":"<p>You need to click RECOVER and then run from ssh:</p> <pre><code>~/cartographer-klipper/install.sh\n</code></pre>"},{"location":"cartographer_troubleshooting/#error-during-probe-mcu-identification-check-connection","title":"Error during probe mcu identification, check connection","text":"<p>If you get the following error, it means that the cartographer is not connected to the printer.   This is either because its physically not connected, the wiring is wrong, the usb subsystem has disconnected the carto during a restart or the serial id is wrong</p> <p></p> <p>So from ssh run a <code>lsusb</code> and make sure you can see:</p> <p></p> <p>If you cannot see it in <code>lsusb</code>, then it very likely means either the carto is wired incorrectly, or if was working, it just means that an attempt to restart the carto failed because the K1 refused to recognise it, there is no recourse except to restart the host via Fluidd / Mainsail (or power cycle the printer)</p> <p>If you can see the carto in lsusb, then you should try to update the serial (see next)</p>"},{"location":"cartographer_troubleshooting/#manual-cartographer-serial-device-configuration","title":"Manual Cartographer Serial Device configuration","text":"<p>You can run the following command to fix your serial if you forgot to plug your cartographer in during the installation or update:</p> <pre><code>~/pellcorp/installer.sh --fix-serial\n</code></pre> <p>Note</p> <p>If you run the above and receive an error like:</p> <pre><code>```\nroot@K1Max-AF34 /root [#] ~/pellcorp/installer.sh --fix-serial\n-sh: /root/pellcorp/installer.sh: not found\n```\n</code></pre> <p>It means you are on an older version of Simple AF and you should instead use the old style commands:</p> <pre><code>```\n/usr/data/pellcorp/k1/installer.sh --fix-serial\n```\n</code></pre>"},{"location":"cartographer_troubleshooting/#cartographer-is-not-connected-aborting-homing-z","title":"Cartographer is not connected, aborting homing Z","text":"<p>If you see this error when trying to home your printer, it is a clear indication that the cartographer was disconnected and you should look for a <code>mcu 'scanner' disconnected</code> error in your klippy.log or gcode console, if the cartographer was momentarily disconnected (so if you run <code>lsusb</code> on the printer the cartographer shows up), you can simply restart klipper from the services menu in Fluidd or Mainsail, if the cartographer completely disappeared you will need to power cycle the printer!</p>"},{"location":"cartographer_wiring/","title":"Cartographer Wiring","text":"<p>Note</p> <p>This wiring section applies to K1/K1C/K1SE/K1M printers only</p> <p>On a K1M you can use the lidar cable either directly by repinning it, or via the pass through lidar port on the toolhead.  However you cannot use the lidar port on the toolhead for K1, K1C or K1SE.   The reason this does not work is because for Lidar on the K1M creality actually routes a completely separate USB cable from the mainboard.</p> <p></p>"},{"location":"config_overrides/","title":"Config overrides","text":"<p>The <code>pellcorp-overrides</code> directory stores custom cfg and conf files as well as customisations you have made to some of the core config files such as printer.cfg.  </p> <p>The following core config files can have overrides saved for them: </p> <ul> <li>printer.cfg</li> <li>sensorless.cfg</li> <li>cartotouch.cfg</li> <li>cartographer.cfg</li> <li>cartographer.conf</li> <li>btteddy.cfg</li> <li>btteddy_macro.cfg</li> <li>beacon.conf</li> <li>beacon.cfg</li> <li>eddyng.cfg</li> <li>klicky.cfg</li> <li>klicky_macro.cfg</li> <li>KAMP_Settings.cfg</li> <li>moonraker.conf</li> <li>start_end.cfg</li> <li>fan_control.cfg</li> <li>internal_macros.cfg</li> <li>useful_macros.cfg</li> </ul>"},{"location":"config_overrides/#restrictions","title":"Restrictions","text":"<ul> <li>No support is provided to edit <code>gcode_macro</code> or <code>homing_override</code> section <code>gcode</code> values in any config files</li> <li>You can modify <code>variable_</code> variables in gcode macros, but not the gcode macros themselves</li> <li>You can modify existing values in existing sections</li> <li>You can only add or delete values from existing sections in printer.cfg, fan_control.cfg and moonraker.conf, all other files these changes will be ignored.</li> <li>You can only add or delete sections in printer.cfg, fan_control.cfg and moonraker.conf, all other files these changes will be ignored.</li> </ul>"},{"location":"config_overrides/#grumpyscreen","title":"GrumpyScreen","text":"<p>There is a subset of settings in guppyscreen.json which will be retained and restored by config overrides, these are curently:</p> <ul> <li>display_rotate</li> <li>display_brightness</li> <li>invert_z_icon</li> <li>display_sleep_sec </li> <li>theme </li> <li>touch_calibration_coeff</li> </ul> <p>There is an issue https://github.com/pellcorp/creality/issues/736 to support retaining sensor config but its outstanding and not currently supported, so any other changes will be overridden.</p> <p>Tip</p> <p>You should run the CONFIG_OVERRIDES macro every time you make any changes to either your own custom cfg or conf files, or make changes to any core config files.</p> <p>Note</p> <p>The first step in both a <code>~/pellcorp/installer.sh --update</code> or <code>~/pellcorp/installer.sh  --reinstall</code> is to backup your config-overrides, so that they can be reapplied, but they will be lost if you do a factory reset.</p>"},{"location":"config_overrides/#git-backups-for-configuration-overrides","title":"Git Backups for Configuration Overrides","text":"<p>If the pellcorp-overrides directory is a git repo, calling the CONFIG_OVERRIDES or <code>~/pellcorp/tools/config-overrides.sh</code> will generate a new git commit and push it to origin if any files are changed.</p>"},{"location":"config_overrides/#create-repository","title":"Create repository","text":"<p>Create a new <code>pellcorp-overrides</code> repository on your github account:</p> <p></p> <p>Info</p> <p>You don't actually have to call it pellcorp-overrides, you can call it whatever you want, but it should be a repository dedicated to just doing backups for this project.</p> <p>Warning</p> <p>Set your new repository to be private unless you want to share settings with everyone else, or potentially sensitive information in the moonraker.conf, notifier.conf, etc.  Be really careful with using github keys in moonraker.conf update manager too, as these will be version controlled.   If possible put all your secrets in moonraker.secrets which is not saved to version control.</p>"},{"location":"config_overrides/#create-a-personal-access-token","title":"Create a personal access token","text":"<p>Click here to create a fine grained personal access token.  Create a finegrained token and limit its access to just your <code>pellcorp-overrides</code> repository.   Make sure that Contents read and write access.</p> <p></p> <p>Make sure you limit it to just the new repository you created:</p> <p></p> <p>Source: https://guilouz.github.io/Creality-Helper-Script-Wiki/helper-script/git-backup/</p>"},{"location":"config_overrides/#create-local-repo","title":"Create Local Repo","text":"<p>You will need 3 pieces of information for this process to succeed:</p> <ol> <li>Your github username</li> <li>Your email address</li> <li>The github token you just created</li> </ol> <p>Ssh into your k1 and run the following:</p> <pre><code>export GITHUB_USERNAME=myusername\nexport EMAIL_ADDRESS=me@somewhere.com\nexport GITHUB_TOKEN=\"The token I just created\"\nexport GITHUB_REPO=pellcorp-overrides\nexport GITHUB_BRANCH=main\n~/pellcorp/tools/config-overrides.sh --repo\n</code></pre> <p>Note</p> <p>The <code>GITHUB_BRANCH</code> is optional, if its not specified it will use <code>main</code> as the branch.</p> <p>If you want to setup the repository locally ignoring any local files in the <code>pellcorp-overrides</code> directory, you can use the <code>--clean-repo</code> argument, instead of the <code>--repo</code> argument, which will rebase the local changes on top of the repo.</p> <p>Note</p> <p>For K1 Series (including Ender 5 Max), the pellcorp-overrides is located at /usr/data/pellcorp-overrides, but there is a soft link created to /root, so you scripts and the wiki will refer to pellcorp-overrides by the shorthand of <code>~/pellcorp-overrides</code></p> <p>The <code>moonraker.secrets</code> file is not versioned controlled.</p>"},{"location":"config_overrides/#troubleshooting","title":"Troubleshooting","text":""},{"location":"config_overrides/#support-for-password-authentication-was-removed-on-august-13-2021","title":"Support for password authentication was removed on August 13, 2021","text":"<p>This most likely means your personal access token is misconfigured, deleted, or expired</p>"},{"location":"custom_hooks/","title":"Custom hooks","text":"<p>Within Simple AF if you want to call a custom gcode macro you can with hooks, the following custom gcode macro hooks are supported and more can be added as needed:</p> <ul> <li>_SAF_HOMING_START - at start of homing</li> <li>_SAF_HOMING_END - at end of homing</li> <li>_SAF_START_PRINT_BEFORE_G28 - Before G28 is called in START_PRINT</li> <li>_SAF_START_PRINT_AFTER_G28 - After G28 is called in START_PRINT</li> <li>_SAF_START_PRINT_BEFORE_BED_MESH - Before bed mesh calibrate is called in START_PRINT</li> <li>_SAF_START_PRINT_AFTER_BED_MESH - After bed mesh calibrate is called in START_PRINT</li> <li>_SAF_NOZZLE_WIPE - A nozzle wipe macro that can be defined for eddyny, beacon, cartographer and cartotouch only, will be called before bed mesh for eddny and beacon, and after bed mesh for cartographer and cartotouch</li> <li>_SAF_BED_MESH_START - Start of bed mesh calibrate</li> <li>_SAF_BED_MESH_END - End of bed mesh calibrate</li> <li>_SAF_ON_FILAMENT_RUNOUT - When filament runout is triggered</li> <li>_SAF_ON_CANCEL - When cancel print is triggered</li> <li>_SAF_START_PRINT_START - Very start of START_PRINT</li> <li>_SAF_START_PRINT_BEFORE_LINE_PURGE - Just before Line Purge in start print</li> <li>_SAF_START_PRINT_END - Very end of START_PRINT</li> <li>_SAF_END_PRINT_START - Very start of END_PRINT</li> <li>_SAF_END_PRINT_END - Very end of END_PRINT</li> <li>_SAF_HEATING_NOZZLE_START - At start of M109 macro</li> <li>_SAF_HEATING_NOZZLE_END - At start of M109 macro</li> <li>_SAF_HEATING_BED_START - At start of M190 macro</li> <li>_SAF_HEATING_BED_END - At end of M190 macro</li> </ul> <p>So the way this works is you define your own custom config file (make sure it has a <code>.cfg</code> file extension), and add it to printer.cfg like so:</p> <pre><code>[include MyCustomMacros.cfg]\n</code></pre> <p>Note</p> <p>It does not need to be called <code>MyCustomMacros.cfg</code>, you can call it whatever you like, but it must end with <code>.cfg</code> and it must be saved directly in the config directory, not a sub-directory!</p> <p>Your config file should implement as many of the above macros as you want to, you do not need to implement them all, so for example if you wanted to do something after G28 in START_PRINT, you file might look like:</p> <pre><code>[gcode_macro _SAF_START_PRINT_AFTER_G28]\ngcode:\n   RESPOND TYPE=command MSG='I am getting called after G28'\n</code></pre>"},{"location":"custom_hooks/#knomi-support","title":"Knomi Support","text":"<p>A prime use case for this would be knomi support, which currently might look like this:</p> <pre><code>[gcode_macro _KNOMI_STATUS]\nvariable_homing: False\nvariable_probing: False\nvariable_qgling: False\nvariable_heating_nozzle: False\nvariable_heating_bed: False\ngcode:\n\n\n[gcode_macro _SAF_HEATING_NOZZLE_START]\ngcode:\n  SET_GCODE_VARIABLE MACRO=_KNOMI_STATUS VARIABLE=heating_nozzle VALUE=True\n\n\n[gcode_macro _SAF_HEATING_NOZZLE_END]\ngcode:\n  SET_GCODE_VARIABLE MACRO=_KNOMI_STATUS VARIABLE=heating_nozzle VALUE=False\n\n\n[gcode_macro _SAF_HEATING_BED_START]\ngcode:\n  SET_GCODE_VARIABLE MACRO=_KNOMI_STATUS VARIABLE=heating_bed VALUE=True\n\n\n[gcode_macro _SAF_HEATING_BED_END]\ngcode:\n  SET_GCODE_VARIABLE MACRO=_KNOMI_STATUS VARIABLE=heating_bed VALUE=False\n\n\n[gcode_macro _SAF_BED_MESH_START]\ngcode:\n  SET_GCODE_VARIABLE MACRO=_KNOMI_STATUS VARIABLE=probing VALUE=True\n\n\n[gcode_macro _SAF_BED_MESH_END]\ngcode:\n  SET_GCODE_VARIABLE MACRO=_KNOMI_STATUS VARIABLE=probing VALUE=False\n\n\n[gcode_macro _SAF_HOMING_START]\ngcode:\n  SET_GCODE_VARIABLE MACRO=_KNOMI_STATUS VARIABLE=homing VALUE=True\n\n\n[gcode_macro _SAF_HOMING_END]\ngcode:\n  SET_GCODE_VARIABLE MACRO=_KNOMI_STATUS VARIABLE=homing VALUE=False\n</code></pre>"},{"location":"eddyng/","title":"Eddyng","text":"<p>Warning</p> <p>This feature is under active development from vvuk over at https://github.com/vvuk/eddy-ng/, so there are likely to be gotchas and issues, please bare that in mind.</p>"},{"location":"eddyng/#where-can-i-get-help","title":"Where can I get help?","text":"<p>Come on over to the pellcorp discord server, the <code>#simple-af-btteddy</code> channel has been setup for anyone wanting support for btt eddy.</p> <p>https://discord.gg/2uGDzyJ3WX</p>"},{"location":"eddyng/#eddy-ng-discord","title":"eddy-ng discord","text":"<p>You can also get help from the eddy-ng discord channels on the sovol discord, with the https://discord.gg/djhnkDR2JN link</p>"},{"location":"eddyng/#k1-series","title":"K1 Series","text":"<p>This guide assumes you have a K1, K1C, K1SE or K1 Max and you are running stock creality firmware 1.3.3.5 or higher (The firmware 1.3.3.5 is much older than 1.3.3.46 for example), or alternately you can use my prerooted firmware.</p>"},{"location":"eddyng/#ender-5-max","title":"Ender 5 Max","text":"<p>This probe is currently not supported on Ender 5 Max</p>"},{"location":"eddyng/#ender-3-v3-ke","title":"Ender 3 V3 KE","text":"<p>There is experimental untested support for a Default mount on the Ender 3 V3 KE.</p>"},{"location":"eddyng/#simple-af-for-rpi","title":"Simple AF for RPi","text":"<p>See Simple AF for RPi</p>"},{"location":"eddyng/#slicer-settings","title":"Slicer Settings","text":"<p>Danger</p> <p>Creality Print won't be able to see your printer after you have installed Simple AF, the only tested slicer we all use is OrcaSlicer, likely if you want to use Creality Print you will need to print via usb.</p> <p>Cura Slicer won't work out of the box for configuring START_PRINT variables as below, you need to change the start print EXTRUDER_TEMP and BED_TEMP to pass in the correct values, but since I don't use Cura Slicer I can't advise on that!</p> <p>There is an assumption that you are using a slicer like OrcaSlicer and Machine G-code like:</p> <p></p> <p>Machine start G-code <pre><code>M140 S0\nM104 S0\nSTART_PRINT EXTRUDER_TEMP=[nozzle_temperature_initial_layer] BED_TEMP=[bed_temperature_initial_layer_single]\n</code></pre></p> <p>Machine end G-code <pre><code>END_PRINT\n</code></pre></p>"},{"location":"eddyng/#custom-bed-mesh-profile","title":"Custom Bed Mesh Profile","text":"<p>If you want to select a specific predefined bed mesh profile (which disables adaptive mesh generation), you can pass in an additional <code>START_PRINT</code> parameter:</p> <p>You can either hard code it to a particular model, like <code>BED_MESH_PROFILE=myprofile</code> or you can specify a profile based on orca slicer variables, such as <code>BED_MESH_PROFILE=\"[curr_bed_type] - [filament_type]\"</code>, but you have to make sure you have all the possible profiles defined for each of the bed type and filament type combinations.</p> <p></p>"},{"location":"eddyng/#probe-installation","title":"Probe Installation","text":"<p>Danger</p> <p>If you are not using a side mount you must verify config changes for eddyng.cfg before homing your printer, using Screws Tilt Calculate or doing a bed mesh!  </p> <p>Ignoring these instructions can lead to significant damage to your build plate and/or probe.</p>"},{"location":"eddyng/#mount-options","title":"Mount Options","text":"Mount Printer URL Notes Default K1, K1C, K1M, K1SE https://www.printables.com/model/1012524-btteddy-creality-k1-k1c-k1-max-mounthttps://www.printables.com/model/1212731-btt-eddy_ng-mount-for-creality-k1-series Pellcorp K1, K1C, K1M, K1SE https://www.printables.com/model/965667-wip-k1-btt-eddy-rear-mount-v4 Slam K1, K1C, K1M, K1SE https://www.printables.com/model/1195575-btt-eddy-mount-for-k1c Default Ender 3 V3 SE https://www.printables.com/model/1202031-ender-3-v3-se-k1-hotend-btt-eddy-mount Default Ender 3 KE https://www.printables.com/model/1002777-cr-touch-to-btt-eddy-adapter-bracket This probe and mount has not been tested on a KE running Simple AF, experimental"},{"location":"eddyng/#nozzle-offset","title":"Nozzle Offset","text":"<p>Warning</p> <p>Regardless of the mount, you should verify the btt eddy coil is at least 3mm away from the nozzle tip, its better to be further away than closer. This is not the difference of the bottom of the case to the nozzle, the case is about 1.2mm thick, so this means you want the bottom of the case to be at least 2mm offset,  its probably a good idea to look into mounts which do not use a case or a modified case with no bottom.</p> <p>You can try this tool https://www.printables.com/model/1277844-btt-eddy-and-eddy-ng-setup-helpers</p>"},{"location":"eddyng/#btt-eddy-firmware","title":"BTT Eddy Firmware","text":"<p>Warning</p> <p>It is assumed that you have flashed your eddy with the firmware from https://github.com/pellcorp/klipper/blob/master/fw/K1/btteddy.uf2 before starting the installation!!!</p> <p>For K1 Series Simple AF there is a guide</p> <p>For Simple AF for RPi, you can follow this guide https://github.com/bigtreetech/Eddy?tab=readme-ov-file#compiling-firmware.   But make sure you are not trying to use any fork of klipper than pellcorp/klipper-rpi!  You can also skip this compilation step and just copy  the <code>~/klipper/fw/k1/btteddy.uf2</code> file to the Eddy after putting it into boot mode.</p>"},{"location":"eddyng/#installation","title":"Installation","text":"<p>Warning</p> <p>The installation section does not apply to Simple AF for RPi, See Simple AF for RPi</p> <p>The installation can only be performed on a printer which has been rooted and ssh granted</p> <p>You need root access, if you are not already root, then follow the excellent Helper Script Enable Root Access instructions.</p>"},{"location":"eddyng/#factory-reset","title":"Factory Reset","text":"<p>You must do a factory reset only if you have installed Helper Script or Fluidd/Mainsail directly from Creality, otherwise you can safely proceed directly to installation.    If you have setup your printer with stock firmware only it can be quite handy to skip a factory reset so that you can use Switch to Stock</p> <pre><code>wget --no-check-certificate https://raw.githubusercontent.com/pellcorp/creality/main/k1/services/S58factoryreset -O /tmp/S58factoryreset\nchmod +x /tmp/S58factoryreset\n/tmp/S58factoryreset reset\n</code></pre> <p>Danger</p> <p>It is really important you do not close the ssh session until you get this message:</p> <p></p> <p>It can take up to 5 minutes for a factory restart to finish, it is vital you do not power cycle your printer before the stock screen appears. There may be a 3002 error on the screen, this is completely normal.   If you are planning to install Simple AF you can ignore it, if you are trying to go back to stock, power cycle the printer again to clear the error.  </p> <p>Failing to follow this advice can lead to your printer getting bricked and requiring much more involved intervention to recover!</p> <p></p>"},{"location":"eddyng/#clone-the-repo","title":"Clone the Repo","text":"<pre><code>git config --global http.sslVerify false\ngit clone https://github.com/pellcorp/creality.git /usr/data/pellcorp\nsync\n</code></pre>"},{"location":"eddyng/#run-the-installer","title":"Run the installer","text":"<p>Note</p> <p>If you have pellcorp-overrides in github but not stored locally, you need to recreate the ~/pellcorp-overrides directory before running the installer.sh!</p> <p>To run the script, you must specify the probe you want to use.</p> <pre><code>/usr/data/pellcorp/installer.sh --install eddyng --mount Mount\n</code></pre> <p>Warning</p> <p>For <code>Mount</code> you must specify the mount option for the mount you have used, if you do not do this the printer will be incorrectly configured for your mount, and bed meshes, x and y limits and related config will be wrong.   Please refer to Mount Options for supported mounts.   </p> <p>If you are using a non-supported mount you should specify a mount option as close to your mount as possible and properly adjust your configuration after installation before trying to perform a bed mesh or Screws Tilt Calculate!</p>"},{"location":"eddyng/#post-installation","title":"Post Installation","text":""},{"location":"eddyng/#mcu-firmware-updates-are-pending","title":"MCU Firmware updates are pending","text":"<p>At the end of the installer process if you get this message:</p> <pre><code>WARNING: MCU Firmware updates are pending you need to power cycle your printer!\n</code></pre> <p>It means that new MCU firmware updates need to be applied and this can only be done by power cycling the printer.  After your printer is power cycled you can verify firmware was updated with the <code>CHECK_FIRMWARE</code> macro from Fluidd or Mainsail, if you see this message:</p> <pre><code>INFO: Your MCU Firmware is up to date!\n</code></pre> <p>Your printer MCU firmware was updated successfully.   If you still see the <code>MCU Firmware updates are pending you need to power cycle your printer!</code> message after a power cycle, check the <code>/tmp/mcu_update.log</code>, you may be asked to provide this file on Discord if you need additional assistance, sometimes an additional power cycle can solve the problem, there is a very short window of time (15 seconds) in which the MCU firmware can be updated, so  there is a chance it will work after an additional power cycle.</p>"},{"location":"eddyng/#verify-usb-key","title":"Verify USB Key","text":"<p>It is important to make sure you have a way to emergency factory reset the printer, if the worst happens.   There is a macro in Simple AF called <code>CHECK_USB_KEY</code> that will wait for you to plug a USB thumb drive (aka USB key) in and tell you if it was able to be successfully mounted.</p> <p>You can find the CHECK_USB_KEY macro in Fluidd or Mainsail, because Fluidd and Mainsail are already installed, you can access Fluidd by opening your browser and connecting using http://X.X.X.X, where X.X.X.X is your ip address that you used to login via ssh to your printer, you can also access Fluidd via http://X.X.X.X:4408 and Mainsail via http://X.X.X.X:4409!</p> <p></p> <p>After running the macro you should see output like the following:</p> <p></p> <ul> <li>If you get the message: <code>INFO - USB Key was recognised and mounted correctly (/tmp/udisk/sda1)</code>, your USB thumb drive (aka USB key) is perfect to use for a factory reset.</li> <li>If you get no message at all before the script ends (after 60 seconds), your USB thumb drive (aka USB key) is defective.   You can check the <code>messages</code> file in the logs section of your UI to get more details about why the usb key could not be mounted!</li> </ul> <p>Tip</p> <p>You should verify your USB thumb drive (aka USB key) often just to make sure you have something if you need to unbrick your printer, simply type <code>CHECK_USB_KEY</code> or hit the button in Fluidd / Mainsail The USB key should be FAT32 formatted and be no larger than 32GB!</p> <p>Note</p> <p>If you have plugged your btt eddy into the front usb port, you are going to have to temporarily remove the btt eddy from the front usb slot and replace it with your USB thumb drive, after you have finished verifying the USB thumb drive can be used in an emergency, you can replace the btt eddy into the front usb slot and restart klipper or power cycle your printer.</p>"},{"location":"eddyng/#timer-too-close-and-microsteps","title":"Timer too close and microsteps","text":"<p>For eddyng you cannot use more than <code>microsteps: 32</code>, the MCU cannot handle both more microsteps and eddy, it puts too much pressure on the system and it cause stuttering during bed meshes, it is also been known to cause klipper to crash during repeated bed meshes.</p>"},{"location":"eddyng/#calibration","title":"Calibration","text":"<p>Warning</p> <p>The following calibration steps are required to setup a new printer:</p> <ul> <li>Probe Eddy NG Setup</li> <li>PID Tuning and Input Shaping</li> </ul>"},{"location":"eddyng/#probe-eddy-ng-setup","title":"Probe Eddy NG Setup","text":"<p>Calibrating the eddy should be as easy as running the <code>PROBE_EDDY_NG_SETUP</code>, first step is to home X and Y:</p> <ol> <li>Home XY (<code>G28 X Y</code>)</li> <li>Make sure nozzle is centred on bed</li> <li>Heat Nozzle to 150c (<code>M109 S150</code>) so that any filament can be removed from nozzle</li> <li>Run <code>PROBE_EDDY_NG_SETUP</code>, Follow the Paper Test Method Upon completion <code>SAVE_CONFIG</code></li> </ol> <p>Warning</p> <p>Do not use a metal feeler gauge for this step, it could damage your eddy!!!</p> <p>Note</p> <p>Is normal to show the Z position at almost at the max height of the printer even if the nozzle is somewhere in the middle or even close to the bed, this is not a bug, its intentional.   Until this calibration step is completed, the Z axes cannot be homed, so we make the printer pretend the bed is down the bottom of the printer so that you can freely move the bed up to meet the nozzle during the paper test without running into out of range issues.  You however won't be able to move the bed further away from the nozzle more than a few mm.</p> <p></p> <p>Source: https://github.com/vvuk/eddy-ng/wiki#calibration</p> <p>Warning</p> <p>If you get errors when it comes to tapping as part of printing you may need to increase the tap drive current</p>"},{"location":"eddyng/#pid-tuning-and-input-shaping","title":"Pid Tuning and Input Shaping","text":"<p>At least PID tuning (bed and extruder) and input shaping is required for acceptable printing.  If you try and print after running the installer.sh and a power cycle but before any calibration you will most likely have horrendous quality, the worst you have ever seen on the k1.   After PID tuning and input shaping you should see the same kind of quality as you get with stock k1 + input shaper fix.</p> <p>Note</p> <p>You can use the QUICK_START Macro to complete Bed and Nozzle PID Tuning and Input Shaping Automatically.</p>"},{"location":"eddyng/#pid-tuning","title":"Pid Tuning","text":"<p>Source: Calibrate Pid Settings</p> <p>For example you might run these:</p> <pre><code>PID_CALIBRATE_BED BED_TEMP=65\nPID_CALIBRATE_HOTEND HOTEND_TEMP=230\n</code></pre> <p>Note</p> <p>The <code>PID_CALIBRATE_BED</code> and <code>PID_CALIBRATE_HOTEND</code> macros are located in the <code>useful_macros.cfg</code> file and they have defaults values for BED_TEMP and HOTEND_TEMP so you can just run them by clicking on them if you want that same temperature.</p>"},{"location":"eddyng/#input-shaping","title":"Input Shaping","text":"<p>There is no default configuration for input shaping so it is essentially disabled out of the box.</p> <p>You can use the <code>SHAPER_CALIBRATE</code> macro to run input shaping, just be sure to <code>SAVE CONFIG</code> at the end, to choose the automatically selected shaper config, be aware though that the shaper chosen might be sub-optimal due to a slight difference in vibrations between two options.  So you should probably review the output and potentially choose an alternative if it gives you higher recommended max acceleration for minimal increase in vibration.</p> <p>Input Shaper Auto Calibration</p>"},{"location":"eddyng/#axis-twist-compensation","title":"Axis Twist Compensation","text":"<p>If you are using a rear mount it is highly recommended to perform axis twist compensation, this will affect the quality of your bed mesh, so best to do it before.</p> <p>Tip</p> <p>There is no need to run axis twist compensation if you have mounted the eddy with a side mount that has a 0 y offset!</p> <ol> <li>Home All (<code>G28</code>)</li> <li>Run <code>AXIS_TWIST_COMPENSATION_CALIBRATE</code> The calibration wizard will prompt you to measure the probe Z offset at a few points along the bed    Upon completion <code>SAVE_CONFIG</code></li> </ol> <p>Source: https://www.klipper3d.org/Axis_Twist_Compensation.html</p>"},{"location":"eddyng/#first-print","title":"First Print","text":"<p>You should optimise your probe z offset using baby stepping.</p> <p>In fluidd the save button after you finish or cancel your print can be a bit hard to find, look for</p> <p></p>"},{"location":"eddyng/#other-calibrations","title":"Other Calibrations","text":"<p>Info</p> <p>The default value for pressure advance is set to <code>0.04</code></p> <p>Refer to Orcaslicer Calibration for more calibrations</p> <p>Refer to the Ellis Print Tuning Guide for more great tuning ideas.</p>"},{"location":"eddyng_troubleshooting/","title":"Troubleshooting","text":""},{"location":"eddyng_troubleshooting/#tap-failed-with-z-error-during-homing-probe","title":"Tap failed with Z: Error during homing probe","text":"<p>Sometimes the drive current for homing will work but for tap it breaks, you can calibrate another drive current and manually configure it for tap, I recommend incrementing one from homing value, so for instance of tap and homing setup have 16 as drive current, calibrate 17 as well and you can manually modify the configuration afterwards:</p> <pre><code>PROBE_EDDY_NG_CALIBRATE DRIVE_CURRENT=17\n</code></pre> <p>You can then modify the <code>#*# tap_drive_current = 16</code> to be <code>#*# tap_drive_current = 17</code> and save and restart again</p> <p>I am hopeful further work on this from the eddyng project might make this manual adjustment unnecessary!</p>"},{"location":"eddyng_troubleshooting/#mcu-protocol-error-mcu-eddy-unknown-command-debug_read","title":"MCU Protocol Error - mcu 'eddy' Unknown command: debug_read","text":"<p>If you get the following error, it means that the eddy is not connected to the printer.   This is either because its physically not connected, the wiring is wrong, the usb subsystem has disconnected the eddy during a restart or the serial id is wrong</p> <p></p> <p>So from ssh run a <code>lsusb</code> and make sure you can see:</p> <p></p> <p>If you cannot see it in <code>lsusb</code>, then it very likely means either the eddy is wired incorrectly, or if was working, it just means that an attempt to restart the eddy failed because the K1 refused to recognise it, there is no recourse except to restart the host via Fluidd / Mainsail (or power cycle the printer)</p> <p>If you can see the eddy in lsusb, then you should try to update the serial (see next)</p>"},{"location":"eddyng_troubleshooting/#manual-eddyng-serial-device-configuration","title":"Manual EddyNG Serial Device configuration","text":"<p>You can run the following command to fix your serial if you forgot to plug your btt eddy in during the installation or update:</p> <pre><code>/usr/data/pellcorp/installer.sh --fix-serial\n</code></pre> <p>Note</p> <p>If you run the above and receive an error like:</p> <pre><code>```\nroot@K1Max-AF34 /root [#] ~/pellcorp/installer.sh --fix-serial\n-sh: /root/pellcorp/installer.sh: not found\n```\n</code></pre> <p>It means you are on an older version of Simple AF and you should instead use the old style commands:</p> <pre><code>```\n/usr/data/pellcorp/k1/installer.sh --fix-serial\n```\n</code></pre>"},{"location":"faq/","title":"Frequently Asked Questions","text":""},{"location":"faq/#can-i-use-simple-af-with-my-default-probe-load-cells","title":"Can I use Simple AF with my default probe / Load Cells?","text":"<p>The short answer to this question is no. But if you would like to know why, continue reading. The code required to use the Creality Load Cells for probing is proprietary and has been refused for sharing with the community by Creality. There have been some attempts by the community to get this working, but those attempts aren\u2019t currently complete. Some of these, while 'working,' require further hardware modifications to the Load Cell control board. Modifications that most users wishing to stick with Load Cells would prefer not to make, as these modifications would no longer allow a user to return to stock firmware.</p> <p>This feature may come eventually, but SimpleAF currently does not support the use of the default load cells. If you have successfully incorporated the use of Load Cells into SimpleAF or Klipper and would like to contribute, please let us know.</p>"},{"location":"faq/#how-do-i-integrate-a-nozzle-wipe","title":"How do I integrate a Nozzle Wipe?","text":"<p>So Simple AF will likely never integrate nozzle macros directly into the base product as most mounts and probes have no options for nozzle wipes or they only work with changes to slicer settings and faulty regions in bed meshes which I just don't want to deal with, however a couple of community members have contributed solutions you can use.</p> <p>Danger</p> <p>Do not use a nozzle wiper with a rear mounted probe, there is a strong likelihood of destroying the probe or damaging the printer</p>"},{"location":"faq/#purcell-nozzle-wipe","title":"Purcell Nozzle Wipe","text":"<p>You can find the advanced_nozzle_cleaner.cfg file at https://www.printables.com/model/1023575-advanced-nozzle-wiper-for-creality-k1-series, and upload it to your config directory</p> <p>Make sure its included after <code>[include start_end.cfg]</code> in <code>printer.cfg</code></p> <p>Then make a few changes to <code>advanced_nozzle_cleaner.cfg</code>:</p> <p>Warning</p> <p>You must replace any <code>M106 P0</code> references with just <code>M106</code> as <code>P0</code> is not supported to reference the part fan.  In order to mitigate performance issues that were causing klipper to crash with a move queue overflow we had to migrate from <code>[fan_generic part]</code> to <code>[fan]</code> for the part fan.   M106 P argument still works for chamber and auxiliary like before.</p> <p>You need to disable this:</p> <pre><code>#[gcode_macro CX_NOZZLE_CLEAR]\n#rename_existing: _CX_NOZZLE_CLEAR\n#gcode:\n#  WIPE_NOZZLE\n</code></pre> <p>Add this:</p> <pre><code>[gcode_macro _SAF_NOZZLE_WIPE]\ngcode:\nWIPE_NOZZLE\n</code></pre> <p>I provide no guarantees this works because I have only tested it allows klipper to start, but this is how you integrate the nozzle cleaner, its up to you to verify your mount does not collide with it.</p>"},{"location":"faq/#calin-nozzle-wipe","title":"Calin Nozzle Wipe","text":"<p>For Calin solution its all on the website: https://makerworld.com/en/models/1547901-creality-k1-max-silicone-nozzle-wiper</p> <p>Warning</p> <p>The <code>SET_FAN_SPEED FAN=part SPEED=0</code> will fail, you should replace this with <code>M107</code>.  In order to mitigate performance issues that were causing klipper to crash with a move queue overflow we had to migrate from <code>[fan_generic part]</code> to <code>[fan]</code> for the part fan.   SET_FAN_SPEED still works for auxiliary and chamber fans just not for part!</p>"},{"location":"faq/#how-do-i-switch-from-btteddy-to-eddyng","title":"How do I switch from btteddy to eddyng?","text":"<p>If you have calibrated the btt eddy, you can switch to the eddyng, but you will have to manually remove any btt eddy specific configuration from the SAVE CONFIG section of your printer.cfg file.</p> <p>To make sure Simple AF repo is up to date and on the right branch, run this:</p> <pre><code>~/pellcorp/installer.sh --branch main\n</code></pre> <p>Then to switch to eddyng from eddy while retaining most of your customisations:</p> <pre><code>~/pellcorp/installer.sh --update eddyng --mount TheMount\n</code></pre> <p>Warning</p> <p>Note you will need to change the <code>TheMount</code> to the eddy-ng mount you are using eddy-ng mount options</p> <p>Klipper may fail to start because of the btt eddy configuration at the bottom of the file, you can just manually clean those up, save and restart.</p>"},{"location":"faq/#how-do-i-switch-from-btteddy-to-cartotouch","title":"How do I switch from btteddy to cartotouch?","text":"<p>If you have calibrated the btt eddy, you can switch to the cartotouch, but you will have to manually remove any btt eddy specific configuration from the SAVE CONFIG section of your printer.cfg file.</p> <p>To make sure Simple AF repo is up to date and on the right branch, run this:</p> <pre><code>~/pellcorp/installer.sh --branch main\n</code></pre> <p>Then to switch to cartotouch from btteddy while retaining most of your customisations:</p> <pre><code>~/pellcorp/installer.sh --update cartotouch --mount TheMount\n</code></pre> <p>Warning</p> <p>Note you will need to change the <code>TheMount</code> to the cartographer mount you are using cartographer mount options</p> <p>Klipper may fail to start because of the btt eddy configuration at the bottom of the file, you can just manually clean those up, save and restart.</p>"},{"location":"faq/#how-do-i-add-my-own-macros-to-simple-af","title":"How do I add my own macros to Simple AF?","text":"<p>So you cannot modify or add new macros to Simple AF cfg files, they will be erased the next time you update, what you should do instead is add your own .cfg files with your macros.</p> <p>So create a new file in the config directory, if you create the file in the config directory, Simple AF will back it up for you to the pellcorp-overrides directory where it can be automatically added to your github and will survive a factory reset.</p> <p>So first step is create a new file in the config directory via fluidd or mainsail, I am going to call my file <code>example.cfg</code></p> <p>Then just add <code>[include example.cfg]</code> to <code>printer.cfg</code>, just put it at the end of all the existing includes, save and restart and your macro should appear in the list of macro buttons.</p> <p>Note</p> <p>Its worth noting cfg in sub-directories will not be automatically backed up so best to keep them all in the main config directory.</p>"},{"location":"faq/#why-cant-i-use-force-move","title":"Why can't I use force move?","text":"<p>We disable FORCE_MOVE by default because it works on the stepper level so for multi-z users it would create havoc, and also force move does not work so well for moving x and y either, so its really not that useful. SET_KINEMATIC_POSITION is a much better choice as once you activate this you can use the normal movement buttons in fluidd and mainsail.</p> <p>So if you need to move your nozzle up from being on the bed you should run:</p> <pre><code>SET_KINEMATIC_POSITION Z=0\n</code></pre> <p>This tells the printer to pretend that the nozzle is at zero, so this allows you to move the bed down the the max height of z</p> <p>If you want move to your bed up to the nozzle you should instead do something like:</p> <pre><code>SET_KINEMATIC_POSITION Z=200\n</code></pre> <p>The reason why you cannot choose Z=0 for this scenario is you are telling the printer its at 0 z and the min position for z is -5, so this would only allow you to move the bed down 5mm, so you need to fake the printer into setting the bed to sufficient height to allow you to move it down sufficiently.</p> <p>If you were to set <code>SET_KINEMATIC_POSITION Z=100</code>, but your bed is already at the bottom of the printer there is no way to bring the bed up to meet the nozzle because it will exceed minimum position after moving 105mm.</p> <p>If you wish to restore access to force move set the <code>variable_disable_force_move: True</code> to False in <code>sensorless.cfg</code> and save and restart.</p>"},{"location":"faq/#how-do-i-replace-simple-af-the-kamp-line_purge-with-a-custom-line-purge","title":"How do I replace Simple AF the Kamp Line_Purge with a custom line purge?","text":"<p>So currently there is no official support to do a simple line purge like stock creality, but it is possible with a trick to replace the Simple AF <code>Line_Purge.cfg</code> macro with your own.</p> <p>First step is to disable <code>[include Line_Purge.cfg]</code> in <code>printer.cfg</code></p> <p>Second step is to create a new macros file, call it something like <code>CustomMacros.cfg</code> (it matters not what its called, just as long as it is not the name of an existing file), and create your own <code>LINE_PURGE</code> macro.</p> <p>Third step is to add a new include to <code>printer.cfg</code> for your new custom config file, and your <code>LINE_PURGE</code> macro will be called now instead of the KAMP one.</p> <p>The reason this is recommended over just commenting out <code>LINE_PURGE</code> in <code>start_end.cfg</code> and adding your own macro call, is everything I have described above will survive an Update and even a factory reset because config overrides supports removing the <code>Line_Purge.cfg</code> include, adding a new include to <code>printer.cfg</code> and backing up your custom files. </p>"},{"location":"faq/#how-do-i-integrate-knomi","title":"How do I integrate Knomi?","text":"<p>Knomi Support</p>"},{"location":"faq/#how-can-i-change-mcu-fan-from-always-on","title":"How can I change MCU fan from always on?","text":"<p>By default Simple AF configures the main MCU fan to always be on to avoid overheating the MCU, you can instead restore it to only come on when the steppers or heaters are activated by a few tweaks to fan_control.cfg.</p> <p>So disable this:</p> <pre><code>[static_digital_output mcu_fan_always_on]\npins:PB2\n</code></pre> <p>Enable this:</p> <pre><code>[controller_fan mcu]\npin: PB2\ntachometer_pin: ^PC6\nheater: extruder, heater_bed\nstepper: stepper_x, stepper_y, stepper_z\nidle_timeout: 90\n</code></pre> <p>You also have the option of making the MCU fan purely temp based, however there is a risk if the temp sensor on the MCU is a bit dodgy the fan might not startup early enough to avoid damage or weird behaviour from the MCU and other components, I strongly recommend leaving the MCU fan to always be on</p> <p>But if you want to, something like this might work:</p> <p>So disable this:</p> <pre><code>[static_digital_output mcu_fan_always_on]\npins:PB2\n</code></pre> <p>And add this config:</p> <pre><code># thanks to Habitural from discord\n[temperature_fan _mcu_fan]\npin: PB2\nkick_start_time: 0.8\noff_below: 0.1\n#max_power 1.0\nsensor_type: temperature_mcu\ncontrol: pid\nmin_temp: 0\nmax_temp: 80\npid_kp: 1.0\npid_ki: 0.5\npid_kd: 2.0\nmin_speed: 0.1\nmax_speed: 0.8\ntarget_temp: 38\n</code></pre> <p>You may need to add <code>ADC_TEMPERATURE</code> to the <code>[duplicate_pin_override]</code> section if using this last option.</p> <p>Note config overrides should retain these config changes as long as you do them in the fan_control.cfg file (special handling for that file allows adding and removing whole sections)</p>"},{"location":"faq/#how-do-i-get-the-printer-to-lower-the-bed-at-the-end-of-a-print","title":"How do I get the printer to lower the bed at the end of a print?","text":"<p>This is just a configuration change to the <code>start_end.cfg</code> <code>_CLIENT_VARIABLE</code> <code>variable_custom_park_dz</code> value, you change the value from 25.0 to 50.0 or whatever you want.   If you print a really tall print the bed will be lowered as much room as there is left without exceeding the stepper_z max_position.</p>"},{"location":"faq/#how-do-i-switch-default-ui-from-fluidd-to-mainsail-and-back","title":"How do I switch default UI from fluidd to mainsail and back?","text":"<p>To switch to mainsail:</p> <pre><code>~/pellcorp/tools/switch-default-ui.sh mainsail\n</code></pre> <p>To switch back to fluidd:</p> <pre><code>~/pellcorp/tools/switch-default-ui.sh fluidd\n</code></pre> <p>This change will survive updating Simple AF, but will not be retained for a reinstall or a factory reset. </p> <p>Note</p> <p>If you run the above and receive an error like:</p> <pre><code>```\nroot@K1Max-AF34 /root [#] ~/pellcorp/tools/switch-default-ui.sh mainsail\n-sh: /root/pellcorp/tools/switch-default-ui.sh: not found\n```\n</code></pre> <p>It means you are on an older version of Simple AF and you should instead use the old style commands:</p> <pre><code>```\n/usr/data/pellcorp/k1/installer.sh --branch main\n~/pellcorp/tools/switch-default-ui.sh mainsail\n```\n</code></pre>"},{"location":"faq/#how-do-i-change-the-hostname","title":"How do I change the hostname?","text":"<p>You can update the /etc/hostname with the new hostname from ssh like this:</p> <pre><code>echo \"myhostname\" &gt; /etc/hostname\nsync\n</code></pre> <p>Next time you power cycle your printer, the hostname should be updated</p>"},{"location":"faq/#how-to-install-happy-hare-on-simple-af","title":"How to install Happy Hare on Simple AF?","text":"<p>Note</p> <p>This does not apply to Simple AF for RPi</p> <p>The default installer needs to be executed with some different arguments</p> <p>So first of all clone the repo:</p> <pre><code>git clone https://github.com/moggieuk/Happy-Hare.git /usr/data/Happy-Hare\n</code></pre> <p>Then run the installer:</p> <pre><code>cd /usr/data/Happy-Hare\n./install.sh -k /usr/data/klipper -c /usr/data/printer_data/config -z -m /usr/data/moonraker\nsystemctl restart moonraker\nsystemctl restart klipper\n</code></pre>"},{"location":"faq/#how-do-i-enable-moonraker-timelapses","title":"How do I enable moonraker timelapses?","text":"<p>Enable Moonraker Timelapse</p>"},{"location":"faq/#where-can-i-find-stock-configuration-files","title":"Where can I find stock configuration files?","text":"<p>So Guilouz who created Helper Script hosts the latest version of the K1 / K1M / K1C firmware on his website, you can find the stock config files in his repo: https://github.com/Guilouz/Creality-K1-Extracted-Firmwares/tree/main/Firmware/usr/share/klipper/config</p> <p>I am also starting to collect some squashfs (decrypted) for various firmware as well at https://github.com/pellcorp/downloads/tree/main/creality/firmware</p>"},{"location":"faq/#how-can-i-test-a-new-simple-af-feature","title":"How can I test a new Simple AF feature?","text":"<p>So pellcorp or someone else has ask you to test a feature and you forgot how.   So each proposed feature is going to be in its own branch.   To switch branches or to get new updates for that branch:</p> <pre><code>~/pellcorp/installer.sh --branch jp_some_feature\n</code></pre> <p>Then you need to run an update:</p> <pre><code>~/pellcorp/installer.sh --update\n</code></pre> <p>Pellcorp will tell you the branch name, so replace jp_some_feature, with the branch he gave you!</p>"},{"location":"faq/#how-do-i-setup-remote-access-and-ai-failure-detection","title":"How do I setup remote access and AI failure detection?","text":"<p>OctoEverywhere is a 3D printing community project that enables free remote access, AI print failure detection, notifications, live streaming, and more. The OctoEverywhere companion works great with all Klipper based 3D printers, including the Creality 3D printers.</p> <p>Learn More: https://octoeverywhere.com/companion</p>"},{"location":"faq/#how-do-i-control-octoeverywhere","title":"How do I control OctoEverywhere?","text":"<p>Installing OctoEverywhere Companion </p> <p>OctoEverywhere Companion is controlled by systemd, and each printer is a separate service, so you can see them here:</p> <pre><code>$ systemctl list-units octo* --all\nUNIT                               LOAD   ACTIVE SUB     DESCRIPTION                 \noctoeverywhere-companion-2.service loaded active running OctoEverywhere For Moonraker\noctoeverywhere-companion.service   loaded active running OctoEverywhere For Moonraker\n</code></pre> <p>To check status:</p> <pre><code>systemctl status octoeverywhere-companion.service\n</code></pre> <p>To start it:</p> <pre><code>sudo systemctl start octoeverywhere-companion.service\n</code></pre> <p>To make it start on boot:</p> <pre><code>sudo systemctl enable octoeverywhere-companion.service\n</code></pre> <p>The configuration for each instance of the service is in a separate directory in your home directory, so in my case I have two of them:</p> <pre><code>~/.octoeverywhere-companion/\n~/.octoeverywhere-companion-2/\n</code></pre> <p>And you can find a octoeverywhere.conf in each directory and you can change the IP address in that config file and restart the service:</p> <pre><code>sudo systemctl restart octoeverywhere-companion\n</code></pre>"},{"location":"faq/#how-to-read-belt-shaper-graphs","title":"How to read belt shaper graphs?","text":"<p>Take a look at this video recommended by @EAZY https://www.youtube.com/watch?v=zfnWsBOt3_8</p>"},{"location":"faq/#how-can-i-make-sure-my-bed-is-level-trammed","title":"How can I make sure my bed is level / trammed?","text":"<p>ZeroDotCmd created a great video on the subject of teeth skipping with a few options for how to do it https://youtu.be/S2d_9Ysz-Q8</p> <p>Note this is not about bed mesh, this video is just about getting your bed level enough for bed mesh to be effective.</p>"},{"location":"faq/#how-to-enable-github-backups-for-my-configuration","title":"How to enable Github backups for my configuration?","text":"<p>Backup Config Overrides</p>"},{"location":"faq/#how-can-i-set-a-chamber-fan-target-temp-from-my-slicer","title":"How can I set a chamber fan target temp from my slicer?","text":"<p>So currently there is no way to pass in a parameter to start print for this, but there is a really easy workaround and you can even set the target per filament.   The target being the temp at which the fan gets activated.</p> <p>So per filament in Orca Slicer find the Print chamber temperature and set a value in celcius, but do NOT check the Activate temperature control checkbox.</p> <p>Then in your Machine start Gcode above START_PRINT add this line (before the START_PRINT line):</p> <pre><code>M141 S{chamber_temperature[0]}\n</code></pre> <p>The M141 macro provided by Simple AF (derived from Helper Script) sets the target of the chamber fan via this macro.</p> <p> </p>"},{"location":"faq/#how-do-i-cleanup-all-those-backup-printer-config-files","title":"How do I cleanup all those backup printer config files?","text":"<p>Note</p> <p>This does not apply to Simple AF for RPi</p> <p>Simple AF runs a cleanup every time the printer starts it does the following:</p> <ul> <li>Deletes all log files older than 7 days (excluding moonraker.log, klippy.log and guppyscreen.log), if all log files are older than 7 days, it will leave the the newest old file intact</li> <li>Deletes all backup tar.gz files older than 7 days, if all backup .tar.gz files are older than 7 days, it will leave the newest intact</li> <li>If there is less than 1GB of space left on /usr/data it will remove all gcode files older than 7 days</li> </ul> <p>You can also run this script manually via the hidden macro _CLEANUP_FILES</p>"},{"location":"faq/#what-is-bed-warp-stabilisation-and-why-is-it-good","title":"What is bed warp stabilisation and why is it good?","text":"<p>An excellent video from need it make if for why heat soaking is absolutely vital for optimal bed mesh https://youtu.be/8PEsPLDxt-c</p> <p>In Simple AF out of the box when you start a print a period of bed warp stabilisation is performed.   The default macro will wait 8 seconds for every degree of target bed temp.</p> <p>This is also often referred to as heat soak and it allows the heated bed to settle into its final state before performing the bed mesh.</p> <p>You can disable it before a print by toggling the bed warp stabilisation toggle, which you can find in the fans and outputs section of your UI.</p> <p>In Fluidd its here:</p> <p></p> <p>In Mainsail its here: </p> <p></p> <p>You can disable it permanently by changing the <code>start_end.cfg</code> <code>[output_pin Bed_Warp_Stabilisation]</code> value to 0.</p> <p>You can also modify the following configuration in <code>_START_END_PARAMS</code>:</p> <ul> <li><code>variable_bed_warp_wait_multiplier</code>  - So this value is how many seconds per degree of final bed target temp.</li> <li><code>variable_bed_warp_fraction_wait</code> - If the bed temp is at least 75% of target we will do partial heat soak, if it's less than 75% will heat soak then entire target amount.</li> <li><code>variable_bed_warp_wait_interval</code> - This is how long the macro will sleep between notifications</li> </ul> <p>Note</p> <p>Please note at the end of a print the heater of the bed will remain heated until the printer times out in a hour.</p> <p>If you want to use bed warp stabilisation but not keep the heater on at end, you can change the <code>start_end.cfg</code> <code>_START_END_PARAMS</code> <code>variable_end_print_keep_bed_heated</code> to <code>False</code>!</p> <p>For some probes like the eddy (so for <code>btteddy</code> or <code>eddyng</code>) sitting just above the heated bed for an extended period of time can cause it to be excessively heated, there is a <code>start_end.cfg</code> property <code>variable_start_print_bed_heating_move_bed_distance</code> which can be set to something like <code>100</code> to position the toolhead much further away from the bed while the bed heats, the default value of 20mm might not be sufficient for your use case.</p>"},{"location":"faq/#how-do-i-use-my-cartographer-for-input-shaping","title":"How do I use my cartographer for input shaping?","text":"<p>Cartographer Input Shaper</p>"},{"location":"faq/#how-can-i-downgrade-from-cfs-firmware","title":"How can I downgrade from CFS Firmware?","text":"<p>Creality added logic to prevent downgrading to older version of firmware, but its super easy to work around this, we just need to download an older <code>local_ota_update.sh file</code>, I have saved the 1.3.3.46 version of the script to my downloads repo to make it easier to get.</p> <p>So first of all go and grab the version of the older K1 firmware you want from https://www.creality.com/pages/download-k1-flagship, save it to a USB key, and stick it into the front of your printer!</p> <p>Now login via ssh to your printer</p> <p>From the ssh command line on your printer download the older <code>local_ota_update.sh</code> script like so:</p> <pre><code>wget https://raw.githubusercontent.com/Guilouz/Creality-K1-Extracted-Firmwares/refs/heads/main/Firmware/etc/ota_bin/local_ota_update.sh -O - &gt; /usr/data/local_ota_update.sh\nchmod 777 /usr/data/local_ota_update.sh\n</code></pre> <p>Now you can flash new firmware with this script without the version downgrade logic getting in the way:</p> <pre><code>/usr/data/local_ota_update.sh /tmp/udisk/sda1/CR4CU220812S11_ota_img_V1.3.3.46.img\n</code></pre> <p>You should wait until you see lines like the following especially <code>ota update ok</code>:</p> <pre><code>rootfs.squashfs read ok, now quit\nota: data processed: 99% 127696896 132233080\nrootfs update done\nstart update rtos\nzero.bin read ok, now quit\nota: data processed: 100% 452408 132233080\nrtos update done\nota update ok\n256+0 records in\n256+0 records out\nota: stoped success\n</code></pre> <p>Then you can logout of your ssh session and power cycle your printer.   It is a good idea to factory reset your printer just to be sure all remnants of the CFS abomination has been excised!</p> <p>Note</p> <p>If you get the error <code>-sh: /usr/data/local_ota_update.sh: Permission denied</code>, you forgot to do <code>chmod 777 /usr/data/local_ota_update.sh</code></p> <p>If you get the error <code>/tmp/udisk/sda1/CR4CU220812S11_ota_img_V1.3.3.46.img Not a file</code> it means either you did not download the latest img or else for some reason the usb key was mounted to somewhere different than <code>/tmp/udisk/sda1/</code></p> <p>You can check which directory the usb was mounted with the following command:</p> <pre><code>mount | grep 'sda'\n</code></pre> <p>For example for my USB key its not mounted to <code>/tmp/udisk/sda1</code>, instead its mounted to <code>/tmp/udisk/sda</code>:</p> <p></p> <p>So I would need to specify instead: </p> <pre><code>/usr/data/local_ota_update.sh /tmp/udisk/sda/CR4CU220812S11_ota_img_V1.3.3.46.img\n</code></pre>"},{"location":"faq/#how-can-i-prevent-a-print-starting-or-resuming-if-there-is-no-filament-present","title":"How can I prevent a print starting or resuming if there is no filament present?","text":"<p>A new feature has just been merged to Simple AF to support this, but you will need a normal filament sensor switch, update to latest Simple AF and enable a setting after installation.</p> <p>You need to update to latest Simple AF:</p> <pre><code>~/pellcorp/installer.sh --branch main\n~/pellcorp/installer.sh --update\n</code></pre> <p>Note</p> <p>If you run the above and receive an error like:</p> <pre><code>```\nroot@K1Max-AF34 /root [#] ~/pellcorp/installer.sh --branch main\n-sh: /root/pellcorp/installer.sh: not found\n```\n</code></pre> <p>It means you are on an older version of Simple AF and you should instead use the old style commands:</p> <pre><code>```\n/usr/data/pellcorp/k1/installer.sh --branch main\n~/pellcorp/installer.sh --update\n```\n</code></pre> <p>Then open the <code>start_end.cfg</code>, find the <code>variable_runout_sensor</code> in the <code>_CLIENT_VARIABLE</code> section and set it to match your filament runout sensor, like so:</p> <pre><code>variable_runout_sensor: \"filament_switch_sensor filament_sensor\"\n</code></pre> <p>Tip</p> <p>The runout sensor you specify in the <code>variable_runout_sensor</code> configuration must match exactly your configuration, so for instance if you switch to a toolhead sensor you might have configured it as <code>[filament_switch_sensor toolhead_sensor]</code> in which case you must change the configuration to <code>variable_runout_sensor: \"filament_switch_sensor toolhead_sensor\"</code> </p> <p>Save and Restart</p> <p>Then when you try to start a print without filament you will get a message like:</p> <p></p>"},{"location":"faq/#how-can-i-switch-to-a-toolhead-filament-runout-sensor","title":"How can I switch to a toolhead filament runout sensor?","text":"<p>So if you are using the DXC extruder, Creality CFS Extruder, or even the Henlor Mod for the stock Extruder, you want to switch from using the runout sensor bolted to the printer case and use the extruder runout sensor on the toolhead, its really easy, its literally just a single config change in your printer.cfg.</p> <p>So find the <code>[filament_switch_sensor filament_sensor]</code> and change:</p> <p>From: <code>switch_pin: !PC15</code></p> <p>To: <code>switch_pin: !nozzle_mcu:PA10</code></p> <p>It should look something like this (there may be <code>event_delay</code> and <code>pause_delay</code> which should be left alone):</p> <pre><code>[filament_switch_sensor filament_sensor]\npause_on_runout: false\nswitch_pin: !nozzle_mcu:PA10\nrunout_gcode: _ON_FILAMENT_RUNOUT\n</code></pre> <p>Save and Restart and enjoy!</p> <p>Danger</p> <p>Do not define two filament_switch_sensor that both _ON_FILAMENT_RUNOUT for <code>runout_gcode</code>, the installer will  remove the <code>[filament_switch_sensor filament_sensor_2]</code>, do not restore this config!</p> <p>Please also note that on more recent versions of Simple AF the <code>pause_on_runout</code> value is set to false, because we trigger <code>PAUSE</code> from the _ON_FILAMENT_RUNOUT macro now to avoid phantom triggers of pause when changing filament!</p>"},{"location":"faq/#what-is-axis-twist","title":"What is Axis Twist?","text":"<p>So ZeroDotCmd has done some great videos on this topic https://www.youtube.com/watch?v=O_U8t5Ap0Ik and https://www.youtube.com/watch?v=1KVTRDim1lk</p> <p>More details here: https://www.klipper3d.org/Axis_Twist_Compensation.html</p>"},{"location":"faq/#can-i-get-grumpyscreen-on-helper-script","title":"Can I get GrumpyScreen on Helper Script?","text":"<p>So I have added experimental support for installing GrumpyScreen (our fork of GuppyScreen) onto Helper Script printers, currently only K1, K1C, K1SE and K1M are supported and the support is experimental, I make no guarantees things won't break, so you must have already installed GuppyScreen via helper script and then you can run the following from your printer ssh console:</p> <pre><code>wget https://raw.githubusercontent.com/pellcorp/creality-wiki/refs/heads/main/helperscript/install-grumpyscreen.sh -O - &gt; /usr/data/install-grumpyscreen.sh\nsh /usr/data/install-grumpyscreen.sh\n</code></pre> <p>It will replace guppyscreen binary and configuration file, you can update GrumpyScreen via the screen only, the Helper Script <code>GUPPY_UPDATE</code> macro has been removed as it breaks grumpyscreen.</p> <p>If you want to revert to normal guppyscreen just uninstall and reinstall from Helper Script, I do not provide a script to do this automatically</p> <p>Please note that GrumpyScreen is a vastly simplified version of Guppyscreen:</p> <ul> <li>No Gcode execution</li> <li>No Belts &amp; Shake</li> <li>No Input Shaper</li> <li>No Bed Mesh</li> <li>No TMC Metrics</li> <li>No Tuning (other than during a print)</li> <li>No Limits</li> <li>No Power Devices (wtf that is)</li> </ul> <p>We focus on polishing a subset of features and we added some additional ones:</p> <ul> <li>Factory Reset</li> <li>E-Stop on more screens</li> <li>Setting chamber temp targets</li> </ul> <p>The Belt Shaper calibration macros from GuppyScreen remain and can be executed from fluidd or mainsail</p>"},{"location":"faq/#how-do-i-get-the-bed-to-cooldown-after-a-print-finishes","title":"How do I get the bed to cooldown after a print finishes?","text":"<p>So by default with Bed Warp stabilisation enabled, the bed will stay warm after a print for up to 1 hour (this can be changed too btw), if you do not want the bed to stay warm after a print you can either toggle the bed warp stabililation toggle in fluidd or mainsail before END_PRINT runs or you can modify the  <code>start_end.cfg</code> <code>variable_end_print_cool_down</code> and change it to <code>False</code>, so it should then look like:</p> <pre><code>variable_end_print_cool_down: False\n</code></pre>"},{"location":"klicky/","title":"Klicky","text":""},{"location":"klicky/#where-can-i-get-help","title":"Where can I get help?","text":"<p>Danger</p> <p>Getting the klicky setup correctly takes time and patience to ensure you do not damage your printer or the klicky, also when doing operations like homing and bed meshes and the like you should never leave your printer unattended in case docking or attaching fails for some reason.</p> <p>Come on over to the pellcorp discord server, here is the invite, the <code>#simple-af-klicky</code> channel has been setup for anyone wanting support for klicky.</p> <p>https://discord.gg/2uGDzyJ3WX</p>"},{"location":"klicky/#k1-series","title":"K1 Series","text":"<p>This guide assumes you have a K1, K1C, K1SE or K1 Max and you are running stock creality firmware 1.3.3.5 or higher (The firmware 1.3.3.5 is much older than 1.3.3.46 for example), or alternately you can use my prerooted firmware.</p>"},{"location":"klicky/#ender-5-max","title":"Ender 5 Max","text":"<p>This probe is currently not supported on Ender 5 Max</p>"},{"location":"klicky/#ender-3-v3-ke","title":"Ender 3 V3 KE","text":"<p>This probe is currently not supported on Ender 3 V3 KE</p>"},{"location":"klicky/#simple-af-for-rpi","title":"Simple AF for RPi","text":"<p>See Simple AF for RPi</p>"},{"location":"klicky/#slicer-settings","title":"Slicer Settings","text":"<p>Danger</p> <p>Creality Print won't be able to see your printer after you have installed Simple AF, the only tested slicer we all use is OrcaSlicer, likely if you want to use Creality Print you will need to print via usb.</p> <p>Cura Slicer won't work out of the box for configuring START_PRINT variables as below, you need to change the start print EXTRUDER_TEMP and BED_TEMP to pass in the correct values, but since I don't use Cura Slicer I can't advise on that!</p> <p>There is an assumption that you are using a slicer like OrcaSlicer and Machine G-code like:</p> <p></p> <p>Machine start G-code <pre><code>M140 S0\nM104 S0\nSTART_PRINT EXTRUDER_TEMP=[nozzle_temperature_initial_layer] BED_TEMP=[bed_temperature_initial_layer_single]\n</code></pre></p> <p>Machine end G-code <pre><code>END_PRINT\n</code></pre></p>"},{"location":"klicky/#custom-bed-mesh-profile","title":"Custom Bed Mesh Profile","text":"<p>If you want to select a specific predefined bed mesh profile (which disables adaptive mesh generation), you can pass in an additional <code>START_PRINT</code> parameter:</p> <p>You can either hard code it to a particular model, like <code>BED_MESH_PROFILE=myprofile</code> or you can specify a profile based on orca slicer variables, such as <code>BED_MESH_PROFILE=\"[curr_bed_type] - [filament_type]\"</code>, but you have to make sure you have all the possible profiles defined for each of the bed type and filament type combinations.</p> <p></p>"},{"location":"klicky/#probe-installation","title":"Probe Installation","text":"<p>All probe mount options assume you have purchased a PCB Klicky:</p> <ul> <li>https://www.aliexpress.com/item/1005005023158174.html</li> </ul>"},{"location":"klicky/#mount-options","title":"Mount Options","text":""},{"location":"klicky/#default","title":"Default","text":"<p>Warning</p> <p>This klicky dock is for the stock gantry only, it is highly unlikely to work with any other gantry, the dock would need to be remixed for that!</p> <p>The models can be downloaded from https://www.printables.com/model/1170906-klicky-pcb-probe-for-creality-k1, but the instructions for wiring and the macros are not relevant and the wiring shown is a bit misleading, so just the models from printables nothing else.   Don't forget the 1mm spacer on the toolhead otherwise the klicky does not properly line up when attached.</p> <p>This mount should work for K1/K1C/K1SE and K1M, but only K1 and K1M variants have actually been tested.</p>"},{"location":"klicky/#installation","title":"Installation","text":"<p>Warning</p> <p>The installation section does not apply to Simple AF for RPi, See Simple AF for RPi</p> <p>The installation can only be performed on a printer which has been rooted and ssh granted</p> <p>You need root access, if you are not already root, then follow the excellent Helper Script Enable Root Access instructions.</p>"},{"location":"klicky/#factory-reset","title":"Factory Reset","text":"<p>You must do a factory reset only if you have installed Helper Script or Fluidd/Mainsail directly from Creality, otherwise you can safely proceed directly to installation.    If you have setup your printer with stock firmware only it can be quite handy to skip a factory reset so that you can use Switch to Stock</p> <pre><code>wget --no-check-certificate https://raw.githubusercontent.com/pellcorp/creality/main/k1/services/S58factoryreset -O /tmp/S58factoryreset\nchmod +x /tmp/S58factoryreset\n/tmp/S58factoryreset reset\n</code></pre> <p>Danger</p> <p>It is really important you do not close the ssh session until you get this message:</p> <p></p> <p>It can take up to 5 minutes for a factory restart to finish, it is vital you do not power cycle your printer before the stock screen appears. There may be a 3002 error on the screen, this is completely normal.   If you are planning to install Simple AF you can ignore it, if you are trying to go back to stock, power cycle the printer again to clear the error.  </p> <p>Failing to follow this advice can lead to your printer getting bricked and requiring much more involved intervention to recover!</p> <p></p>"},{"location":"klicky/#clone-the-repo","title":"Clone the Repo","text":"<pre><code>git config --global http.sslVerify false\ngit clone https://github.com/pellcorp/creality.git /usr/data/pellcorp\nsync\n</code></pre>"},{"location":"klicky/#run-the-installer","title":"Run the installer","text":"<p>Note</p> <p>If you have pellcorp-overrides in github but not stored locally, you need to recreate the ~/pellcorp-overrides directory before running the installer.sh!</p> <p>To run the script, you must specify the probe you want to use.</p> <pre><code>/usr/data/pellcorp/installer.sh --install klicky --mount Mount\n</code></pre> <p>Warning</p> <p>For <code>Mount</code> you must specify the mount option for the mount you have used, if you do not do this the printer will be incorrectly configured for your mount and dock location, and bed meshes, x and y limits and related config will be wrong.   Please refer to Mount Options for supported mounts.   </p> <p>If you are using a non-supported mount you should specify a mount option as close to your mount as possible and properly adjust your configuration after installation before trying to perform a bed mesh or Screws Tilt Calculate!</p>"},{"location":"klicky/#post-installation","title":"Post Installation","text":""},{"location":"klicky/#mcu-firmware-updates-are-pending","title":"MCU Firmware updates are pending","text":"<p>At the end of the installer process if you get this message:</p> <pre><code>WARNING: MCU Firmware updates are pending you need to power cycle your printer!\n</code></pre> <p>It means that new MCU firmware updates need to be applied and this can only be done by power cycling the printer.  After your printer is power cycled you can verify firmware was updated with the <code>CHECK_FIRMWARE</code> macro from Fluidd or Mainsail, if you see this message:</p> <pre><code>INFO: Your MCU Firmware is up to date!\n</code></pre> <p>Your printer MCU firmware was updated successfully.   If you still see the <code>MCU Firmware updates are pending you need to power cycle your printer!</code> message after a power cycle, check the <code>/tmp/mcu_update.log</code>, you may be asked to provide this file on Discord if you need additional assistance, sometimes an additional power cycle can solve the problem, there is a very short window of time (15 seconds) in which the MCU firmware can be updated, so  there is a chance it will work after an additional power cycle.</p>"},{"location":"klicky/#verify-usb-key","title":"Verify USB Key","text":"<p>It is important to make sure you have a way to emergency factory reset the printer, if the worst happens.   There is a macro in Simple AF called <code>CHECK_USB_KEY</code> that will wait for you to plug a USB thumb drive (aka USB key) in and tell you if it was able to be successfully mounted.</p> <p>You can find the CHECK_USB_KEY macro in Fluidd or Mainsail, because Fluidd and Mainsail are already installed, you can access Fluidd by opening your browser and connecting using http://X.X.X.X, where X.X.X.X is your ip address that you used to login via ssh to your printer, you can also access Fluidd via http://X.X.X.X:4408 and Mainsail via http://X.X.X.X:4409!</p> <p></p> <p>After running the macro you should see output like the following:</p> <p></p> <ul> <li>If you get the message: <code>INFO - USB Key was recognised and mounted correctly (/tmp/udisk/sda1)</code>, your USB thumb drive (aka USB key) is perfect to use for a factory reset.</li> <li>If you get no message at all before the script ends (after 60 seconds), your USB thumb drive (aka USB key) is defective.   You can check the <code>messages</code> file in the logs section of your UI to get more details about why the usb key could not be mounted!</li> </ul> <p>Tip</p> <p>You should verify your USB thumb drive (aka USB key) often just to make sure you have something if you need to unbrick your printer, simply type <code>CHECK_USB_KEY</code> or hit the button in Fluidd / Mainsail The USB key should be FAT32 formatted and be no larger than 32GB!</p>"},{"location":"klicky/#docking","title":"Docking","text":"<p>Getting docking working if you are not using the <code>Default</code> mount or you have positioned the dock somewhere other than the rear left stepper motor is left as an exercise for each user. Out of the box automatic docking is disabled for a new installation of Simple AF, you should verify the dock coordinates in the <code>klicky_macro.cfg</code> are correct, and you can then flip the <code>variable_auto_docking</code> to <code>True</code>, save and restart and klicky will auto attach and dock for homing, bed meshing and start print.</p>"},{"location":"klicky/#verifying-probe","title":"Verifying Probe","text":"<p>It's really important to verify that the klicky actually will work as an endstop for homing, so initiate homing and then use your finger to activate the microswitch on the bottom of the klicky and make sure homing stops, if it does not stop you need to immediately use the e-stop button in your UI or Grumpyscreen or hit that power button </p>"},{"location":"klicky/#timer-too-close-and-microsteps","title":"Timer too close and microsteps","text":"<p>For microprobe, etc you cannot use more than <code>microsteps: 64</code>.</p>"},{"location":"klicky/#calibration","title":"Calibration","text":"<p>Warning</p> <p>The following calibration steps are required to setup a new printer:</p> <ul> <li>Probe Calibrate</li> <li>PID Tuning and Input Shaping</li> </ul>"},{"location":"klicky/#probe-calibrate","title":"Probe Calibrate","text":"<ol> <li>Home All (<code>G28</code>)</li> <li>Make sure nozzle is centred on bed</li> <li>Run <code>PROBE_CALIBRATE</code></li> <li>Manually remove klicky probe and put it into the dock</li> <li>Follow the Paper Test Method Upon completion <code>SAVE_CONFIG</code></li> </ol>"},{"location":"klicky/#pid-tuning-and-input-shaping","title":"Pid Tuning and Input Shaping","text":"<p>At least PID tuning (bed and extruder) and input shaping is required for acceptable printing.  If you try and print after running the installer.sh and a power cycle but before any calibration you will most likely have horrendous quality, the worst you have ever seen on the k1.   After PID tuning and input shaping you should see the same kind of quality as you get with stock k1 + input shaper fix.</p> <p>Note</p> <p>You can use the QUICK_START Macro to complete Bed and Nozzle PID Tuning and Input Shaping Automatically.</p>"},{"location":"klicky/#pid-tuning","title":"Pid Tuning","text":"<p>Source: Calibrate Pid Settings</p> <p>For example you might run these:</p> <pre><code>PID_CALIBRATE_BED BED_TEMP=65\nPID_CALIBRATE_HOTEND HOTEND_TEMP=230\n</code></pre> <p>Note</p> <p>The <code>PID_CALIBRATE_BED</code> and <code>PID_CALIBRATE_HOTEND</code> macros are located in the <code>useful_macros.cfg</code> file and they have defaults values for BED_TEMP and HOTEND_TEMP so you can just run them by clicking on them if you want that same temperature.</p>"},{"location":"klicky/#input-shaping","title":"Input Shaping","text":"<p>There is no default configuration for input shaping so it is essentially disabled out of the box.</p> <p>You can use the <code>SHAPER_CALIBRATE</code> macro to run input shaping, just be sure to <code>SAVE CONFIG</code> at the end, to choose the automatically selected shaper config, be aware though that the shaper chosen might be sub-optimal due to a slight difference in vibrations between two options.  So you should probably review the output and potentially choose an alternative if it gives you higher recommended max acceleration for minimal increase in vibration.</p> <p>Input Shaper Auto Calibration</p>"},{"location":"klicky/#axis-twist-compensation","title":"Axis Twist Compensation","text":"<p>It is highly recommended to perform axis twist compensation, this will affect the quality of your bed mesh, so best to do it before.</p> <p>Tip</p> <p>There is no need to run axis twist compensation if you have mounted the eddy with a side mount that has a 0 y offset!</p> <ol> <li>Home All (<code>G28</code>)</li> <li>Run <code>AXIS_TWIST_COMPENSATION_CALIBRATE</code> The calibration wizard will prompt you to measure the probe Z offset at a few points along the bed    Upon completion <code>SAVE_CONFIG</code></li> </ol> <p>Source: https://www.klipper3d.org/Axis_Twist_Compensation.html</p>"},{"location":"klicky/#first-print","title":"First Print","text":"<p>You should optimise your probe z offset using baby stepping.</p> <p>In fluidd the save button after you finish or cancel your print can be a bit hard to find, look for</p> <p></p>"},{"location":"klicky/#other-calibrations","title":"Other Calibrations","text":"<p>Info</p> <p>The default value for pressure advance is set to <code>0.04</code></p> <p>Refer to Orcaslicer Calibration for more calibrations</p> <p>Refer to the Ellis Print Tuning Guide for more great tuning ideas.</p>"},{"location":"klicky_wiring/","title":"Klicky Wiring","text":"<p>Note</p> <p>This wiring section applies to K1/K1C/K1SE/K1M printers only</p> <p>You will need to make a cable from the nozzle touch port to the 3 pin port on the klicky.</p> <p>The TOUCH port on the Nozzle MCU board mates with a male 5-pin Molex Picoblade connector. Some sellers may call the connector \"Micro JST SH 1.25\" but that is incorrect.</p> <p>You could repin a CR-Touch cable (used for connecting bltouch / microprobe) with the 3 pin connector provided with the PCB Klicky, or make your own cable.</p> <p>The Creality cable for their CR Touch probe is a good option although you will need to remove 2 of the wires for a neat connection</p> <ul> <li>https://www.aliexpress.us/item/1005004960067376.html</li> <li>https://www.amazon.com/dp/B0BKPFY24M/</li> </ul> <p>You want to use the 3 top wires on the nozzle mcu TOUCH port.   Connect to TOUCH port on the nozzle MCU, it is accessible from the side left (LIDAR) side of the printhead and only the external cover of the printhead has to be removed.</p> <p></p> <p></p> <p>The wiring looks like this:</p> <p></p>"},{"location":"legacy_btteddy_flashing/","title":"Legacy btteddy flashing","text":"<p>Danger</p> <p>THIS IS A RISKY OPERATION YOU CAN BRICK YOUR EDDY</p>"},{"location":"legacy_btteddy_flashing/#creating-a-live-usb-key","title":"Creating a Live USB Key","text":"<p>If you do not have a Raspberry PI or an Linux Desktop or Server machine, you can create a live USB and boot into that, the following instructions work fine on a Usb Key, just make sure the USB is at least 8GB in size to allow for installing the packages we need and cloning klipper.</p> <p>https://ubuntu.com/tutorials/try-ubuntu-before-you-install#1-getting-started</p>"},{"location":"legacy_btteddy_flashing/#install-some-deps-on-ubuntu","title":"Install some deps on Ubuntu","text":"<pre><code>sudo apt-get update\nsudo apt-get install -y build-essential git libusb-1.0.0-dev pkg-config\n</code></pre>"},{"location":"legacy_btteddy_flashing/#flashing","title":"Flashing","text":""},{"location":"legacy_btteddy_flashing/#connecting-in-bootsel-mode","title":"Connecting in BOOTSEL mode","text":"<p>You need to connect your btt eddy to your computer in BOOTSEL mode, you do this by disconnecting the eddy usb, and then push and hold boot button on Eddy (It's next to where the cable plugs in) and at the same time, plug in the cable to your computer.</p> <p>You know its correct if you run an <code>lsusb</code> and see: </p>"},{"location":"legacy_btteddy_flashing/#flashing-btteddyuf2-file","title":"Flashing btteddy.uf2 file","text":"<p>First of all you need klipper:</p> <pre><code>git clone https://github.com/pellcorp/klipper.git\n</code></pre> <p>Then we need to build the rp2040_flash flasher: <pre><code>cd klipper/lib/rp2040_flash\nmake\ncd -\n</code></pre></p> <p>Note</p> <p>If make fails you forgot to install <code>build-essential</code> package:</p> <pre><code>sudo apt-get install -y build-essential\n</code></pre> <p>Then try the make again</p> <p>Then we need to do the actual flashing:</p> <pre><code>cd klipper\nsudo python3 ./scripts/flash_usb.py -t rp2040 -d 2e8a:0003 fw/K1/btteddy.uf2\n</code></pre> <p>Note</p> <p>We are not compiling new firmware, just flashing the firmware I have already prepared.</p>"},{"location":"microprobe/","title":"Microprobe","text":""},{"location":"microprobe/#where-can-i-get-help","title":"Where can I get help?","text":"<p>Come on over to the pellcorp discord server, the <code>#simple-af-microprobe</code> channel has been setup for anyone wanting support for microprobe.</p> <p>https://discord.gg/2uGDzyJ3WX</p>"},{"location":"microprobe/#k1-series","title":"K1 Series","text":"<p>This guide assumes you have a K1, K1C, K1SE or K1 Max and you are running stock creality firmware 1.3.3.5 or higher (The firmware 1.3.3.5 is much older than 1.3.3.46 for example), or alternately you can use my prerooted firmware.</p>"},{"location":"microprobe/#ender-5-max","title":"Ender 5 Max","text":"<p>This probe is currently not supported on Ender 5 Max</p>"},{"location":"microprobe/#ender-3-v3-ke","title":"Ender 3 V3 KE","text":"<p>This guide assumes you have a stock Ender 3 V3 KE with Nebula Pad with Root enabled, when you get to installation below, you should specify the <code>--mount Default</code> to install Simple AF on the KE for Cartographer.</p> <p>Please note that you will need to change the screen orientation to horizontal, here is a model for that https://www.printables.com/model/727362-ender-3-v3-ke-screen-holder-landscape-for-guppyscr, but please do not follow the installation instructions on that page, just print the model and remount your screen only!</p>"},{"location":"microprobe/#simple-af-for-rpi","title":"Simple AF for RPi","text":"<p>See Simple AF for RPi</p>"},{"location":"microprobe/#slicer-settings","title":"Slicer Settings","text":"<p>Danger</p> <p>Creality Print won't be able to see your printer after you have installed Simple AF, the only tested slicer we all use is OrcaSlicer, likely if you want to use Creality Print you will need to print via usb.</p> <p>Cura Slicer won't work out of the box for configuring START_PRINT variables as below, you need to change the start print EXTRUDER_TEMP and BED_TEMP to pass in the correct values, but since I don't use Cura Slicer I can't advise on that!</p> <p>There is an assumption that you are using a slicer like OrcaSlicer and Machine G-code like:</p> <p></p> <p>Machine start G-code <pre><code>M140 S0\nM104 S0\nSTART_PRINT EXTRUDER_TEMP=[nozzle_temperature_initial_layer] BED_TEMP=[bed_temperature_initial_layer_single]\n</code></pre></p> <p>Machine end G-code <pre><code>END_PRINT\n</code></pre></p>"},{"location":"microprobe/#custom-bed-mesh-profile","title":"Custom Bed Mesh Profile","text":"<p>If you want to select a specific predefined bed mesh profile (which disables adaptive mesh generation), you can pass in an additional <code>START_PRINT</code> parameter:</p> <p>You can either hard code it to a particular model, like <code>BED_MESH_PROFILE=myprofile</code> or you can specify a profile based on orca slicer variables, such as <code>BED_MESH_PROFILE=\"[curr_bed_type] - [filament_type]\"</code>, but you have to make sure you have all the possible profiles defined for each of the bed type and filament type combinations.</p> <p></p> <p></p>"},{"location":"microprobe/#probe-installation","title":"Probe Installation","text":"<p>Danger</p> <p>If you are not using a side mount you must verify config changes for microprobe.cfg before homing your printer, using Screws Tilt Calculate or doing a bed mesh!  </p> <p>Ignoring these instructions can lead to significant damage to your build plate and/or probe.</p>"},{"location":"microprobe/#mount-options","title":"Mount Options","text":"Mount Printer URL Notes Default K1, K1C, K1M, K1SE https://www.printables.com/model/867527-k1-biqu-microprobe-mount-remix BootyGantry K1, K1C, K1M, K1SE https://github.com/tlace17/K1-Linear-Rail-Gantry/blob/main/STLs/Probe%20Mounts/Rail%20Carriage%20Microprobe%20Mount.stl Default Ender 3 K3 KE https://www.printables.com/model/1024825-biqu-btt-microprobe-to-crtouch-adapter Experimental and untested as yet <p>Important: All mount options assume a V2 microprobe is being used, after the installation you may need to modify <code>microprobe.cfg</code> to  switch the pin config:</p> <pre><code>#pin: ^nozzle_mcu: PA9  # MicroProbe V1 users should use this line to trigger on high\npin: ^!nozzle_mcu: PA9  # MicroProbe V2 users should use this line to trigger on low\n</code></pre>"},{"location":"microprobe/#installation","title":"Installation","text":"<p>Warning</p> <p>The installation section does not apply to Simple AF for RPi, See Simple AF for RPi</p> <p>The installation can only be performed on a printer which has been rooted and ssh granted</p> <p>You need root access, if you are not already root, then follow the excellent Helper Script Enable Root Access instructions.</p>"},{"location":"microprobe/#factory-reset","title":"Factory Reset","text":"<p>You must do a factory reset only if you have installed Helper Script or Fluidd/Mainsail directly from Creality, otherwise you can safely proceed directly to installation.    If you have setup your printer with stock firmware only it can be quite handy to skip a factory reset so that you can use Switch to Stock</p> <pre><code>wget --no-check-certificate https://raw.githubusercontent.com/pellcorp/creality/main/k1/services/S58factoryreset -O /tmp/S58factoryreset\nchmod +x /tmp/S58factoryreset\n/tmp/S58factoryreset reset\n</code></pre> <p>Danger</p> <p>It is really important you do not close the ssh session until you get this message:</p> <p></p> <p>It can take up to 5 minutes for a factory restart to finish, it is vital you do not power cycle your printer before the stock screen appears. There may be a 3002 error on the screen, this is completely normal.   If you are planning to install Simple AF you can ignore it, if you are trying to go back to stock, power cycle the printer again to clear the error.  </p> <p>Failing to follow this advice can lead to your printer getting bricked and requiring much more involved intervention to recover!</p> <p></p>"},{"location":"microprobe/#clone-the-repo","title":"Clone the Repo","text":"<pre><code>git config --global http.sslVerify false\ngit clone https://github.com/pellcorp/creality.git /usr/data/pellcorp\nsync\n</code></pre>"},{"location":"microprobe/#run-the-installer","title":"Run the installer","text":"<p>Note</p> <p>If you have pellcorp-overrides in github but not stored locally, you need to recreate the ~/pellcorp-overrides directory before running the installer.sh!</p> <p>To run the script, you must specify the probe you want to use.</p> <pre><code>/usr/data/pellcorp/installer.sh --install microprobe --mount Mount\n</code></pre> <p>Warning</p> <p>For <code>Mount</code> you must specify the mount option for the mount you have used, if you do not do this the printer will be incorrectly configured for your mount, and bed meshes, x and y limits and related config will be wrong.   Please refer to Mount Options for supported mounts.   </p> <p>If you are using a non-supported mount you should specify a mount option as close to your mount as possible and properly adjust your configuration after installation before trying to perform a bed mesh or Screws Tilt Calculate!</p>"},{"location":"microprobe/#post-installation","title":"Post Installation","text":""},{"location":"microprobe/#v1-probe-changes","title":"V1 Probe Changes","text":"<p>The default microprobe.cfg assumes a V2 microprobe a post install change to <code>[probe]</code> section of <code>printer.cfg</code> will be required for a V1.  Have a look at the printer.cfg after the install has finished and have a look at the commented V1 pin config.</p>"},{"location":"microprobe/#mcu-firmware-updates-are-pending","title":"MCU Firmware updates are pending","text":"<p>At the end of the installer process if you get this message:</p> <pre><code>WARNING: MCU Firmware updates are pending you need to power cycle your printer!\n</code></pre> <p>It means that new MCU firmware updates need to be applied and this can only be done by power cycling the printer.  After your printer is power cycled you can verify firmware was updated with the <code>CHECK_FIRMWARE</code> macro from Fluidd or Mainsail, if you see this message:</p> <pre><code>INFO: Your MCU Firmware is up to date!\n</code></pre> <p>Your printer MCU firmware was updated successfully.   If you still see the <code>MCU Firmware updates are pending you need to power cycle your printer!</code> message after a power cycle, check the <code>/tmp/mcu_update.log</code>, you may be asked to provide this file on Discord if you need additional assistance, sometimes an additional power cycle can solve the problem, there is a very short window of time (15 seconds) in which the MCU firmware can be updated, so  there is a chance it will work after an additional power cycle.</p>"},{"location":"microprobe/#verify-usb-key","title":"Verify USB Key","text":"<p>It is important to make sure you have a way to emergency factory reset the printer, if the worst happens.   There is a macro in Simple AF called <code>CHECK_USB_KEY</code> that will wait for you to plug a USB thumb drive (aka USB key) in and tell you if it was able to be successfully mounted.</p> <p>You can find the CHECK_USB_KEY macro in Fluidd or Mainsail, because Fluidd and Mainsail are already installed, you can access Fluidd by opening your browser and connecting using http://X.X.X.X, where X.X.X.X is your ip address that you used to login via ssh to your printer, you can also access Fluidd via http://X.X.X.X:4408 and Mainsail via http://X.X.X.X:4409!</p> <p></p> <p>After running the macro you should see output like the following:</p> <p></p> <ul> <li>If you get the message: <code>INFO - USB Key was recognised and mounted correctly (/tmp/udisk/sda1)</code>, your USB thumb drive (aka USB key) is perfect to use for a factory reset.</li> <li>If you get no message at all before the script ends (after 60 seconds), your USB thumb drive (aka USB key) is defective.   You can check the <code>messages</code> file in the logs section of your UI to get more details about why the usb key could not be mounted!</li> </ul> <p>Tip</p> <p>You should verify your USB thumb drive (aka USB key) often just to make sure you have something if you need to unbrick your printer, simply type <code>CHECK_USB_KEY</code> or hit the button in Fluidd / Mainsail The USB key should be FAT32 formatted and be no larger than 32GB!</p>"},{"location":"microprobe/#timer-too-close-and-microsteps","title":"Timer too close and microsteps","text":"<p>For microprobe you cannot use more than <code>microsteps: 64</code></p>"},{"location":"microprobe/#calibration","title":"Calibration","text":"<p>Warning</p> <p>The following calibration steps are required to setup a new printer:</p> <ul> <li>Probe Calibrate</li> <li>PID Tuning and Input Shaping</li> </ul>"},{"location":"microprobe/#probe-calibrate","title":"Probe Calibrate","text":"<p>For the microprobe it is extremely important to do the PROBE_CALIBRATE step to configure your z-offset, regardless of what model you have used to mount the probe!</p> <p></p> <ol> <li>Home All (<code>G28</code>)</li> <li>Run <code>PROBE_CALIBRATE</code></li> <li>Follow the Paper Test Method Upon completion <code>SAVE_CONFIG</code></li> </ol> <p>Note</p> <p>The default z-offset for Microprobe is 0, so your prints won't stick without doing this step.</p>"},{"location":"microprobe/#pid-tuning-and-input-shaping","title":"Pid Tuning and Input Shaping","text":"<p>At least PID tuning (bed and extruder) and input shaping is required for acceptable printing.  If you try and print after running the installer.sh and a power cycle but before any calibration you will most likely have horrendous quality, the worst you have ever seen on the k1.   After PID tuning and input shaping you should see the same kind of quality as you get with stock k1 + input shaper fix.</p> <p>Note</p> <p>You can use the QUICK_START Macro to complete Bed and Nozzle PID Tuning and Input Shaping Automatically.</p>"},{"location":"microprobe/#pid-tuning","title":"Pid Tuning","text":"<p>Source: Calibrate Pid Settings</p> <p>For example you might run these:</p> <pre><code>PID_CALIBRATE_BED BED_TEMP=65\nPID_CALIBRATE_HOTEND HOTEND_TEMP=230\n</code></pre> <p>Note</p> <p>The <code>PID_CALIBRATE_BED</code> and <code>PID_CALIBRATE_HOTEND</code> macros are located in the <code>useful_macros.cfg</code> file and they have defaults values for BED_TEMP and HOTEND_TEMP so you can just run them by clicking on them if you want that same temperature.</p>"},{"location":"microprobe/#input-shaping","title":"Input Shaping","text":"<p>There is no default configuration for input shaping so it is essentially disabled out of the box.</p> <p>You can use the <code>SHAPER_CALIBRATE</code> macro to run input shaping, just be sure to <code>SAVE CONFIG</code> at the end, to choose the automatically selected shaper config, be aware though that the shaper chosen might be sub-optimal due to a slight difference in vibrations between two options.  So you should probably review the output and potentially choose an alternative if it gives you higher recommended max acceleration for minimal increase in vibration.</p> <p>Input Shaper Auto Calibration</p>"},{"location":"microprobe/#probing-speed","title":"Probing speed","text":"<p>On a K1/Max a faster lift_speed may counter the backlash on the Z-axis belts. Going too fast is likely making the bed bounce back in the opposite direction. Find the best speeds for probing by varying the probe_speed and lift_speed parameters. BIQU Microprobe is an optical probe and as a rule slow probe_speed will give better results. Start with probe_speed=1 and vary the lift_speed values to find the optimal lift_speed first.</p> <pre><code>PROBE_ACCURACY probe_speed=1 lift_speed=15\n</code></pre> <p>In this case, lift_speed of 15mm/s seems optimal.</p> <p></p> <p>After determining the optimal lift_speed, different probe_speed values can be tested until the sweet spot is found. Here 1.0mm/s works most reliably, however, the slow speed will make the meshing process take longer.</p> <p></p> <p>Credit to Ales Omahen (@Havoc on discord) for this section</p>"},{"location":"microprobe/#axis-twist-compensation","title":"Axis Twist Compensation","text":"<p>If you are using a rear mount it is highly recommended to perform axis twist compensation, this will affect the quality of your bed mesh, so best to do it before.</p> <p>Tip</p> <p>There is no need to run axis twist compensation if you have mounted the eddy with a side mount that has a 0 y offset!</p> <ol> <li>Home All (<code>G28</code>)</li> <li>Run <code>AXIS_TWIST_COMPENSATION_CALIBRATE</code> The calibration wizard will prompt you to measure the probe Z offset at a few points along the bed    Upon completion <code>SAVE_CONFIG</code></li> </ol> <p>Source: https://www.klipper3d.org/Axis_Twist_Compensation.html</p>"},{"location":"microprobe/#first-print","title":"First Print","text":"<p>You should optimise your probe z offset using baby stepping.</p> <p>In fluidd the save button after you finish or cancel your print can be a bit hard to find, look for</p> <p></p>"},{"location":"microprobe/#other-calibrations","title":"Other Calibrations","text":"<p>Info</p> <p>The default value for pressure advance is set to <code>0.04</code></p> <p>Refer to Orcaslicer Calibration for more calibrations</p> <p>Refer to the Ellis Print Tuning Guide for more great tuning ideas.</p>"},{"location":"microprobe_wiring/","title":"Microprobe Wiring","text":"<p>Note</p> <p>This wiring section applies to K1/K1C/K1SE/K1M printers only</p> <p>The probe and the TOUCH port on the Nozzle MCU board both mate with a 5-pin Molex Picoblade connector. A 5-pin cable is needed to connect the probe to the TOUCH port.</p> <p>Some sellers may call the connector \"Micro JST SH 1.25\" but that is incorrect. Several premade cables are compatible. Most notably the Creality cable for their CR Touch probe:</p> <ul> <li>https://www.aliexpress.us/item/1005004960067376.html</li> <li>https://www.amazon.com/dp/B0BKPFY24M/</li> </ul> <p></p> <p></p> <p>Connect to TOUCH port on the nozzle MCU. it is accessible from the side left (LIDAR) side of the printhead and only the external cover of the printhead has to be removed.</p> <p></p> <p></p>"},{"location":"misc/","title":"Misc","text":""},{"location":"misc/#octoeverywhere-companion","title":"OctoEverywhere Companion","text":"<p>OctoEverywhere is a 3D printing community project that enables free remote access, AI print failure detection, notifications, and more. OctoEverywhere cannot be installed onto the K1 when running the Cartographer, beacon or btt eddy, the stress placed on the system by running OctoEverywhere is too great, however the OctoEverywhere Companion running on another device on the same WIFI network as the K1 works great.</p> <p>Learn More: https://octoeverywhere.com/companion</p>"},{"location":"misc/#mobileraker-companion","title":"Mobileraker companion","text":"<p>It is also possible to install mobileraker companion on a separate device</p> <p>https://github.com/Clon1998/mobileraker_companion?tab=readme-ov-file#standalone-installation</p>"},{"location":"misc/#switch-to-stock","title":"Switch to Stock","text":"<p>A recent feature allows you to quickly switch back to Stock Creality Klipper (aka Crapper) after installing Simple AF, and being able to quickly restore Simple AF without having to do a factory reset.  All that will be required after each switch is to power cycle at least once to get the MCUs updated with the correct firmware.   The use case for this feature is mostly about supporting Simple AF users who have a single printer and perhaps they need to switch back to stock to be able to print a mount or something.</p> <p>Existing users of Simple AF will have to factory reset at least once to get the correct Creality Stock configuration files correctly backed up, but for new users the feature will be available straight away.   If you have a <code>~/backups/creality-backup.tar.gz</code> file, you can use the feature.</p> <p>Its really important before you install Simple AF for the first time that you properly calibrate the printer in stock so that switching back allows you to immediately use the printer, the switch to stock process does not restore the printer to a completely stock configuration, as only klipper and the stock display are restored!</p> <p>Switching to stock is as simple as running from ssh on the printer:</p> <pre><code>/usr/data/pellcorp/k1/switch-to-stock.sh\n</code></pre> <p>And then power cycling the printer after the script finishes execution</p>"},{"location":"misc/#updating-stock-configuration","title":"Updating Stock Configuration","text":"<p>So if you installed Simple AF without calibrating your printer, the first time you switch to stock you will need to execute the first run calibration, do that and then run <code>/usr/data/pellcorp/k1/switch-to-stock.sh --update</code> to update the stock config files backup so that calibration can be reused on subsequent switch to stock usages, otherwise if you do not run the --update you will be forced to run the first run calibration every time you switch to stock!</p>"},{"location":"misc/#switching-back-to-simple-af","title":"Switching back to Simple AF","text":"<p>You can easily switch back with:</p> <pre><code>/usr/data/pellcorp/k1/switch-to-stock.sh --revert\n</code></pre> <p>And power cycling the printer once again</p> <p>Danger</p> <p>Do not leave a probe mounted on the printer when you switch back to stock, this is especially important if you have  a rear mounted probe as it is very likely to be damaged when the printer does its nozzle wipe at the back of the printer</p> <p>Switching to stock does not allow using the printer with Helper Script, this is an emergency temporary mode!</p> <p>Switching to stock will leave moonraker, fluidd and mainsail accessible.   The stock screen is restored, but you must not try to perform a firmware upgrade in stock mode as this will most likely remove SimpleAF!</p>"},{"location":"misc/#moonraker-timelapse","title":"Moonraker Timelapse","text":"<p>Moonraker timelapse is installed but not enabled by default.  To enable it there are a few steps, you need to add the following include to printer.cfg:</p> <pre><code>[include timelapse.cfg]\n</code></pre> <p>And uncomment the <code>[include timelapse.conf]</code> in moonraker.conf, you will need to restart moonraker and klipper after this, you can do that via the fluidd or mainsail services section.</p> <p>If you see these messages:</p> <p><pre><code> 15:14:24  // Unknown command:\"_SET_TIMELAPSE_SETUP\"\n15:14:24  // Unknown command:\"HYPERLAPSE\"\n</code></pre> It means you have not as yet properly restarted moonraker and/or klipper.    If in doubt just power cycle your machine.</p>"},{"location":"misc/#custom-parking-position","title":"Custom Parking Position","text":"<p>You might run into issues with the default <code>back_right</code> parking position.  A user has reported that the toolhead collides with the rear motor, a  remedy for this is to modify the <code>[timelapse]</code> section in <code>timelapse.conf</code> to enable custom parking and set the X and Y coordinates to match what is in the <code>start_end.cfg</code> for  <code>variable_custom_park_x</code> and <code>variable_custom_park_y</code>.</p> <p>Change the <code>parkpos: back_right</code> to be <code>parkpos: custom</code>, so the <code>timelapse.conf</code> changes might look like: </p> <pre><code>parkpos: custom\npark_custom_pos_x: 296\npark_custom_pos_y: 296\n</code></pre>"},{"location":"misc/#timelapse-camera-config","title":"Timelapse Camera config","text":"<p>Info</p> <p>Because the single webcam is controlled via moonraker with the webcam.conf file, the Timelapse camera dropdown menu won't let you choose a camera, this is expected.</p> <p></p>"},{"location":"misc/#slicer-changes","title":"Slicer Changes","text":"<p>https://github.com/mainsail-crew/moonraker-timelapse/blob/main/docs/configuration.md#prusa-slicer--super-slicer</p>"},{"location":"misc/#spoolman","title":"Spoolman","text":"<p>Spoolman moonraker integration  is not enabled by default.  To enable it there are a few steps, you need to add the following include to printer.cfg:</p> <pre><code>[include spoolman.cfg]\n</code></pre> <p>And uncomment the <code>[include spoolman.conf]</code> in moonraker.conf, you will need to change the <code>server</code> url to your spoolman server location. </p> <p>You will need to restart moonraker and klipper after this, you can do that via the fluidd or mainsail services section.</p>"},{"location":"misc/#configuring-timezone","title":"Configuring Timezone","text":"<p>The <code>/etc/init.d/S58factoryreset</code> has recently been updated not to delete the <code>/etc/localtime</code>, so you can configure it once and it should survive any number of factory resets, following the excellent guide here:</p> <p>https://guilouz.github.io/Creality-Helper-Script-Wiki/firmwares/change-date-and-time/</p>"},{"location":"misc/#emergency-factory-reset","title":"Emergency Factory Reset","text":"<p>If the worst happens and you somehow get locked out (for instance for whatever reason the dropbear ssh session does not start or wifi config gets all screwy, it is possible to trigger a emergency factory reset.</p> <p>It is very easy, you just need to create a empty file called <code>emergency_factory_reset</code> on a USB key and make sure the USB key is plugged in, then power cycle the printer, this will initiate a factory reset.</p> <p>Tip</p> <p>If you are having trouble creating a file like this in windows, the easiest way is to download the emergency_factory_reset.zip and extract it onto your usb thumb drive.</p> <p>Info</p> <p>This factory reset method will rename the <code>emergency_factory_reset</code> to <code>emergency_factory_reset.old</code> to avoid a boot loop, so if you need to use this method again you will need to rename the file.</p> <p>This factory reset method will not remove the special service file <code>/etc/init.d/S58factoryreset</code> from the k1, so if you need it you can redo a factory reset even before reinstalling.</p> <p>This method does not reset wifi or root access</p> <p>Danger</p> <p>It can take up to 5 minutes for a factory restart to finish, it is vital you do not power cycle your printer before the stock screen appears. There may be a 3002 error on the screen, this is completely normal.   If you are planning to install Simple AF you can ignore it, if you are trying to go back to stock, power cycle the printer again to clear the error.  </p> <p>Failing to follow this advice can lead to your printer getting bricked and requiring much more involved intervention to recover!</p> <p></p>"},{"location":"misc/#grumpyscreen-factory-reset","title":"Grumpyscreen Factory Reset","text":"<p>It is also possible to initiate a factory reset from the settings menu (the cog) of Grumpyscreen.</p> <p></p>"},{"location":"rpi/","title":"Simple AF for RPi","text":"<p>Do you want Simple AF on your non Creality OS printers?   Well Simple AF for RPi is for you, you can install it on pretty much any debian based (rasbian, dietpi, opi debian server, etc) Rpi like SBC, which also includes CM like the CM4, CM5 and CB range from BTT as well as your standard Raspberry Pis, Orange Pis, etc.</p> <p>Warning</p> <p>This feature is classed as experimental, every effort will be made to avoid breaking existing installations, but this cannot be guaranteed.</p>"},{"location":"rpi/#supported-os","title":"Supported OS","text":"<p>Simple AF is best supported by RPi or OrangePi running a version of debian 11 or 12 (which includes Orange Pi Debian, Rasbian, Arbian, whatever BTT is doing, etc).</p> <p>Danger</p> <p>Simple AF for RPi is currently not supported on Debian 13, this hopefully will change in the near future. Its unfortunate but until a few issues are sorted out with numpy and klippain are resolved Debian 13 is off limits. For some more history of this issue see this now closed issue https://github.com/pellcorp/creality/issues/932</p>"},{"location":"rpi/#raspberry-pi-os","title":"Raspberry Pi OS","text":"<p>So far been tested to work on a pi 3, 4 and 5, it does not matter whether you use 32 or 64 bit OS. It is recommended to use the Rpi Imager and choose <code>Raspberry PI OS Lite (64-bit)</code> or <code>Raspberry PI OS (Legacy, 64 bit) Lite</code></p> <p>Danger</p> <p>As Simple AF for RPi is currently not supported on Debian 13, you must choose <code>Raspberry PI OS (Legacy, 64 bit) Lite</code> when using Rpi Imager!</p> <p>You must login as the pi (Default password is <code>raspberry</code>) user to perform the installation, you are not allowed to run the installer as root!</p>"},{"location":"rpi/#orange-pi-os","title":"Orange Pi OS","text":"<p>Please note that OrangePi OS (based on Arch) is not supported and will fail to install because the installer assumes a debian based OS, this is unlikely to change anytime soon.</p>"},{"location":"rpi/#orange-pi-debian-os","title":"Orange Pi Debian OS","text":"<p>Testing has been done on an Orange Pi Zero 3 W running a server image available from: https://drive.google.com/drive/folders/10zlO-0mMz-fqRQOKAOWX-mQA_UbN_C1n</p> <p>Note</p> <p>Please make sure to set <code>bootlogo=true</code> in the <code>orangepiEnv.txt</code> before booting for the first time so that the boot display works correctly.</p> <p>When running the <code>sudo apt-get update</code> you might get an error complaining about <code>Err:36 https://repo.huaweicloud.com/docker-ce/linux/debian bullseye/stable arm64 Contents</code>, this is a long standing bug (from 2023) that was never fixed and the work around is to run: <pre><code>sudo rm /etc/apt/sources.list.d/docker.list\nsudo apt-get --allow-releaseinfo-change update\n</code></pre></p> <p>You must login as the orangepi (Default password is <code>orangepi</code>) user to perform the installation, you are not allowed to run the installer as root!</p> <p>Warning</p> <p>By default the <code>orangepi</code> user cannot sudo without providing a password, the installer will create a <code>/etc/sudoers.d/nopasswd</code> file to enable no password sudo for the orangepi user.</p>"},{"location":"rpi/#dietpi-os","title":"DietPi OS","text":"<p>Basic testing has been done with DietPi (Bookworm) running on an Orange Pi 3 Zero W</p> <p>I had some trouble getting DietPi setup in my home network which uses a PiHole connected to cleanbrowsing.org DNS family filter which prevented the default DNS settings from working.</p> <p>I updated the dietpi.txt as follows:</p> <pre><code>AUTO_SETUP_AUTOMATED=1\nSURVEY_OPTED_IN=0\nCONFIG_CHECK_CONNECTION_IP=8.8.8.8\nCONFIG_CHECK_CONNECTION_IPV6=2001:4860:4860::8888\nCONFIG_CHECK_DNS_DOMAIN=google.com\nCONFIG_CHECK_DIETPI_UPDATES=0\nCONFIG_CHECK_APT_UPDATES=0\nCONFIG_SERIAL_CONSOLE_ENABLE=0\n</code></pre> <p>You do not want the OS doing updates while prints are going so updating should be controlled by Moonraker only.   I reconfigured the DNS check configuration to use google as the quad9 DNS was not resolved by cleanbrowsing.org, of course your situation may be completely different and the above options might be overkill.</p> <p>I discovered that there is a few hoops to jump through before getting the OrangePi setup, no idea if this is due to some weird combination of settings above, but I discovered you have to physically power off the device after the first run finishes and the pi hole is supposedly rebooted, otherwise ethernet does not come back.   </p> <p>What I did was login as root after powering up the device for the first time and it will tell me that first run setup is going on in a  different screen and will eventually let me know a restart will be required, I wait until I am kicked from the SSH session and then I give it a minute and power cycle the pi.</p> <p>Then login as the dietpi (Default password is <code>dietpi</code>) user to start the installation, after logging in, you may be told that first run setup is still going, give it a few minutes and you should be greeted with a login prompt.</p>"},{"location":"rpi/#ubuntu-based-distributions","title":"Ubuntu based distributions","text":"<p>On Ubuntu 22.04 or 24.04 based distributions, it might work but no formal testing has been performed as yet!</p>"},{"location":"rpi/#armbian","title":"Armbian","text":"<p>On Debian 11, Debian 12, Ubuntu 22.04 or 24.04 based distributions, might work but no formal testing has been performed as yet!</p>"},{"location":"rpi/#btt-os","title":"BTT OS","text":"<p>On Debian 11, Debian 12 based, might work but no formal testing has been performed as yet!</p>"},{"location":"rpi/#installation","title":"Installation","text":"<p>Danger</p> <p>Do not try and install Simple AF for RPi on Mainsail OS or onto an existing klipper environment which has been setup using kiuah</p>"},{"location":"rpi/#cloning-repo","title":"Cloning repo","text":"<p>The following commands should be executed to get the repo locally:</p> <pre><code>sudo apt-get update\nsudo apt-get install -y git\ngit clone https://github.com/pellcorp/creality.git ~/pellcorp\n</code></pre>"},{"location":"rpi/#installing","title":"Installing","text":"<p>The installation command is very similar to K1 series:</p> <pre><code>~/pellcorp/installer.sh --install --printer &lt;ThePrinter&gt; &lt;TheProbe&gt; [--mount &lt;TheMount&gt;]\n</code></pre> <ul> <li>Where <code>--printer &lt;ThePrinter&gt;</code> is a predefined, downloaded or downloadable printer definition</li> <li>Where <code>--mount &lt;TheMount&gt;</code> is only required for some predefined printer definitions</li> <li>Where <code>&lt;TheProbe&gt;</code> is one of bltouch, microprobe, cartotouch, cartographer, beacon, klicky, btteddy or eddyng. </li> </ul>"},{"location":"rpi/#predefined-printer","title":"Predefined Printer","text":"<p>You need to figure out what kind of mainboard you have because that will dictate whether you can  use a predefined printer cfg file  or you need to provide your own.  The easiest way to find out what predefined printers are available is to run the command:</p> <pre><code>~/pellcorp/installer.sh --install --printer\n</code></pre> <p></p> <p>Note</p> <p>For the <code>--printer</code> argument specify the ID of the printer so for instance <code>--printer creality-ender3-v3-se</code></p>"},{"location":"rpi/#downloaded-or-downloadable-printer-definition","title":"Downloaded or Downloadable Printer Definition","text":"<p>Refer to Printer Definitions for how to craft a base printer cfg file, note at the moment the  installer does not support a printer cfg broken up into separate files, it should be a single .cfg file only.</p> <p>You can specify a http:// or https:// url for the --printer parameter or you can download the file locally yourself!</p> <p>Note</p> <p>For the <code>--printer</code> argument specify the url of the file, so for example <code>--printer https://github.com/pellcorp/klipper-rpi/blob/master/config/printer-creality-ender3-s1plus-2022.cfg</code> or reference a local file if you did download it locally, so for example <code>--printer ~/printer-creality-ender3-s1plus-2022.cfg</code></p>"},{"location":"rpi/#choose-a-probe","title":"Choose a Probe","text":"<p>You need to choose a probe one of:</p> <ul> <li>Cartotouch</li> <li>Cartographer</li> <li>Beacon</li> <li>BlTouch</li> <li>Microprobe</li> <li>Klicky</li> <li>BttEddy</li> <li>Eddyng</li> </ul>"},{"location":"rpi/#choose-a-mount","title":"Choose a mount","text":"<p>If you have chosen a predefined printer, it might require you to choose a mount, you can run the installer with the --mount option without an argument to get a list of possible mounts:</p> <p></p>"},{"location":"rpi/#klipperscreen-and-grumpyscreen","title":"KlipperScreen and GrumpyScreen","text":"<p>Neither of these is installed by default, you will need to manually install one or the other after the main installation has finished, its easy enough, so for KlipperScreen:</p> <pre><code>~/pellcorp/rpi/install-klipperscreen.sh \n</code></pre> <p>For GrumpyScreen:</p> <pre><code>~/pellcorp/rpi/install-grumpyscreen.sh \n</code></pre>"},{"location":"rpi/#post-installation-issues","title":"Post Installation issues","text":""},{"location":"rpi/#input-shaper-and-klippain","title":"Input Shaper and Klippain","text":"<p>Klippain is only pre-installed on corexy printers</p> <p>If you do not define <code>[adxl345]</code> and <code>[resonance_tester]</code> sections in your base printer cfg, the installer will install klippain but not add the <code>[include klippain.cfg]</code>, so if you setup adxl and resonance tester config after installation you should also manually add the <code>[include klippain.cfg]</code> to your printer.cfg as well!</p> <p>If you do not have a <code>[resonance_tester]</code> section, the <code>TEST_RESONANCES</code>, <code>SHAPER_CALIBRATE</code>, <code>INPUT_SHAPER</code> and <code>INPUT_SHAPER_GRAPHS</code> macros will not work!</p>"},{"location":"rpi/#mcu-firmware","title":"MCU Firmware","text":"<p>Its easier to install Simple AF and then build the firmware with <code>make menuconfig</code> afterwards, just be aware that  on first boot its likely your MCU will either not connect or klipper will complain about Protocol version issues, this is to be expected.</p>"},{"location":"rpi/#boot-display","title":"Boot Display","text":"<p>The boot display step is currently optional and requires some manual steps, so you install the boot display via:</p> <pre><code>~/pellcorp/rpi/install-boot-display.sh\n</code></pre>"},{"location":"rpi/#raspberry-pi-os_1","title":"Raspberry Pi OS","text":"<p>To get the splash screen working on raspberry pi OS you have to jump through a few additional hoops including installing:</p> <pre><code>sudo apt-get install -y plymouth rpd-plym-splash plymouth-themes\n</code></pre> <p>And then enable the splashscreen in raspi-config!</p> <p>Note</p> <p>Installing rpd-plym-splash actually displays the raspberry pi desktop theme so if you enable the splashscreen after running the installer for the boot-display, you will most likely need to rerun:</p> <pre><code>sudo plymouth-set-default-theme -R simpleaf\n</code></pre>"},{"location":"rpi/#klipperscreen","title":"KlipperScreen","text":"<p>The installer will automatically install KlipperScreen on Pi4 or above, there are concerns of overloading a pi3 or less with klipperscreen so the installer will install grumpyscreen for raspberry pi 3 devices only!</p> <p>You can force the installation of KlipperScreen afterwards by running:</p> <pre><code>sudo systemctl stop grumpyscreen\nsudo systemctl disable grumpyscreen\n~/pellcorp/rpi/install-klipperscreen.sh\n</code></pre> <p>Note</p> <p>If you do the above on a device other than a Raspberry Pi 3, the first two commands will likely fail with a message like: <code>Failed to stop grumpyscreen.service: Unit grumpyscreen.service not loaded.</code> this is fine and can be ignored, for devices other than a Raspberry Pi, like OrangePi or the like you can skip straight to installing KlipperScreen, just be aware that KlipperScreen is very resource hungry, I do not recommend running this on a low spec device.</p>"},{"location":"rpi/#grumpyscreen","title":"Grumpyscreen","text":""},{"location":"rpi/#btt-hdmi-screen","title":"BTT HDMI Screen","text":"<p>For whatever reason Grumpyscreen does not work nicely with a HDMI screen its on my list of TODOs to fix this, if possible setup Simple AF on a Pi4 or above to get KlipperScreen.</p>"},{"location":"rpi/#btt-dsi-screen","title":"BTT DSI Screen","text":"<p>Support for grumpyscreen will be provided for BTT DSI screens but you need to setup the screen to be correctly configured.</p> <p>https://github.com/bigtreetech/TFT43-DIP</p> <p>By default when grumpyscreen starts its probably going to look like:</p> <p></p> <p>The following changes are required to fix that:</p> <p>Need to download the dtbo file:</p> <pre><code>sudo wget https://raw.githubusercontent.com/bigtreetech/TFT43-DIP/master/gt911_btt_tft43_dip.dtbo -O /boot/overlays/gt911_btt_tft43_dip.dtbo\n</code></pre> <p>Needs this in <code>/boot/firmware/config.txt</code> (for bookworm) or <code>/boot/config.txt</code> (for bulleye)</p> <pre><code>[all]\ngpu_mem=160\n\ndtoverlay=vc4-kms-dpi-generic\ndtparam=rgb666-padhi,clock-frequency=32000000\ndtparam=hactive=800,hfp=16,hsync=1,hbp=46\ndtparam=vactive=480,vfp=7,vsync=3,vbp=23\ndtparam=backlight-gpio=19\ndtparam=rotate=0\n\ndtoverlay=gt911_btt_tft43_dip\ndtparam=rotate_0\n</code></pre> <p>And please make sure you disable this line:</p> <pre><code># dtoverlay=vc4-kms-v3d\n</code></pre> <p>Note</p> <p>The gpu_mem=160 is really important otherwise Grumpyscreen won't display correctly.</p>"},{"location":"rpi/#crowsnest-camera-support","title":"Crowsnest (Camera Support)","text":"<p>Crowsnest is automatically installed for you but a single webcam is configured and points at <code>/dev/video0</code>, this won't always end up being a valid webcam.</p> <p>To find out what devices are available you can use the crowsnest tool like so:</p> <pre><code>~/crowsnest/tools/dev-helper.sh -c\n</code></pre> <p></p> <p>Warning</p> <p>According to the crowsnest project, its always preferable to use full paths, especially in Mutlicam setups using /dev/video*  will lead to errors or unexpected behaviours.</p> <p>Source: https://crowsnest.mainsail.xyz/configuration/cam-section#device</p>"},{"location":"rpi/#rpi-camera","title":"Rpi Camera","text":"<p>I've not found a way to get the V1 cam working with rasbian 12, only with 11 and enable classic legacy cam support and then it just works.</p>"},{"location":"rpi_printer_definitions/","title":"RPI Base Printer Definitions","text":"<p>If you are not using a predefined printer definition you will need to craft or download a basic printer config</p>"},{"location":"rpi_printer_definitions/#what-should-be-in-this-file","title":"What should be in this file?","text":"<p>This definition should not include any kind of probe configuration in the main printer.cfg section, this should just have the basics (the installer will automatically remove some problematic definitions):</p> <ul> <li>extruder</li> <li>heater_bed</li> <li>heater_fan</li> <li>stepper_x</li> <li>stepper_y</li> <li>stepper_z (or multiple stepper_z for multi-z)</li> <li>the <code>[printer]</code> section</li> <li>fan</li> <li>fan_generic</li> <li>filament_switch_sensor</li> </ul>"},{"location":"rpi_printer_definitions/#support-probes-and-mounts","title":"Support Probes and Mounts","text":"<p>If you are updating the mainboard on one of the printers that supports multiple probes and/or mounts, you should let the installer know what model of printer your config is for, this is done by specifying the model of printer with a <code># MODEL:</code> header at the beginning of the file!</p> <p>The supported models are:</p> <ul> <li><code>k1</code> (K1, K1C, K1SE)</li> <li><code>k1m</code> (K1 Max)</li> <li><code>f004</code> (Ender 5 Max)</li> <li><code>f005</code> (Ender 3 V3 KE)</li> <li><code>ender3v3se</code> (Ender 3 V3 SE)</li> </ul> <p>So just stick it into the beginning of the file like this:</p> <pre><code># MODEL:k1\n</code></pre> <p>If you want to support Klicky, Microprobe and Bltouch in your base printer.cfg you will need to do a bit more work, specifically you need to prefix your main printer.cfg definitions with <code>-- printer.cfg</code> and then provide additional sections for each of klicky.cfg, microprobe.cfg and bltouch.cfg, like this:</p> <pre><code>-- bltouch.cfg\n[bltouch]\nsensor_pin: ^PC14\ncontrol_pin: PC13\n\n-- microprobe.cfg\n[probe]\npin: ^!PC14\n\n[output_pin probe_enable]\npin: PC13\n\n-- klicky.cfg\n[probe]\npin: ^!PC14\n</code></pre> <p>Where of course the pins will be relative to the mainboard you are using</p> <p>Check out https://github.com/pellcorp/creality/blob/main/rpi/printers/creality-ender3-v3-se.cfg for an example.</p>"},{"location":"updating/","title":"Updating","text":"<p>Completely updating Simple AF requires running the installer on the command line and also updating components from fluidd or mainsail.</p>"},{"location":"updating/#simple-af-installer","title":"Simple AF Installer","text":"<p>Simple AF cfg and conf files cannot be updated via Fluidd or Mainsail, it must be updated by using ssh to connect to the printer</p> <pre><code>~/pellcorp/installer.sh --branch main\n~/pellcorp/installer.sh --update\n</code></pre> <p>Note</p> <p>If you run the above and receive an error like:</p> <pre><code>```\nroot@K1Max-AF34 /root [#] ~/pellcorp/installer.sh --branch main\n-sh: /root/pellcorp/installer.sh: not found\n```\n</code></pre> <p>It means you are on an older version of Simple AF and you should instead use the old style commands:</p> <pre><code>```\n/usr/data/pellcorp/k1/installer.sh --branch main\n~/pellcorp/installer.sh --update\n```\n</code></pre> <p>If you get a <code>ERRROR: Mount option must be specified</code>, you must provide a <code>--mount TheMount</code> where <code>TheMount</code> is a reference to the mount you are currently using, and that will depend on what probe you are using, you can consult the #mount-options section of your specific probe wiki page.</p> <p>This backs up your customisations, updates the creality repo, applies all changes to your <code>~/printer_data/config</code> directory and then reapplies your customisations over the top.</p>"},{"location":"updating/#fluidd-and-mainsail-updates","title":"Fluidd and Mainsail Updates","text":"<p>The following components can be updated via Fluidd / Mainsail Software Updates:</p> <ul> <li>beacon</li> <li>cartographer</li> <li>fluidd</li> <li>fluidd-config (aka client-macros)</li> <li>moonraker</li> <li>klipper</li> <li>mainsail</li> <li>timelapse (aka Moonraker Timelapse)</li> </ul> <p>You can update these components via Fluidd or Mainsail, in fluidd make sure you click the CHECK FOR UPDATES button, and in Mainsail click the Refresh button</p> <p>Note</p> <p>It is normal for moonraker and klipper to warn about <code>Unofficial remote url</code>, this is because Simple AF has forked these repositories.</p> <p></p>"},{"location":"updating/#reinstalling","title":"Reinstalling","text":"<p>A reinstall is only needed if one or more github repos have got into an inconsistent state, so you can force a reinstall with the <code>--reinstall</code> argument in place of the <code>--install</code> argument.  The difference to a <code>--install</code>, is a <code>--install</code> will only finish up a partial install that failed due to a network failure or the like.</p> <p>Info</p> <p>If you switch probes using --update you will have to manually clean up any save configuration for that probe before klipper will start.</p>"},{"location":"updating/#clean-reinstall","title":"Clean Reinstall","text":"<p>If you wish to reinstall Simple AF ignoring your pre-existing config overrides, the easiest approach is to first make sure Simple AF repo is up to date and on the right branch:</p> <pre><code>~/pellcorp/installer.sh --branch main\n</code></pre> <p>Then do a clean reinstall:</p> <pre><code>~/pellcorp/installer.sh --clean-reinstall cartotouch\n</code></pre> <p>You can of course replace cartotouch with any other applicable probe.</p> <p>This will ignore your local changes completely, and is almost 100% the same as doing a factory reset.</p> <p>Note</p> <p>If you run the above and receive an error like:</p> <pre><code>```\nroot@K1Max-AF34 /root [#] ~/pellcorp/installer.sh --clean-reinstall cartotouch\n-sh: /root/pellcorp/installer.sh: not found\n```\n</code></pre> <p>It means you are on an older version of Simple AF and you should instead use the old style commands:</p> <pre><code>```\n/usr/data/pellcorp/k1/installer.sh --branch main\n~/pellcorp/installer.sh --clean-reinstall cartotouch\n```\n</code></pre>"},{"location":"updating/#factory-reset","title":"Factory Reset","text":"<p>Note</p> <p>This does not apply to Simple AF for RPi</p> <p>To factory reset a Simple AF installation is very much like how you install Simple AF from helper script</p> <p>If you wish to be able to restore you local changes after a factory reset you should make sure you run the config overrides script before performing the factory reset itself, so this is easy to do from ssh with:</p> <pre><code>/usr/data/pellcorp/tools/config-overrides.sh\n</code></pre> <p>Then perform the factory reset:</p> <pre><code>/etc/init.d/S58factoryreset reset\n</code></pre> <p>Note that the <code>/usr/data/pellcorp-overrides</code> directory is not deleted during a factory reset.</p> <p>Do a new installation as normal, for example.   If you perform a <code>/usr/data/pellcorp/k1/installer.sh --install cartotouch</code> your configuration overrides will be reapplied for you.</p> <p>If you wish to skip applying your config overrides, then you would perform a clean install:</p> <pre><code>/usr/data/pellcorp/k1/installer.sh --clean-install cartotouch\n</code></pre>"}]}